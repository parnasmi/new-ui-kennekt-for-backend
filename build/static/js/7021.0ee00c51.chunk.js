!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="02ec79e7-ba80-4b74-b4e0-397b4b618da4",e._sentryDebugIdIdentifier="sentry-dbid-02ec79e7-ba80-4b74-b4e0-397b4b618da4")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"a086bfaddc61e7dbbcac0a9c42145052439dbbf3"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[7021],{27021:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var a=n(1413),s=n(70885),r=n(59028),i=n(31102),l=n(54270),c=n(55248),o=n(91523),d=n(79271),u=n(72791),m=n(4245),p=n(35741),f=n(84230),h=n(51625),b=n(40084),x=n(80184),j=(0,u.createContext)(null),y=function(e,t){return"SET_SEARCH_QUERY"===t.type?(0,a.Z)((0,a.Z)({},e),{},{searchQuery:t.payload}):e};function _(e){var t=e.children,n=(0,u.useReducer)(y,{searchQuery:""}),a=(0,s.Z)(n,2),r=a[0],i=a[1],l=(0,u.useCallback)((function(e){i({type:"SET_SEARCH_QUERY",payload:e})}),[]),c={searchQuery:r.searchQuery,setSearchQuery:l};return(0,x.jsx)(j.Provider,{value:c,children:t})}var v=function(){var e=(0,u.useContext)(j);if(!e)throw new Error("useBusinessContext must be used within the BusinessContextProvider");return e},g=n(22553),S=n(97892),k=n.n(S);function w(e){var t=e.type,n=(0,b.m)().companyId,a=(0,i.h0)(),r=a.page,l=a.handlePage,o=(0,d.TH)(),u=v().searchQuery,j=(0,g.Z)(u,500),y=(0,s.Z)(j,1)[0],_=m.parse(o.search),S=_.department,w=_.sub_department,Z=_.status;return t&&[!!S,!!w,!!Z].every((function(e){return!e}))?(0,x.jsx)("h2",{className:"dark:text-white",children:"Please select from department or status"}):(0,x.jsx)("div",{children:n?(0,x.jsx)(p.Z.All,{entity:"AllCases",name:"AllCasesList",url:"/".concat(n,"/cases/as_business/cases_for_admin/"),params:{limit:10,extra:{department:S,sub_department:w,status:Z,search:y},page:r},children:function(e){var t=e.items,n=(e.isFetched,e.meta),a=t.map((function(e){return e}));return(0,x.jsxs)("div",{children:[(0,x.jsx)(f.xJ,{classes:{root:"relative "},children:(0,x.jsxs)(c.k6,{"aria-label":"simple table",classes:{root:"table-fixed dark-mode-styled-table"},children:[(0,x.jsx)(f.ss,{children:(0,x.jsxs)(c.AF,{children:[(0,x.jsx)(c.EU,{children:"Case #"}),(0,x.jsx)(c.EU,{children:"Case title"}),(0,x.jsx)(c.EU,{children:"Created by"}),(0,x.jsx)(c.EU,{children:"Department"}),(0,x.jsx)(c.EU,{children:"SubDepartment"}),(0,x.jsx)(c.EU,{children:"Created date"}),(0,x.jsx)(c.EU,{children:"Status"}),(0,x.jsx)(c.EU,{children:"Priority"})]})}),(0,x.jsx)(f.RM,{children:a.map((function(e){var t=e.id,n=e.case_number,a=e.title,s=e.created_by,r=e.department,i=e.sub_department,l=e.created_date,o=e.status,d=e.priority;return(0,x.jsxs)(c.AF,{children:[(0,x.jsx)(c.Yk,{children:n}),(0,x.jsx)(c.Yk,{children:(0,x.jsx)("div",{className:"truncate",children:a})}),(0,x.jsx)(c.Yk,{children:(0,x.jsx)("div",{className:"truncate",children:"".concat(s.first_name," ").concat(s.last_name)})}),(0,x.jsx)(c.Yk,{children:(0,x.jsx)("div",{className:"truncate",children:null===r||void 0===r?void 0:r.name})}),(0,x.jsx)(c.Yk,{children:(0,x.jsx)("div",{className:"truncate",children:null===i||void 0===i?void 0:i.name})}),(0,x.jsx)(c.Yk,{children:k()(l).format("MMM DD, YYYY HH:mm")}),(0,x.jsx)(c.Yk,{children:o.title}),(0,x.jsx)(c.Yk,{children:d})]},t)}))})]})}),(0,x.jsx)("div",{className:"news__pagination my-4 flex items-center justify-between",children:(0,x.jsx)(h.Z,{count:null===n||void 0===n?void 0:n.last_page,page:r?+r:1,defaultPage:6,siblingCount:1,color:"primary",onChange:l})})]})}}):(0,x.jsx)("div",{className:"flex justify-center",children:(0,x.jsx)(c.aN,{})})})}function Z(e){return(0,x.jsx)(c.SV,{children:(0,x.jsx)(w,(0,a.Z)({},e))})}var C=n(42982),N=n(26864),E=n(37099),A=n(72248),U=n(70629),Y=n(26181),D=n.n(Y),P=n(93629),T=n.n(P);var Q=n(42339);function V(e){var t=e.type,n=function(e){var t=e.isFromAllCasesPage,n=void 0!==t&&t,r=(e.type,(0,b.m)()),i=r.caseType,l=r.selectedCaseFilter[i],c=(0,u.useState)({flatSubdepartments:{}}),o=(0,s.Z)(c,2),d=o[0],m=o[1],p=d.flatSubdepartments,f=function(e,t){m((function(n){return(0,a.Z)((0,a.Z)({},n),{},{flatSubdepartments:{departments:e,sub_departments:(0,C.Z)(new Set(t))}})}))},h=function(e,t){var n=(null!==e&&void 0!==e&&e.length?e.reduce((function(e,t){return[].concat((0,C.Z)(e),[[t.hierarchy[t.hierarchy.length-2].id,t.hierarchy[t.hierarchy.length-1].id]])}),[]):[]).reduce((function(e,t){var n=(0,s.Z)(t,2),r=n[0],i=n[1];return(0,a.Z)((0,a.Z)({},e),{},{departments:[].concat((0,C.Z)(e.departments),[r]),sub_departments:[].concat((0,C.Z)(e.sub_departments),[i])})}),{departments:[],sub_departments:[]}),r=null!==e&&void 0!==e&&e.length?e.reduce((function(e,t){return[].concat((0,C.Z)(e),[t.hierarchy[0].id])}),[]):[],i=t.reduce((function(e,t){return[].concat((0,C.Z)(e),[t.id])}),[]),l=n.sub_departments.filter((function(e){return!n.departments.includes(e)})),c=(0,C.Z)(new Set(i)).filter((function(e){return!r.includes(e)}));return f(c,l),{departments:c,sub_departments:(0,C.Z)(new Set(l))}};return(0,u.useEffect)((function(){if(!n){var e=null===l||void 0===l?void 0:l.filter_json,t=e.sub_department,a=e.department;T()(a)&&a.length>0&&(null!==l&&void 0!==l&&l.filter_json.sub_department&&h(t,a),a&&!t&&f(a.map((function(e){return e.id})),[]))}}),[l]),{flatSubdepartments:p,initialValues:{status:D()(l,"filter_json.status",[]),clientType:D()(l,"filter_json.clientType",{}),client_company:D()(l,"filter_json.client_company",{}),client_user:D()(l,"filter_json.client_user",{}),department:D()(l,"filter_json.department",[]),priority:D()(l,"filter_json.priority",[]),search:D()(l,"filter_json.search",""),sub_department:D()(l,"filter_json.sub_department",[]),unread:D()(l,"filter_json.unread",""),unresponded:D()(l,"filter_json.unresponded",""),rating:D()(l,"filter_json.rating",{}),member:D()(l,"filter_json.member",[]),assignees:D()(l,"filter_json.assignees",[])},makeFlatSubdepartments:h,setDepartments:f}}({isFromAllCasesPage:!0,type:t}),r=n.makeFlatSubdepartments,i=n.setDepartments,l=n.initialValues,o=(0,b.m)().companyId,p=v().setSearchQuery,f=(0,d.TH)(),h=(0,d.k6)();return(0,x.jsx)(N.J9,{onSubmit:function(e,n){var s,i=n.setSubmitting,l=m.parse(f.search),c=t&&"department-".concat(t)in e&&null!==(s=e["department-".concat(t)])&&void 0!==s&&s.length?r(e["sub_department-".concat(t)],e["department-".concat(t)]):{},o={department:c.departments?c.departments.join(","):[],sub_department:c.sub_departments?c.sub_departments.join(","):[],search:D()(e,"search",""),page:1,status:Array.isArray(D()(e,"status-".concat(t)))?D()(e,"status-".concat(t)).reduce((function(e,t){return[].concat((0,C.Z)(e),[t.id])}),[]).join(","):""};h.push({search:m.stringify((0,a.Z)((0,a.Z)({},l),o),{encode:!1})}),i(!1)},initialValues:l,enableReinitialize:!0,children:function(e){var n=e.handleSubmit,a=e.values,s=e.setFieldValue,l=e.isSubmitting,d=Array.isArray(a["department-".concat(t)])&&a["department-".concat(t)].filter((function(e){return e.sub_departments_count>0}));return(0,x.jsxs)("form",{onSubmit:n,children:[(0,x.jsx)("div",{className:"react-select-dropdown my-4 flex w-full w-full flex-wrap items-center",children:t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"my-2 mr-3 w-[300px]",children:(0,x.jsx)(N.gN,{label:"Status:",labelClasses:"ml-2 text-sm font-light text-kgrey-welcome mb-2 block",component:E.Z,customStylesProps:A.C2,title:"Status",optionLabel:"title",optionValue:"id",loadOptionsUrl:"/".concat(o,"/my/company/case_statuses/"),loadOptionsParams:function(e){return{extra:{search:e,is_staff:"staff"===t?"true":"false"}}},reverse:!0,isSearchable:!U.tq,name:"status-".concat(t),loadOptionsKey:"",placeholder:"Status",maxMenuHeight:220,isMulti:!0})}),(0,x.jsxs)("div",{className:"flex flex-wrap items-center",children:[(0,x.jsx)("div",{className:"my-2 mr-3 w-[300px]",children:(0,x.jsx)(N.gN,{label:"".concat(t," departments"),labelClasses:"ml-2 text-sm font-light capitalize text-kgrey-welcome mb-2 block",component:E.Z,title:"Department",optionLabel:"name",optionValue:"id",loadOptionsUrl:"/".concat(o,"/departments/"),loadOptionsParams:function(e){return{extra:{search:e,is_staff:"staff"===t?"true":"false"}}},isSearchable:!U.tq,name:"department-".concat(t),loadOptionsKey:"results",placeholder:"Select Department",isMulti:!0,customStylesProps:A.C2,onChange:function(e){s("sub_department-".concat(t),void 0),i(e?e.map((function(e){return e.id})):[],[])}})}),d.length>0&&(0,x.jsxs)("div",{className:" my-2 mr-3 w-[300px]",children:[(0,x.jsx)("div",{className:"!ml-2 mb-2 block !text-sm font-light capitalize text-kgrey-welcome",children:"".concat(t," departments")}),(0,x.jsx)(N.gN,{component:Q.X4,title:"Sub Department",optionLabel:function(e){return"".concat(D()(e,"department.name")," [").concat(D()(e,"name"),"]")},name:"sub_department-".concat(t),optionValue:"id",customStylesProps:A.C2,loadOptionsUrl:"/".concat(o,"/departments/sub_departments/"),loadOptionsParams:function(e){return{extra:{search:e,department_ids:D()(a,"department-".concat(t)).reduce((function(e,t){return[].concat((0,C.Z)(e),[t.id])}),[]).join(",")}}},onChange:function(e){e?r(e,a["department-".concat(t)]):i(a["department-".concat(t)].map((function(e){return null===e||void 0===e?void 0:e.id})),[])},loadOptionsKey:"results",placeholder:"Select Sub Department",isMulti:!0,isSearchable:!U.tq})]})]}),(0,x.jsx)(c.Ik,{type:"submit",className:"mb-2 mt-8 dark:text-white dark:hover:bg-primary-300 dark:focus:ring-primary-300",color:"primary",isSubmitting:l,children:"Apply"})]}):null}),(0,x.jsx)("div",{className:"w-1/4",children:(0,x.jsx)(N.gN,{label:"Search",labelClasses:"ml-2 text-sm font-light text-kgrey-welcome mb-2 block",name:"title",component:Q.Mg,inputElementClassNames:"!text-15px font-light text-kdark-424653 dark:text-white",placeholder:"Case title",onChangeHandler:function(e){p(e.target.value)}})})]})}})}function F(e){return(0,x.jsx)(c.SV,{children:(0,x.jsx)(V,(0,a.Z)({},e))})}function H(e){var t=e.type;return(0,x.jsxs)("div",{children:[(0,x.jsx)(F,{type:t}),(0,x.jsx)(Z,{type:t})]})}function M(e){return(0,x.jsx)(c.SV,{children:(0,x.jsx)(H,(0,a.Z)({},e))})}function O(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function R(e){var t=e.match,n=(0,i.gQ)("All Cases"),p=n.unreadCasesQuantity,f=n.isHidden,h=(0,u.useState)(0),b=(0,s.Z)(h,2),j=b[0],y=b[1],_=t.url,v=(0,d.k6)(),g=(0,d.TH)(),S=m.parse(g.search);console.log("query",S),(0,u.useEffect)((function(){switch(S.type){case"":default:y(0);break;case"client":y(1);break;case"staff":y(2)}}),[S.type]);var k=function(e){v.push({search:m.stringify((0,a.Z)({},e?{type:e}:{}),{encode:!1})})};return(0,x.jsx)(r.d,{children:(0,x.jsxs)("div",{className:"profile",children:[(!f||0===p)&&(0,x.jsx)(l.q,{children:(0,x.jsx)("title",{children:"KENNEKT | User profile"})}),(0,x.jsxs)("div",{className:"content",children:[(0,x.jsx)("div",{className:"prime-tabs prime-tabs_no-bottom-extend",children:(0,x.jsxs)(c.sJ.Tabs,{scrollButtons:"auto",variant:"scrollable",value:j,onChange:function(e,t){switch(t){case 0:k();break;case 1:k("client");break;case 2:k("staff");break;default:return null}y(t)},"aria-label":"simple tabs example",children:[(0,x.jsx)(c.sJ.Tab,(0,a.Z)({label:"All",component:o.rU,to:_},O(0))),(0,x.jsx)(c.sJ.Tab,(0,a.Z)({label:"Clients cases",component:o.rU,to:"".concat(_,"?type=client")},O(1))),(0,x.jsx)(c.sJ.Tab,(0,a.Z)({label:"Staff cases",component:o.rU,to:"".concat(_,"?type=staff")},O(2)))]})}),(0,x.jsx)("div",{className:"business-profile-tab-content",children:(0,x.jsx)(M,{type:S.type||null})})]})]})})}var I=function(e){return(0,x.jsx)(c.SV,{children:(0,x.jsx)(_,{children:(0,x.jsx)(R,(0,a.Z)({},e))})})}}}]);
//# sourceMappingURL=7021.0ee00c51.chunk.js.map