"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[9789],{2213:function(e,t,n){n.d(t,{Z:function(){return d}});var a=n(42982),r=(n(47313),n(84365)),l=n(77344),i=n(79447),s=n(87180),o=n(46417);function c(e){switch(e){case"member":return{label:"Member",value:"member"};case"admin":return{label:"Admin",value:"admin"};case"manager":return{label:"Manager",value:"manager"};default:return null}}function d(e){var t=e.entity,n=e.onSuccess,d=(0,l.m)().companyId,u=(0,i.eC)().showNotification;return t?(0,o.jsx)("div",{children:d?(0,o.jsx)(r.Z.Main,{entity:"staffEmployee",name:"staffEmployee-".concat(d),url:"".concat(d,"/employee/").concat(t.id,"/"),method:"patch",id:t.id,primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},updateData:!0,fields:[{name:"avatar",required:!1,value:null===t||void 0===t?void 0:t.avatar,onSubmitKey:"",type:"object",onSubmitValue:function(e){return e||null}},{name:"first_name",required:!0,value:null===t||void 0===t?void 0:t.first_name,onSubmitKey:""},{name:"username",required:!0,value:null===t||void 0===t?void 0:t.username,onSubmitKey:""},{name:"last_name",required:!0,value:null===t||void 0===t?void 0:t.last_name,onSubmitKey:""},{name:"mobile",required:!0,value:null===t||void 0===t?void 0:t.mobile,onSubmitKey:""},{name:"roles",required:!0,value:c(null===t||void 0===t?void 0:t.roles[0]),type:"object",onSubmitKey:"",onSubmitValue:function(e){return[e.value]}},{name:"departments",onSubmitValue:function(e){return e.reduce((function(e,t){return[].concat((0,a.Z)(e),[{id:t}])}),[])},required:!1,type:"object",onSubmitKey:""},{name:"can_send_news",required:!1,value:null===t||void 0===t?void 0:t.can_send_news,onSubmitKey:""}],onSuccess:function(e,t){u({message:"Success! "}),t(),n()},onError:function(e,t){u({message:"Already exist",variant:"error"}),t()},children:function(e){var a=e.isSubmitting,r=e.values,l=e.setFieldValue,i=e.errors,c=e.setFieldError,d=e.resetForm;return(0,o.jsx)(s.Z,{values:r,setFieldValue:l,setFieldError:c,isSubmitting:a,errors:i,closeModal:n,resetForm:d,departments:null===t||void 0===t?void 0:t.departments,isCreate:!1})}}):null}):null}d.defaultProps={onSuccess:function(){}}},87180:function(e,t,n){n.d(t,{Z:function(){return _}});var a=n(1413),r=n(42982),l=n(70885),i=n(47313),s=n(94715),o=n(17480),c=n(51328),d=n(38251),u=n(46225),m=n(77344),f=n(26402),h=n(69706),p=n.n(h),x=n(57864),v=n(32335),b=n(95762),g=n(12715),j=n(52654),y=n(94435),S=n(79447),w=n(46417),N="".concat(v.Z.PUBLIC_ASSETS,"img"),k=[{label:"Admin",value:"admin"},{label:"Manager",value:"manager"},{label:"Member",value:"member"}];function _(e){var t=e.values,n=e.setFieldValue,h=(e.setFieldError,e.isSubmitting),v=(e.errors,e.closeModal),_=e.resetForm,C=e.isCreate,Z=e.departments,E=e.formValuesSetter,D=void 0===E?function(){return null}:E,F=(0,m.m)().companyId,P=(0,S.h9)({canSend:!C&&t.can_send_news}),V=P.checked,T=P.handleChange,A=(0,i.useState)(null),M=(0,l.Z)(A,2),K=M[0],q=M[1],L=(0,i.useState)(!1),I=(0,l.Z)(L,2),z=I[0],O=I[1],U=(0,i.useState)(C?null===t||void 0===t?void 0:t.avatar:null),B=(0,l.Z)(U,2),H=B[0],Q=B[1],W=(0,i.useState)({clientDeps:Z?Z.reduce((function(e,t){return t.is_staff?(0,r.Z)(e):[].concat((0,r.Z)(e),[t.id])}),[]):[],staffDeps:Z?Z.reduce((function(e,t){return t.is_staff?[].concat((0,r.Z)(e),[t.id]):(0,r.Z)(e)}),[]):[]}),R=(0,l.Z)(W,2),X=R[0],Y=R[1],G=[],J=[];(0,i.useEffect)((function(){H&&n("avatar",H)}),[H]);var $=X.clientDeps,ee=X.staffDeps;return(0,i.useEffect)((function(){n("departments",[].concat((0,r.Z)($),(0,r.Z)(ee)))}),[X]),(0,i.useEffect)((function(){if(C){var e=["first_name","username","last_name","mobile","departments"],n=Object.keys(t).filter((function(n){if((Array.isArray(t[n])?t[n].length:t[n])&&e.includes(n))return t[n]}));D(n)}}),[t]),(0,i.useEffect)((function(){n("can_send_news",V.canSend)}),[V.canSend]),(0,w.jsxs)("div",{id:"department-form",children:[(0,w.jsxs)("div",{className:"branch-form__header border-b border-kgrey-dark-1/30 px-6 py-4 -mt-5 flex-center-between",children:[(0,w.jsx)("div",{className:"branch-form__heading font-base font-medium",children:"".concat(C?"Create new":"Update"," staff")}),C?(0,w.jsx)("div",{className:"branch-form__reset text-kgrey text-sm cursor-pointer hover:text-kdark transition",onClick:_,children:"Clear"}):null]}),(0,w.jsxs)("div",{className:" w-100 p-6",children:[(0,w.jsx)("div",{className:"text-sm font-light mb-2 ml-2 text-kgrey-menuText",children:"Icon"}),(0,w.jsxs)("div",{className:"flex items-center mb-5",children:[(0,w.jsxs)("div",{className:"user-avatar-box__display relative dark:bg-kdark-lighter  w-20 h-20 rounded-full overflow-hidden flex-centered",children:[(0,w.jsx)("img",{src:C?p()(H,"thumbnail_150")||"".concat(N,"/chat-placeholder.png"):p()(null===t||void 0===t?void 0:t.avatar,"thumbnail_150")||"".concat(N,"/chat-placeholder.png"),alt:"",className:"object-fit"}),null!==K&&(0,w.jsxs)("div",{className:"absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 w-10 h-10 z-10",children:[(0,w.jsx)("div",{className:"upload-media-spinner",children:(0,w.jsx)(c.aN,{variant:"determinate",value:K})}),(0,w.jsx)("div",{onClick:function(){O(!0),q(null)},className:"absolute w-8 h-8 z-20 top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 text-3xl text-primary-dark hover:text-primary transition cursor-pointer",children:(0,w.jsx)(x.SV5,{})})]})]}),(0,w.jsx)("div",{className:"ml-5",children:(0,w.jsx)(c.bA,{uploadMeta:K,setUploadMeta:q,cancelSending:z,setCancelSending:O,setFile:Q})})]}),(0,w.jsx)(s.gN,{label:"First name:",name:"first_name",component:o.Mg,placeholder:"Enter First name"}),(0,w.jsx)(s.gN,{label:"Last name",name:"last_name",component:o.Mg,placeholder:"Enter Last name"}),(0,w.jsx)(s.gN,{label:"Email",name:"username",component:o.Mg,placeholder:"Enter Email"}),(0,w.jsx)(s.gN,{label:"Phone number",name:"mobile",component:o.UO,placeholder:"Enter company mobile phone number",enableSearch:!0,onChangeHandler:n}),(0,w.jsxs)("div",{className:"row align-user-start remove-inner-label mb-3.5",children:[(0,w.jsx)("div",{className:"text-sm font-light mb-2 ml-2 text-kgrey-menuText",children:"Staff Departments"}),(0,w.jsx)(b.Z.All,{entity:"tree",name:"AllTreeDepartments-Staff-".concat(F),url:"/".concat(F,"/departments/tree/"),params:{limit:100,extra:{is_staff:"True"}},children:function(e){var t=e.items,n=e.isFetched;return G=n&&(0,g.w)(t),(0,w.jsx)(w.Fragment,{children:n?(0,w.jsx)(f.ZP,(0,a.Z)({getPopupContainer:function(e){return e.parentNode},className:"w-full",transitionName:"rc-tree-select-dropdown-slide-up",choiceTransitionName:"rc-tree-select-selection__choice-zoom",dropdownStyle:{overflow:"auto"},dropdownPopupAlign:{overflow:{adjustY:0,adjustX:0},offset:[0,2]},placeholder:(0,w.jsx)("i",{children:"Select Staff Departments"}),searchPlaceholder:"please search",treeLine:!0,maxTagTextLength:10,multiple:!0,allowClear:!0,autoClearSearchValue:!0,treeData:G,treeNodeFilterProp:"title",treeCheckable:!0,showCheckedStrategy:f.hT,onChange:function(e){Y((function(t){return(0,a.Z)((0,a.Z)({},t),{},{staffDeps:e})}))}},C?null:{value:(0,r.Z)(ee)})):(0,w.jsx)("div",{className:"flex justify-center",children:(0,w.jsx)(c.aN,{})})})}})]}),(0,w.jsxs)("div",{className:"mb-3.5",children:[(0,w.jsx)("div",{className:"text-sm font-light mb-2 ml-2 text-kgrey-menuText",children:"Client Departments"}),(0,w.jsx)(b.Z.All,{entity:"tree",name:"AllTreeDepartments-Client-".concat(F),url:"/".concat(F,"/departments/tree/"),params:{limit:100,extra:{is_staff:"False"}},children:function(e){var t=e.items,n=e.isFetched;return J=n&&(0,g.w)(t),(0,w.jsx)(w.Fragment,{children:n?(0,w.jsx)(f.ZP,(0,a.Z)({getPopupContainer:function(e){return e.parentNode},className:"w-full",transitionName:"rc-tree-select-dropdown-slide-up",choiceTransitionName:"rc-tree-select-selection__choice-zoom",dropdownStyle:{overflow:"auto"},dropdownPopupAlign:{overflow:{adjustY:0,adjustX:0},offset:[0,2]},placeholder:(0,w.jsx)("i",{children:"Select \u0421lient Departments"}),searchPlaceholder:"please search",treeLine:!0,maxTagTextLength:10,multiple:!0,allowClear:!0,autoClearSearchValue:!0,treeData:J,treeNodeFilterProp:"title",treeCheckable:!0,showCheckedStrategy:f.hT,onChange:function(e){Y((function(t){return(0,a.Z)((0,a.Z)({},t),{},{clientDeps:e})}))}},C?null:{value:(0,r.Z)($)})):(0,w.jsx)("div",{className:"flex justify-center",children:(0,w.jsx)(c.aN,{})})})}})]}),(0,w.jsxs)("div",{className:"mb-3.5",children:[(0,w.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Roles"}),(0,w.jsx)(s.gN,{component:o.mg,styles:d.gb,name:"roles",defaultValue:k[2],options:k,isSearchable:!u.tq})]}),(0,w.jsx)("div",{children:(0,w.jsx)(y.D8,{control:(0,w.jsx)(j.k,{checked:V.canSend,onChange:T,name:"canSend"}),label:"Can send news",className:"mb-4",classes:{label:"!text-xs font-light text-kgrey-welcome"}})})]}),(0,w.jsxs)("div",{className:"branch-form__footer px-6 pt-4 pb-9 flex justify-end",children:[(0,w.jsx)(c.Ik,{className:"text-kgrey border-kgrey border mr-5",color:"default",onClick:v,children:"Cancel"}),(0,w.jsx)(c.Ik,{className:"dark:hover:bg-primary-300 dark:focus:ring-primary-300 dark:text-white",type:"submit",isSubmitting:h,color:"primary",children:C?"Create":"Update"})]}),h?(0,w.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-70",children:(0,w.jsx)(c.aN,{})}):null]})}_.defaultProps={isCreate:!0,department:null,resetForm:function(){}}},49789:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var a=n(70885),r=n(47313),l=n(51328),i=n(90182),s=n(94435),o=n(63830),c=n(90325),d=n(79447);var u=n(2213),m=n(23867),f=n(77344),h=n(46417),p=(0,r.lazy)((function(){return n.e(9014).then(n.bind(n,89014))})),x=(0,r.lazy)((function(){return n.e(363).then(n.bind(n,30363))}));function v(){var e=(0,f.m)().isAdmin,t=function(){var e=r.useState(0),t=(0,a.Z)(e,2),n=t[0],l=t[1],i=r.useState("Clients List"),s=(0,a.Z)(i,2),o=s[0],c=s[1],u=(0,r.useState)(!1),m=(0,a.Z)(u,2),f=m[0],h=m[1],p=(0,d.tv)(),x=p.location,v=p.match,b=v.url,g=v.path,j=(0,d.gQ)("ClientsManagement"),y=j.unreadCasesQuantity,S=j.isHidden;return(0,r.useEffect)((function(){var e=x.pathname.split("/").filter(Boolean).filter(String),t=e[e.length-1]||"";!function(){switch(t){case"general":l(0),c("General");break;case"cases":l(1),c("Cases")}}()}),[x]),{primeTab:n,pageName:o,url:b,path:g,unreadCasesQuantity:y,isHidden:S,handleChangePrime:function(e,t){l(t)},setEditStaff:h,editStaff:f,toggleEditStaff:function(){return h((function(e){return!e}))}}}(),n=t.pageName,v=t.path,b=t.unreadCasesQuantity,g=t.isHidden,j=(0,m.O)(),y=j.editVisible,S=j.closeEditPopup,w=j.showEditVisible,N=(0,r.useState)(null),k=(0,a.Z)(N,2),_=k[0],C=k[1];return(0,h.jsx)(c.d,{children:(0,h.jsxs)("div",{className:"p-4 max-w-full flex flex-col min-h-full flex-grow relative",children:[(!g||0===b)&&(0,h.jsx)(i.q,{children:(0,h.jsx)("title",{children:"KENNEKT | ".concat(n)})}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-5 w-full",children:[(0,h.jsx)("h2",{className:"text-xl md:text-3xl font-bold dark:text-white",children:"Staff Details"}),(0,h.jsx)("button",{type:"button",disabled:!e,onClick:function(){return w(_)},className:"bg-kgrey-bg rounded-xl text-sm md:text-base font-poppins text-center ml-5 px-4 py-2 hover:bg-primary-200 transition dark:bg-primary-300 dark:text-white disabled:opacity-70",children:"Edit staff"})]}),(0,h.jsx)(s.Cx,{handleModalOpen:S,open:Boolean(y),scrollable:!0,maxWidth:490,minWidth:490,noPadding:!0,children:(0,h.jsx)(u.Z,{entity:y,onSuccess:S})}),(0,h.jsx)("div",{className:"max-w-full flex-grow flex flex-col relative",children:(0,h.jsx)("div",{className:"relative flex-grow",children:(0,h.jsx)(r.Suspense,{fallback:(0,h.jsx)(l.aN,{tiled:!0}),children:(0,h.jsxs)(o.rs,{children:[(0,h.jsx)(o.AW,{exact:!0,path:"".concat(v,"/"),children:(0,h.jsx)(x,{setModalItem:C})}),(0,h.jsx)(o.AW,{exact:!0,path:"".concat(v,"/cases/"),component:p})]})})})})]})]})})}var b=function(){return(0,h.jsx)(l.SV,{children:(0,h.jsx)(v,{})})}},23867:function(e,t,n){n.d(t,{O:function(){return s}});var a=n(79447),r=n(77344),l=n(93905),i=n(92241);function s(){var e=(0,r.m)().companyId,t=(0,i.I0)(),n=(0,a.eC)().showNotification,s=(0,a.iR)(),o=s.visible,c=s.showVisible,d=s.loading,u=s.toggleLoading,m=s.closePopup,f=(0,a.iR)(),h=f.visible,p=f.showVisible,x=f.closePopup;return{deleteLoading:d,handleClientDelete:function(a){u(),t((0,l.Bi)({entity:"staffEmployee",name:"staffEmployee-".concat(e),method:"delete",url:"/".concat(e,"/employee/").concat(a.id,"/"),deleteData:!0,id:a.id,cb:{success:function(){n({message:"Successfully deleted",variant:"success"})},error:function(e){n({message:"Something went wrong",variant:"error"})},finally:function(){u(),m()}},params:{},primaryKey:"id",values:{}}))},showDeleteVisible:c,closeDeletePopup:m,deleteVisible:o,editVisible:h,showEditVisible:p,closeEditPopup:x}}},12715:function(e,t,n){n.d(t,{w:function(){return r}});var a=n(42982),r=function e(t){return t.reduce((function(t,n){if(!(n.sub_departments.length>0))return[].concat((0,a.Z)(t),[{title:n.name,key:n.id,value:n.id}]);for(;n.sub_departments.length>0;)return[].concat((0,a.Z)(t),[{title:n.name,key:n.id,value:n.id,children:e(n.sub_departments)}])}),[])}}}]);