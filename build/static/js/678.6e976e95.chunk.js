!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b1849953-9d02-4e43-aa49-a551f98dfde8",e._sentryDebugIdIdentifier="sentry-dbid-b1849953-9d02-4e43-aa49-a551f98dfde8")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"679831ce0b54925e28194bc104f85683e4de96a1"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[678],{47431:function(e,n,t){t.d(n,{D:function(){return d}});var s=t(1413),a=t(72791),i=t(40084),l=t(74772),r=t(57090),o=t(80184),c=function(e){var n,t=e.caseData,s=e.isDragging,r=e.toggleCaseDetailsOpen,c=(0,a.useRef)(null),d=(0,i.m)().unreadMessagesCount,u=t.department,f=t.sub_department,m=t.title,h=t.last_message_type,g=t.last_message_text,x=t.last_message_author,p=t.case_number,v=t.last_message_time,b=t.id,y=null===t||void 0===t||null===(n=t.status)||void 0===n?void 0:n.id,S=t.priority,j=t.draft_message,k=t.has_linked_case,C=t.related_to_id,_=t.recurring_id,A=t.last_read_message,w=t.assignee_ids,N=(0,a.useMemo)((function(){return null===d||void 0===d?void 0:d[b]}),[b,d]);return(0,o.jsx)("div",{ref:c,className:"case-".concat(b," h-full"),children:(0,o.jsx)(l.y,{case_number:p,caseTitle:m,department:u,sub_department:f,last_message_author:x,last_message_time:v,last_message_type:h,last_message_text:g,hasUnread:N,caseId:b,statusId:y,pin_time:t.pin_time,priority:S,draftMessage:j,assigneeIds:w,isDragging:s,toggleCaseDetailsOpen:r,hasLinkedCase:k,relatedTo:C,recurringId:_,lastReadMessage:A})})};function d(e){return(0,o.jsx)(r.SV,{isCompact:!0,children:(0,o.jsx)(c,(0,s.Z)({},e))})}},43682:function(e,n,t){t.d(n,{I:function(){return l},m:function(){return f}});var s=t(70885),a=t(72791),i=t(31102);function l(){var e=a.useState(0),n=(0,s.Z)(e,2),t=n[0],l=n[1],r=a.useState("Billing"),o=(0,s.Z)(r,2),c=o[0],d=o[1],u=(0,i.tv)(),f=u.location,m=u.match,h=m.url,g=m.path,x=(0,i.gQ)("Billing"),p=x.unreadCasesQuantity,v=x.isHidden;return(0,a.useEffect)((function(){var e=f.pathname.split("/").filter(Boolean).filter(String),n=e[e.length-1]||"";!function(){switch(n){case"billing":l(0),d("Billing");break;case"invoice":l(1),d("Invoice");break;default:;}}()}),[f]),{primeTab:t,pageName:c,url:h,path:g,unreadCasesQuantity:p,setPrimeTab:l,isHidden:v,handleChangePrime:function(e,n){l(n)}}}var r=t(15861),o=t(64687),c=t.n(o),d=t(40084),u=t(97689);function f(){var e=(0,d.m)().companyId,n=(0,u.a)().companies,t=(0,i.tv)().history,l=(0,a.useState)(!1),o=(0,s.Z)(l,2),f=o[0],m=o[1],h=(0,a.useState)(!1),g=(0,s.Z)(h,2),x=g[0],p=g[1],v=(0,i.eC)().showNotification,b=(0,a.useState)(!1),y=(0,s.Z)(b,2),S=y[0],j=y[1],k=(0,a.useState)(null),C=(0,s.Z)(k,2),_=C[0],A=C[1],w=(0,i.bK)({url:"/".concat(e,"/payment/").concat(e,"/cancel-subscription/"),method:"put",cb:{success:function(){v({message:"Your subscription has been cancelled",variant:"success"}),m(!1),p(!1)},error:function(e,n){var t,s;v({message:(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Something went wrong",variant:"error"}),m(!1)}}}).fetchData,N=(0,i.bK)({url:"/payment/".concat(e,"/invoices/?page_size=10"),cb:{success:function(e){var n;null!==e&&void 0!==e&&null!==(n=e.results)&&void 0!==n&&n.length&&j(!0)},error:function(e,n){}}}).fetchData;(0,a.useEffect)((function(){if(N(),e&&n.length){var t=n.find((function(n){return n.company.id===e})),s=null===t||void 0===t?void 0:t.company.comp_subscription;s&&A(s)}}),[n,e]);var Z=(0,a.useCallback)((0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,w();case 3:case"end":return e.stop()}}),e)}))),[]);return{navigateToCheckout:(0,a.useCallback)((function(){return t.push("/checkout")}),[]),subscription:_,handleCancelRequest:Z,setCancelSubscription:p,cancelSubscription:x,cancelLoading:f,hasUserAlreadyPaidInvoice:S}}},50678:function(e,n,t){t.r(n),t.d(n,{default:function(){return ae}});var s=t(70885),a=t(72791),i=t(57090),l=t(1413),r=t(80184),o=(0,a.createContext)(null),c=function(e,n){return"SET_SEARCH_QUERY"===n.type?(0,l.Z)((0,l.Z)({},e),{},{searchQuery:n.payload}):e};function d(e){var n=e.children,t=(0,a.useReducer)(c,{searchQuery:""}),i=(0,s.Z)(t,2),l=i[0],d=i[1],u=(0,a.useCallback)((function(e){d({type:"SET_SEARCH_QUERY",payload:e})}),[]),f={searchQuery:l.searchQuery,setSearchQuery:u};return(0,r.jsx)(o.Provider,{value:f,children:n})}var u=function(){var e=(0,a.useContext)(o);if(!e)throw new Error("useBusinessContext must be used within the BusinessContextProvider");return e},f=t(54270),m=t(31102),h=t(85880);function g(){var e=u(),n=e.searchQuery,t=e.setSearchQuery;return(0,r.jsxs)("div",{className:"group-sidebar__search relative",children:[(0,r.jsx)("input",{type:"search",value:n,className:"group-sidebar__search-input w-full border-b outline-none md:w-36 border-kgrey-border-solid dark:border-white dark:text-white pl-7 transition focus:border-primary dark:focus:border-primary placeholder-[rgba(45, 45, 45, 0.3)] pt-2 pb-2 dark:bg-kdark",placeholder:"Search for staff",onChange:function(e){return t(e.target.value)}}),(0,r.jsx)("div",{className:"absolute top-1/2 left-0 -translate-y-1/2",children:(0,r.jsx)("div",{className:"text-kgrey",children:(0,r.jsx)(h.lnn,{})})})]})}var x=t(15861),p=t(64687),v=t.n(p),b=t(40084),y=t(35741),S=t(84230),j=t(39126),k=t(51625),C=t(22553),_=t(52006),A=t(58237),w=t(19670),N=t(91523),Z=t(28182),T=t(49935),E=t(87818),I=t(97689),R=t(1667),F=t(4942),D=t(6008),P=t(13889);function V(e){var n=e.title,t=e.extra,s=e.children,a=e.scrollWrapperHeight,i=e.onToggleSelectAll,l=e.selectAllChecked;return(0,r.jsxs)("div",{className:"staff-assign__column w-96 rounded-lg border-1px border-kgrey-light-grey-3 p-1 dark:border-kgrey-chatGrey",children:[(0,r.jsxs)("div",{className:"column__header flex items-center justify-between rounded-t-2xl bg-kgrey-bg py-2 pl-3 dark:bg-kdark-lighter",children:[(0,r.jsx)("h3",{className:"column__title text-lg font-semibold",children:n}),(0,r.jsx)("div",{className:"column__checkbox flex-center-y",children:(0,r.jsx)(S.D8,{control:(0,r.jsx)(S.XZ,{onChange:i,checked:l,color:"primary"}),label:"".concat(l?"Unselect":"Select"," all"),name:"select_all",classes:{label:"!text-kgrey"}})})]}),t,(0,r.jsx)(P.$B,{autoHide:!0,className:"rct-scroll",style:{height:a||"20rem"},children:s})]})}var U=t(14987);function M(e){var n=e.avatarUrl,t=e.title,s=e.onToggleChecked,a=e.checked,i=e.children;return(0,r.jsxs)("div",{className:"staff-assign__item relative my-1.5 rounded-lg bg-kgrey-bg py-2.5 px-2 dark:bg-kdark-lighter",children:[i||(0,r.jsxs)("div",{className:"flex-center-y gap-x-2",children:[n?(0,r.jsx)(S.Rz,{src:n,size:36}):null,(0,r.jsx)("h3",{className:"w-11/12 break-all dark:text-kgrey-d8d8d8",children:t})]}),(0,r.jsx)(S.D8,{classes:{root:"!mr-0"},className:"absolute right-0 top-0",control:(0,r.jsx)(S.XZ,{onChange:s,checked:a,color:"primary"}),label:null})]})}function H(e){var n=e.staffId,t=e.handleToggleItemChecked,l=e.isItemChecked,o=(0,b.m)().companyId,c=(0,a.useState)(1),d=(0,s.Z)(c,2),u=d[0];d[1];return n?(0,r.jsx)(y.Z.All,{entity:"reAssign-statuses",name:"statuses",url:"/v2/".concat(o,"/cases/staff-cases/"),params:{extra:{assignee:n},page:u,limit:10},dataKey:function(e){return e},appendData:!0,children:function(e){var n=e.items,s=(e.meta,e.isFetched),a=n;return(0,r.jsxs)(r.Fragment,{children:[a.map((function(e){return(0,r.jsx)(M,{onToggleChecked:t(null===e||void 0===e?void 0:e.id,q.STATUSES),checked:l(null===e||void 0===e?void 0:e.id,q.STATUSES),title:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e.id)})),s?null:(0,r.jsx)("div",{className:"case-chat-loader flex items-center justify-center",children:(0,r.jsx)(i.aN,{})})]})}}):null}var B=t(47431);function O(e){var n=e.staffId,t=e.handleToggleItemChecked,s=e.isItemChecked,a=e.selectedStatusIds,o=e.staffCasesPage,c=(e.setStaffCasesPage,(0,b.m)().companyId);return n?(0,r.jsx)(y.Z.All,{entity:"reAssign-cases",name:"cases",url:"/".concat(c,"/cases/filter/"),params:{extra:(0,l.Z)({assignees:n,all_cases:"true"},a.length&&{status:a})},appendData:!0,replaceIds:1===o,children:function(e){var n=e.items,a=e.isFetched,l=(e.meta,n);return(0,r.jsxs)(r.Fragment,{children:[l.map((function(e){return(0,r.jsx)(M,{onToggleChecked:t(null===e||void 0===e?void 0:e.id,q.CASES),checked:s(null===e||void 0===e?void 0:e.id,q.CASES),children:(0,r.jsx)("div",{className:"h-40",children:(0,r.jsx)(B.D,{caseData:e,isFetched:a,toggleCaseDetailsOpen:function(){}})})},null===e||void 0===e?void 0:e.id)})),a?null:(0,r.jsx)("div",{className:"case-chat-loader flex items-center justify-center",children:(0,r.jsx)(i.aN,{})})]})}}):null}function K(e){var n=e.staffSearchValue,t=e.handleToggleItemChecked,l=e.isItemChecked,o=e.staffId,c=(0,b.m)().companyId,d=(0,a.useState)(1),u=(0,s.Z)(d,2),f=(u[0],u[1]);return(0,a.useEffect)((function(){n.length&&f(1)}),[n]),(0,r.jsx)(y.Z.All,{entity:"reAssign-staff",name:"staff",url:"/".concat(c,"/employee/"),params:{extra:{search:n,exclude_ids:o},page:1,limit:10},appendData:!0,children:function(e){var n=e.items,s=e.isFetched,a=e.meta,o=n;return(0,r.jsxs)(r.Fragment,{children:[o.map((function(e){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(M,{onToggleChecked:t(null===e||void 0===e?void 0:e.id,q.STAFF),checked:l(null===e||void 0===e?void 0:e.id,q.STAFF),title:"".concat(null===e||void 0===e?void 0:e.first_name," ").concat(null===e||void 0===e?void 0:e.last_name)},null===e||void 0===e?void 0:e.id)})})),s&&null!==a&&void 0!==a&&a.current_page&&null!==a&&void 0!==a&&a.last_page&&(null===a||void 0===a?void 0:a.current_page)<(null===a||void 0===a?void 0:a.last_page)?(0,r.jsx)(i.$K,{setPage:function(){return f((function(e){return e+1}))}}):null,s?null:(0,r.jsx)("div",{className:"case-chat-loader flex items-center justify-center",children:(0,r.jsx)(i.aN,{})})]})}})}var q,Q=t(42982);function L(){var e,n,t=(0,E.v9)((function(e){return null===e||void 0===e?void 0:e.entity})),i=(0,a.useState)(1),r=(0,s.Z)(i,2),o=r[0],c=r[1],d=(0,a.useState)(""),u=(0,s.Z)(d,2),f=u[0],h=u[1],g=(0,a.useState)((e={},(0,F.Z)(e,q.CASES,[]),(0,F.Z)(e,q.STATUSES,[]),(0,F.Z)(e,q.STAFF,[]),e)),x=(0,s.Z)(g,2),p=x[0],v=x[1],b=(0,a.useState)((n={},(0,F.Z)(n,q.CASES,!1),(0,F.Z)(n,q.STATUSES,!1),(0,F.Z)(n,q.STAFF,!1),n)),y=(0,s.Z)(b,2),S=y[0],j=y[1],k=(0,m.s6)({entity:"reAssign-cases",entityName:"cases"}).all;function C(e){var n,s,a=e.toLowerCase();return null!==(n=null===t||void 0===t||null===(s=t["reAssign-".concat(a)])||void 0===s?void 0:s[a].ids)&&void 0!==n?n:[]}var _=(0,a.useCallback)((function(e,n){return p[n].includes(e)}),[p]),A=(0,a.useCallback)((function(e,n){return function(t){var s,a=null===(s=t.target)||void 0===s?void 0:s.checked;v(a?function(t){return(0,l.Z)((0,l.Z)({},t),{},(0,F.Z)({},n,[].concat((0,Q.Z)(t[n]),[e])))}:function(t){return(0,l.Z)((0,l.Z)({},t),{},(0,F.Z)({},n,(0,Q.Z)(t[n]).filter((function(n){return n!==e}))))})}}),[p,C]),w=(0,a.useCallback)((function(e){return function(n){var t=C(e);v((function(s){return(0,l.Z)((0,l.Z)({},s),{},(0,F.Z)({},e,n.target.checked?t:[]))})),j((function(t){return(0,l.Z)((0,l.Z)({},t),{},(0,F.Z)({},e,n.target.checked))}))}}),[C]),N=(0,a.useCallback)((function(e){var n;h(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value)}),[]);return(0,a.useEffect)((function(){var e=(0,l.Z)({},S);Object.keys(q).forEach((function(n){e[n]=function(e){var n=C(e).length;return 0!==n&&p[e].length===n}(n)})),j(e)}),[p]),(0,a.useEffect)((function(){S.CASES&&v((function(e){var n;return(0,l.Z)((0,l.Z)({},e),{},(0,F.Z)({},q.CASES,null===k||void 0===k||null===(n=k.items)||void 0===n?void 0:n.map((function(e){return null===e||void 0===e?void 0:e.id}))))}))}),[k,S.CASES]),(0,a.useEffect)((function(){c(1)}),[p[q.STATUSES]]),{handleStaffSearchValueChanged:N,handleToggleSelectAll:w,handleToggleItemChecked:A,isItemChecked:_,reAssignmentState:p,staffSearchValue:f,selectAll:S,staffCasesPage:o,setStaffCasesPage:c,setReAssignmentState:v}}function Y(e){var n=e.staff,t=e.onCloseReAssignmentModal,s=e.actionType,a=e.onOpenDeleteStaffConfirmModal,i=(0,b.m)().companyId,o=(0,m.eC)().showNotification,c=(0,m.Zp)().reloadEntityAll,d=L(),u=d.reAssignmentState,f=d.staffSearchValue,h=d.handleStaffSearchValueChanged,g=d.handleToggleSelectAll,p=d.handleToggleItemChecked,y=d.isItemChecked,j=d.selectAll,k=d.staffCasesPage,C=d.setStaffCasesPage,_=d.setReAssignmentState,A=(0,m.bK)({url:"/v2/".concat(i,"/cases/staff-cases/reassign/"),method:"post",values:{previous_assignee:null===n||void 0===n?void 0:n.id,assignee_ids:u[q.STAFF],case_ids:u[q.CASES]},cb:{success:function(e){_((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,F.Z)({},q.CASES,[]))})),o({message:"Cases has been re-assigned successfully!"}),c({entity:"reAssign-cases",name:"cases",url:"/".concat(i,"/cases/filter/"),params:{extra:{assignees:null===n||void 0===n?void 0:n.id,all_cases:"true",status:u[q.STATUSES]}},replaceIds:!0,cb:{success:function(e){var i;C(1),"delete"!==s||null!==e&&void 0!==e&&null!==(i=e.results)&&void 0!==i&&i.length||(t(),a(n))}}})},error:function(e){console.log(e,"reAssignStaffCases error")}}}),w=A.fetchData,N=A.loading,Z=N||!u.CASES.length||!u.STAFF.length;function T(){return(T=(0,x.Z)(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,r.jsxs)("div",{className:"staff-assign__wrapper py-2",children:[(0,r.jsxs)("div",{className:"staff-assign__header flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"header__title text-lg font-medium",children:"Assign Tasks"}),(0,r.jsxs)("div",{className:"header__buttons flex gap-x-2",children:[(0,r.jsx)(S.zx,{onClick:t,disabled:N,variant:"contained",classes:{root:"!bg-white !text-kgrey"},children:"Cancel"}),(0,r.jsxs)(S.zx,{variant:"contained",onClick:function(){return T.apply(this,arguments)},disabled:Z,color:"primary",classes:{root:"!bg-primary-dark !text-white"},children:[N&&(0,r.jsx)(U.Z,{tiled:!0})," Re-assign"]})]})]}),(0,r.jsxs)("section",{className:"staff-assign__row mt-4 flex gap-x-2",children:[(0,r.jsx)(V,{selectAllChecked:j[q.STATUSES],onToggleSelectAll:g(q.STATUSES),title:"Statuses",children:(0,r.jsx)(H,{staffId:null===n||void 0===n?void 0:n.id,handleToggleItemChecked:p,isItemChecked:y})}),(0,r.jsx)(V,{selectAllChecked:j[q.CASES],onToggleSelectAll:g(q.CASES),title:"Cases",scrollWrapperHeight:"23rem",children:(0,r.jsx)(O,{staffCasesPage:k,setStaffCasesPage:C,staffId:null===n||void 0===n?void 0:n.id,handleToggleItemChecked:p,isItemChecked:y,selectedStatusIds:u[q.STATUSES]})}),(0,r.jsx)(V,{selectAllChecked:j[q.STAFF],onToggleSelectAll:g(q.STAFF),title:"Staff",extra:(0,r.jsx)("div",{className:"column__extra my-1 rounded-lg bg-kgrey-bg py-1 px-3 dark:bg-kdark-lighter",children:(0,r.jsx)(D.Z,{onChange:h,classes:{root:"border-none"},placeholder:"Search user",type:"text",fullWidth:!0})}),children:(0,r.jsx)(K,{staffId:null===n||void 0===n?void 0:n.id,staffSearchValue:f,handleToggleItemChecked:p,isItemChecked:y})})]})]})}!function(e){e.STATUSES="STATUSES",e.CASES="CASES",e.STAFF="STAFF"}(q||(q={}));var W=t(63524);function z(e){var n=e.onConfirmReAssignRequireModal;return(0,r.jsxs)("div",{className:"re-assign-required__wrapper flex-center-center flex-col",children:[(0,r.jsxs)("div",{className:"flex-center-y mb-2.5 flex-col",children:[(0,r.jsx)(W.jBZ,{className:"text-amber-400",size:60}),(0,r.jsx)("h3",{className:"mb-1 text-center text-lg font-medium",children:"Warning"}),(0,r.jsx)("p",{className:"text-base text-kgrey-menuText dark:text-kgrey-d8d8d8",children:"To delete this user, the assigned tasks must be transferred to another staff member"})]}),(0,r.jsx)("div",{children:(0,r.jsx)(S.zx,{onClick:n,variant:"contained",color:"primary",classes:{root:"!bg-primary !text-white"},size:"medium",children:"Re-assign"})})]})}var G="No mobile number";function X(e){var n,t,l=e.fetchStaffCount,o=void 0===l?function(){}:l,c=(0,b.m)(),d=c.companyId,f=c.isAdmin,h=u().searchQuery,g=(0,I.a)(),p=g.company,F=g.userData,D=(0,m.h0)(),P=D.page,V=D.handlePage,U=(0,m.tv)(),M=U.match,H=U.history,B=(0,m.eC)().showNotification,O=(0,E.I0)(),K=(0,m.Zp)().reloadEntityAll,q=(null===F||void 0===F?void 0:F.id)===(null===p||void 0===p||null===(n=p.company)||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.id),Q=(0,A.O)(o),L=Q.deleteLoading,W=Q.handleClientDelete,X=Q.showDeleteVisible,$=Q.closeDeletePopup,J=Q.deleteVisible,ee=Q.editVisible,ne=Q.showEditVisible,te=Q.closeEditPopup,se=Q.staffCountLoading,ae=Q.reAssignModalVisible,ie=Q.clickReAssignButtonHandler,le=Q.closeReAssignModalHandler,re=Q.reAssignmentActionType,oe=Q.setReAssignmentActionType,ce=Q.reAssignRequiredWarningVisible,de=Q.showReAssignRequiredWarningVisible,ue=Q.closeReAssignRequiredWarningVisible,fe=(0,a.useCallback)((function(){oe("delete"),ie(ce),ue()}),[ce,ue]),me=(0,C.Z)(h,500),he=(0,s.Z)(me,1)[0],ge=(0,m.iR)(),xe=ge.visible,pe=ge.showVisible,ve=ge.loading,be=ge.toggleLoading,ye=ge.closePopup,Se=(0,m.bK)({url:"",dynamicUrl:!0,cb:{success:function(e,n){var t=(null===n||void 0===n?void 0:n[0]).onAfterCasesCountSuccess;null===t||void 0===t||t(e)},error:function(e){console.log(e,"requestUserAssignedCasesCount")}}}),je=Se.fetchData,ke=(Se.loading,(0,a.useCallback)((function(e){return(0,x.Z)(v().mark((function n(){return v().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,je({url:"/".concat(d,"/employee/").concat(null===e||void 0===e?void 0:e.id,"/check-assigned-cases/"),onAfterCasesCountSuccess:function(n){n.has_assigned_cases?de(e):X(e)}});case 2:case"end":return n.stop()}}),n)})))}),[])),Ce=function(){return function(){return e=xe,be(),void O((0,T.Bi)({entity:"staffEmployee",name:"staffEmployee-".concat(d),method:"post",url:"/".concat(d,"/employee/").concat(e,"/resend_invitation/"),values:{},cb:{success:function(){K({entity:"staffEmployee",name:"staffEmployee-".concat(d),url:"/".concat(d,"/employee/"),params:{page:1,limit:10}}),ye(),B({message:"Successfully resended",variant:"success"})},error:function(e){B({message:"Something went wrong",variant:"error"})},finally:function(){be()}},params:{},primaryKey:"id"}));var e}};return(0,r.jsx)("div",{children:d?(0,r.jsx)(y.Z.All,{entity:"staffEmployee",name:"staffEmployee-".concat(d),url:"/".concat(d,"/employee/"),replaceIds:!0,params:{limit:10,extra:{search:he},page:P},children:function(e){var n=e.items,t=e.isFetched,s=e.meta,a=n.map((function(e){return e}));return(0,r.jsxs)("div",{children:[(0,r.jsxs)(S.xJ,{classes:{root:"relative "},children:[(0,r.jsxs)(i.k6,{"aria-label":"simple table",classes:{root:"table-fixed dark-mode-styled-table"},children:[(0,r.jsx)(S.ss,{children:(0,r.jsxs)(i.AF,{children:[(0,r.jsx)(i.EU,{style:{width:"22%"},children:"Full name"}),(0,r.jsx)(i.EU,{style:{width:"24%"},children:"Email"}),(0,r.jsx)(i.EU,{style:{width:"18%"},children:"Phone number"}),(0,r.jsx)(i.EU,{style:{width:"12%"},children:"Role"}),(0,r.jsx)(i.EU,{style:{width:"10%"},children:"Status"}),(0,r.jsx)(i.EU,{style:{width:"14%",textAlign:"center"},children:"Actions"})]})}),(0,r.jsx)(S.RM,{children:a.map((function(e){var n=e.id,t=e.first_name,s=e.last_name,a=e.username,l=e.mobile,o=e.roles,c=e.state,d=e.avatar,u=e.is_business_owner,m=l?"+"===l[0]?l:"+".concat(l):G;return(0,r.jsxs)(i.AF,{children:[(0,r.jsx)(i.Yk,{children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-9 w-9 flex-shrink-0",children:(0,w.w)((null===d||void 0===d?void 0:d.thumbnail)||(null===d||void 0===d?void 0:d.thumbnail_150),t)}),"Pending"===c?(0,r.jsx)("div",{className:"truncate",children:(0,r.jsxs)("span",{className:"ml-2 text-sm font-medium",children:[t," ",s]})}):(0,r.jsx)(N.rU,{className:"truncate",to:"".concat(M.path,"/view/").concat(e.id),children:(0,r.jsxs)("span",{className:"ml-2 text-sm font-medium text-primary transition hover:text-primary-dark",children:[t," ",s]})})]})}),(0,r.jsx)(i.Yk,{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(0,r.jsx)("span",{className:"test-kdark-text text-sm",children:a})}),(0,r.jsx)(i.Yk,{children:m?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(j.lfG,{color:"#979797",size:"15px"}),(0,r.jsx)("a",{href:"tel:".concat(m),className:(0,Z.Z)("test-kdark-text ml-2 align-middle text-sm ",{"text-primary hover:text-primary-dark":m!==G,"pointer-events-none":m===G}),children:m})]}):null}),(0,r.jsxs)(i.Yk,{children:[o.map((function(e,n){return(0,r.jsxs)("span",{className:"text-sx text-kgrey",children:[" "+e+" ",o.length>1?(0,r.jsx)("span",{className:"text-kgrey",children:"|"}):null,u?(0,r.jsx)("span",{children:"| owner"}):null]},"".concat(n,"_").concat(e))})),"Pending"===c?(0,r.jsx)(i.Ik,{color:"primary",onClick:function(){return pe(n)},children:"Resend"}):null]}),(0,r.jsx)(i.Yk,{children:(0,r.jsx)(R.N,{status:c,children:c})}),(0,r.jsx)(i.Yk,{children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[!u&&(0,r.jsx)(i.cP.DeleteButton,{isDisabled:!q&&(u||!f),clickHandler:ke(e)}),(0,r.jsx)(i.cP.ViewButton,{isDisabled:!f||"Pending"===c,clickHandler:function(){return H.push("".concat(M.path,"/view/").concat(n))}}),(0,r.jsx)(i.cP.ReAssignButton,{clickHandler:function(){ie(e)},isDisabled:!f||"Pending"===c}),(0,r.jsx)(i.cP.EditButton,{isDisabled:q?"Pending"===c:u||!f||"Pending"===c,clickHandler:function(){return ne(e)}})]})})]},n)}))})]}),t&&se&&(0,r.jsx)(i.aN,{tiled:!0,withOverlay:!0})]}),(0,r.jsx)(i.sm,{featureHandler:function(){W(J)},isOpen:Boolean(J),toggleHandler:$,title:'Are you sure you want to delete the following staff member: "'.concat(null===J||void 0===J?void 0:J.first_name," ").concat(null===J||void 0===J?void 0:J.last_name,'"'),hasLoader:!0,isLoading:L}),(0,r.jsx)(i.sm,{featureHandler:Ce(),isOpen:Boolean(xe),toggleHandler:ye,title:"Are you sure to resend the Request",hasLoader:!0,isLoading:ve}),(0,r.jsx)(S.Cx,{handleModalOpen:te,open:Boolean(ee),maxWidth:490,minWidth:490,scrollable:!0,noPadding:!0,children:(0,r.jsx)(_.Z,{entity:ee,onSuccess:te})}),(0,r.jsx)(S.Cx,{handleModalOpen:le,open:Boolean(ae),children:(0,r.jsx)(Y,{onCloseReAssignmentModal:le,staff:ae,actionType:re,onOpenDeleteStaffConfirmModal:X})}),(0,r.jsx)(S.Cx,{handleModalOpen:ue,open:Boolean(ce),children:(0,r.jsx)(z,{onConfirmReAssignRequireModal:fe})}),(0,r.jsxs)("div",{className:"news__pagination my-4 flex items-center justify-between",children:[n.length?(0,r.jsx)(k.Z,{count:null===s||void 0===s?void 0:s.last_page,page:P?+P:1,defaultPage:6,siblingCount:1,color:"primary",onChange:V}):null,(0,r.jsx)("div",{className:"ml-4",children:(0,r.jsxs)("div",{className:"text-base font-medium dark:text-white",children:["Staff Count:"," ",(0,r.jsx)("span",{className:"ml-2 text-base font-semibold text-primary ",children:null===s||void 0===s?void 0:s.count})]})})]})]})}}):(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(i.aN,{})})})}function $(e){return(0,r.jsx)(i.SV,{children:(0,r.jsx)(X,(0,l.Z)({},e))})}var J=t(27945),ee=t(40133);function ne(e){var n=e.modalHandler,t=e.hasToShowGuard,s=e.formValuesSetter,i=e.fetchStaffCount,l=(0,b.m)().companyId,o=(0,a.useCallback)((function(){return n(null)}),[]),c=(0,m.eC)().showNotification;return(0,r.jsx)("div",{children:l?(0,r.jsx)(J.Z.Main,{entity:"staffEmployee",name:"staffEmployee-".concat(l),url:"".concat(l,"/employee/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},prependData:!0,fields:[{name:"avatar",required:!1,value:null,onSubmitKey:"",type:"object",onSubmitValue:function(e){return e||null}},{name:"first_name",required:!0,value:"",onSubmitKey:""},{name:"username",required:!0,value:"",onSubmitKey:""},{name:"last_name",required:!0,value:"",onSubmitKey:""},{name:"mobile",value:"",onSubmitKey:""},{name:"roles",required:!0,value:{label:"Member",value:"member"},type:"object",onSubmitKey:"",onSubmitValue:function(e){return[e.value]}},{name:"departments",onSubmitValue:function(e){return e.reduce((function(e,n){return[].concat((0,Q.Z)(e),[{id:n.value}])}),[])},value:[],required:!1,type:"array",onSubmitKey:""},{name:"can_send_news",required:!1,value:!0,onSubmitKey:""}],onSuccess:function(e,n){c({message:"Success! "}),i(),n(),o()},onError:function(e,n){var t,s,a;c({message:null!==(t=null===e||void 0===e||null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Something went wrong",variant:"error"}),n()},children:function(e){var n=e.isSubmitting,a=e.values,i=e.setFieldValue,l=e.errors,o=e.setFieldError,c=e.resetForm;return(0,r.jsx)(ee.Z,{values:a,setFieldValue:i,setFieldError:o,isSubmitting:n,errors:l,formValuesSetter:s,closeModal:t,resetForm:c})}}):null})}ne.defaultProps={onSuccess:function(){}};var te=t(43682);function se(){var e,n,t,l=(0,b.m)(),o=l.isAdmin,c=l.isPermitted,d=(0,m.gQ)("Staff Management"),u=d.unreadCasesQuantity,h=d.isHidden,x=(0,a.useState)(!1),p=(0,s.Z)(x,2),v=p[0],y=p[1],j=(0,m.Tn)(),k=j.formValues,C=j.guardOpen,_=j.setGuardOpen,w=j.formValuesSetter,N=(0,a.useState)(!1),T=(0,s.Z)(N,2),E=T[0],R=T[1],F=(0,A.O)(),D=F.staffCountLoading,P=F.staffCountResponse,V=F.paidMemberCount,U=F.fetchStaffCount,M=(0,m.tv)().history,H=(0,te.m)().subscription,B=(0,I.a)(),O=B.company,K=B.userData,q=(null===O||void 0===O||null===(e=O.company)||void 0===e||null===(n=e.owner)||void 0===n?void 0:n.id)===K.id,Q=(0,a.useRef)({});Q.current.subscription=H,Q.current.staffCountResponse=P,Q.current.paidMemberCount=V;var L=(0,a.useCallback)((function(){var e=Q.current||{},n=e.staffCountResponse,t=e.subscription,s=e.paidMemberCount;(null===n||void 0===n?void 0:n.staffs_count)<s||"TRIAL"===(null===t||void 0===t?void 0:t.subscription_type)&&null!==t&&void 0!==t&&t.is_available?y((function(e){return!e})):R(!0)}),[P,H,V]),Y=(0,a.useCallback)((function(){_((function(e){return!e}))}),[]),W=(0,a.useCallback)((function(){_(!1),w([]),L()}),[v]),z=(0,a.useCallback)((function(){k.length?_(!0):L()}),[k]);return(0,r.jsxs)("div",{className:"relative flex min-h-full max-w-full flex-grow flex-col p-4",children:[(!h||!q||0===u)&&(0,r.jsx)(f.q,{children:(0,r.jsx)("title",{children:"KENNEKT | Staff Management"})}),(0,r.jsxs)("div",{className:"mb-5",children:[(0,r.jsx)("div",{className:" absolute top-0 left-0 w-full bg-kred-pink-200",children:o?null:(0,r.jsx)("p",{className:"my-1 text-center text-xs text-kred-pink",children:"You do not have permission to perform some actions, please check with admin"})}),(0,r.jsxs)("div",{className:"mt-6 flex w-full flex-wrap items-center justify-between",children:[(0,r.jsxs)("div",{className:"mb-4 flex flex-1 items-center font-bold",children:[(0,r.jsx)("h2",{className:"text-xl dark:text-white md:text-3xl ",children:"Staff Management"}),H&&H.order&&H.paid_staffs_count?(0,r.jsxs)("span",{className:"ml-4",children:[(0,r.jsx)("span",{className:"mr-1 text-sm font-light text-kgrey-dark-3 dark:text-white",children:"Users count:"}),(0,r.jsxs)("span",{className:"text-base font-semibold text-primary",children:[null!==(t=null===P||void 0===P?void 0:P.staffs_count)&&void 0!==t?t:0,"/",H.paid_staffs_count]})]}):null]}),(0,r.jsxs)("div",{className:"ml-auto mb-4  flex max-w-full items-center",children:[(0,r.jsx)(g,{}),(0,r.jsx)(S.aW,{disabled:!c,type:"button",onClick:L,className:(0,Z.Z)({"pointer-events-none opacity-20":D}),children:"Add staff"})]})]})]}),(0,r.jsx)($,{fetchStaffCount:U}),(0,r.jsx)(i.sm,{featureHandler:function(){return M.push("/checkout")},isOpen:E,toggleHandler:function(){R(!1)},title:"You have reached limit to add staffs. Open checkout page?"}),(0,r.jsx)(S.Cx,{handleModalOpen:function(){k.length?_(!0):L()},open:v,maxWidth:446,noPadding:!0,scrollable:!0,children:(0,r.jsx)(ne,{modalHandler:L,hasToShowGuard:z,formValuesSetter:w,fetchStaffCount:U})}),(0,r.jsx)(i.sm,{featureHandler:W,isOpen:C,toggleHandler:Y,title:"You have unsaved changes, Are you sure to cancel?"})]})}var ae=function(){return(0,r.jsx)(i.SV,{children:(0,r.jsx)(d,{children:(0,r.jsx)(se,{})})})}},1667:function(e,n,t){t.d(n,{N:function(){return i}});var s=t(28182),a=(t(72791),t(80184));function i(e){var n=e.status,t=e.children;return(0,a.jsx)("span",{className:(0,s.Z)("inline-block rounded-4xl bg-primary py-0.5 px-5 text-10px uppercase leading-4 text-white",{"bg-kgrey-inputBg text-kdark":"Pending"===n,"bg-primary-dark":"Logged"===n}),children:null!==t&&void 0!==t?t:"Accepted"})}},6008:function(e,n,t){t.d(n,{o:function(){return c}});var s=t(1413),a=(t(72791),t(5088)),i=t(38596),l=t(6330),r=t(80184),o=(0,i.Z)((function(e){return(0,l.Z)({root:{border:"1px solid #B8BCCF",fontSize:"15px",lineHeight:1,borderRadius:"12px",padding:"10px 30px",fontWeight:300,width:"100%"},input:{padding:0}})}));function c(e){var n=o();return(0,r.jsx)(a.Z,(0,s.Z)({classes:{root:n.root,input:n.input}},e))}n.Z=c},19670:function(e,n,t){t.d(n,{w:function(){return i}});var s=t(70272),a=t(80184),i=function(e,n){return e?(0,a.jsx)(s.Z,{className:"inline-block",alt:n||"Business icon",src:e,style:{width:"100%",height:"100%"}}):(0,a.jsx)(s.Z,{className:"inline-block",style:{color:"#fff",width:"100%",height:"100%"},children:n?n[0].toUpperCase():null})}}}]);
//# sourceMappingURL=678.6e976e95.chunk.js.map