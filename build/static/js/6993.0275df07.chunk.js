!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="bdec9989-9350-4f1f-8d93-378f1a06f455",e._sentryDebugIdIdentifier="sentry-dbid-bdec9989-9350-4f1f-8d93-378f1a06f455")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"1d419c3c8a5f66a775a003b801a7dad6c0430a71"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[6993],{36993:function(e,t,n){n.r(t),n.d(t,{ContactDetail:function(){return de},ContactsList:function(){return se},ContactsListHeader:function(){return K},default:function(){return o}});var a=n(66128),i=n(80184);function l(){return(0,i.jsxs)("section",{className:"contacts-page h-full flex gap-x-5",children:[(0,i.jsx)(se,{}),(0,i.jsx)(de,{})]})}function o(){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(l,{})})}var r=n(29439),s=n(1413),c=n(17173),d=n(35741),u=n(40084),m=n(13889),p=n(28182),h=n(763),f=n(72791),x=n(16856),y=n(53148),v=n(16178),_=n(90218),g=(0,f.memo)((function(e){var t,n,a,l=e.id,o=e.photo,r=e.first_name,s=e.last_name,d=e.phone_numbers,u=void 0===d?[]:d,m=e.categoryList,g=void 0===m?[]:m,b=e.is_locked,j=(0,c.$G)().t,k=(0,_.K)().isRTL,N=(0,v.Kx)(),F=N.changeUrlParams,w=N.query,C=(0,f.useCallback)((function(){F({categories:w.categories,contact:l})}),[l,w.categories]),D=l===Number(w.contact);return(0,i.jsxs)("div",{onClick:C,className:(0,p.Z)("contact-item my-1.5 flex items-center border-b-1px border-kgrey-icon-bg  py-2 transition-colors duration-150 first:rounded-t-md hover:bg-primary-300  dark:text-white dark:hover:bg-primary-300",D?"bg-primary-300 dark:bg-primary-300":"bg-kgrey-bgmenu dark:bg-kdark-dark333"),children:[(0,i.jsx)(y.Rz,{className:"contact-item__avatar mx-3 inline-block",letter:"".concat(null===(t=r[0])||void 0===t?void 0:t.toUpperCase()).concat(null===(n=s[0])||void 0===n?void 0:n.toUpperCase()),src:(0,h.get)(o,"thumbnail_150"),size:50}),(0,i.jsxs)("div",{className:"contact-item__info inline-block ",children:[(0,i.jsxs)("p",{className:"contact-item__info--fullname text-sm text-kgrey-menuText dark:text-kgrey-light-grey-3",children:[r," ",s]}),(0,i.jsx)("h3",{className:"contact-item__info--phone text-base font-medium text-kdark dark:text-white",children:null===(a=u[0])||void 0===a?void 0:a.number}),(0,i.jsx)("small",{className:"contact-item__info--category text-xs text-kgrey",children:g.length?"".concat(j("category"),": ").concat(g[0].name):null})]}),(0,i.jsx)("div",{className:"contact-item__extra relative flex-1 justify-self-end",children:b?(0,i.jsx)(x.wU4,{className:(0,p.Z)("absolute -top-5",k?"left-5":"right-5")}):null})]})}));function b(e){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(g,(0,s.Z)({},e))})}g.displayName="ContactItemInner";var j=n(38327);function k(e){var t=e.searchQuery,n=(0,c.$G)().t,l=(0,u.m)().companyId,o=(0,v.Kx)().query,s=(0,f.useState)(1),p=(0,r.Z)(s,2),h=p[0],x=p[1],_=(0,f.useState)(1),g=(0,r.Z)(_,2),k=g[0],N=g[1];return(0,f.useEffect)((function(){var e=1===h?0:1,t=j.g.on("refetchContactList",(function(){setTimeout((function(){N(e),x(e)}),0)}));return function(){t()}}),[h]),(0,f.useEffect)((function(){N(1),x(1)}),[t,null==o?void 0:o.categories]),(0,i.jsx)("div",{className:"contact-list-items cursor-pointer pt-3.5",children:l?(0,i.jsx)(d.Z.All,{entity:"contacts",name:"AllContacts-".concat(l),url:"/".concat(l,"/contacts/"),dataKey:"results",params:{extra:{search:t,categories:null==o?void 0:o.categories},limit:50,page:null!=t&&t.length?k:h},appendData:!0,replaceIds:(1===h||0===h)&&!t.length,children:function(e){var l=e.items,o=e.meta,r=e.isFetched;return(0,i.jsxs)(i.Fragment,{children:[null!=o&&o.count?(0,i.jsxs)("h3",{className:"contact-list-items__total-count py-2 text-sm dark:text-kgrey-light-grey-3",children:[null==o?void 0:o.count," ",n("contacts_lower")]}):null,(0,i.jsx)(m.ZP,{className:"rct-scroll",autoHide:!0,style:{height:"70vh"},children:l.length>0?(0,i.jsx)("div",{className:"contact-list-items__wrapper",children:l.map((function(e){return(0,i.jsx)(b,{is_locked:e.is_locked,categoryList:e.categories,id:e.id,first_name:e.first_name,last_name:e.last_name,phone_numbers:e.phone_numbers,photo:e.photo},e.id)}))}):r?null:(0,i.jsx)(a.aN,{tiled:!0})}),r||0!==l.length?null:(0,i.jsx)(y.Od,{variant:"rect",height:35}),r&&null!=o&&o.current_page&&null!=o&&o.last_page&&(null==o?void 0:o.current_page)<(null==o?void 0:o.last_page)?(0,i.jsx)(a.$K,{setPage:function(){o.current_page!==h?x(o.current_page):t.length?N(k+1):x(h+1)}}):null]})}}):null})}function N(e){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(k,(0,s.Z)({},e))})}function F(e){var t=e.query,n=e.onSearchInput,l=(0,c.$G)().t;return(0,i.jsx)("div",{className:"list-header__search relative h-10 flex-1",children:(0,i.jsx)(a.Mj,{customPlaceholder:l("search_contacts"),query:t,handleInput:n})})}function w(){var e=(0,v.Kx)().query;return(0,i.jsx)("span",{className:(0,p.Z)("inline-block rounded-full p-2 align-middle transition-colors duration-150 hover:bg-primary-300  dark:hover:bg-primary-300",null!=e&&e.categories?"bg-primary-300":"bg-kgrey-bg dark:bg-kdark-dark333"),children:(0,i.jsxs)("svg",{className:"dark:text-kgrey-bg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#fff",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{d:"M1.5 6.75H22.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M5.25 12H18.75",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M9.75 17.25H14.25",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})}var C=n(93433),D=n(84373);function L(e){var t=e.title,n=e.checked,a=e.onToggleChecked,l=(0,_.K)().isRTL;return(0,i.jsxs)("div",{className:"contact-filter-form__filter-item flex-center-between py-1",children:[(0,i.jsx)("h3",{className:"contact-filter-form__filter-item--title",children:t}),(0,i.jsx)(y.D8,{classes:{root:"!mr-0"},className:(0,p.Z)({"right-0":!l,"left-1":l}),control:(0,i.jsx)(y.XZ,{onChange:a,checked:n,color:"primary"}),label:null})]})}function I(e){var t,n=e.onModalClose,l=(0,c.$G)().t,o=(0,u.m)().companyId,s=(0,v.Kx)(),p=s.handleSort,h=s.query,x=s.removeOneQueryParam,_=(0,f.useState)(h.categoies?null==h||null===(t=h.categories)||void 0===t?void 0:t.split(","):[]),g=(0,r.Z)(_,2),b=g[0],j=g[1],k=(0,f.useState)(1),N=(0,r.Z)(k,2),F=N[0],w=N[1];(0,f.useEffect)((function(){h.categories&&j(h.categories.split(",").map(Number))}),[]);var I=(0,f.useCallback)((function(e){return function(t){t.target.checked?j((function(t){return[].concat((0,C.Z)(t),[e])})):j((function(t){return t.filter((function(t){return t!==e}))}))}}),[]),S=(0,f.useCallback)((function(){p(b.join(","),"categories"),n()}),[b]),E=(0,f.useCallback)((function(){setTimeout((function(){j([]),x("categories")}),100)}),[]);return(0,i.jsxs)("div",{className:"contact-filter-form",children:[(0,i.jsxs)("div",{className:"contact-filter-form__top flex items-center justify-between",children:[(0,i.jsx)("h3",{className:"contact-filter-form__top--title",children:l("filter")}),(0,i.jsx)(D.mpJ,{className:"cursor-pointer",size:24,onClick:n})]}),(0,i.jsx)("div",{className:"py-5",children:(0,i.jsx)(d.Z.All,{entity:"contact-filter",name:"AllContactFilters-".concat(o),url:"/".concat(o,"/contacts/category/"),dataKey:"results",params:{limit:50,page:F},appendData:!0,replaceIds:1===F,children:function(e){var t=e.meta,n=e.items,l=e.isFetched;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.ZP,{className:"rct-scroll",autoHide:!0,style:{height:"400px"},children:n.length>0?n.map((function(e){return(0,i.jsx)(L,{title:e.name,onToggleChecked:I(e.id),checked:b.includes(e.id)},e.id)})):l?null:(0,i.jsx)(a.aN,{tiled:!0})}),l&&null!=t&&t.current_page&&null!=t&&t.last_page&&(null==t?void 0:t.current_page)<(null==t?void 0:t.last_page)?(0,i.jsx)(a.$K,{setPage:function(){t.current_page!==F?w(t.current_page):w(F+1)}}):null]})}})}),(0,i.jsxs)("div",{className:"contact-filter-form__footer flex justify-end space-x-3",children:[(0,i.jsx)(y.Ik,{onClick:E,children:l("clear_filter")}),(0,i.jsx)(y.Ik,{onClick:S,color:"primary",children:l("show_result")})]})]})}var S=(0,f.memo)((function(){var e=(0,v.dF)(),t=e.WhiteModal,n=e.open,a=e.modalHandler;return(0,i.jsxs)("div",{className:"list-header__filter cursor-pointer",children:[(0,i.jsx)("span",{onClick:a,children:(0,i.jsx)(w,{})}),(0,i.jsx)(t,{open:n,handleModalOpen:a,children:(0,i.jsx)(I,{onModalClose:a})})]})}));S.displayName="ContactsListHeaderFilter";var E=S;function V(e){var t=e.query,n=e.onSearchInput;return(0,i.jsxs)("div",{className:"list__header flex items-center gap-x-2.5",children:[(0,i.jsx)(F,{query:t,onSearchInput:n}),(0,i.jsx)(E,{})]})}function K(e){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(V,(0,s.Z)({},e))})}var M=n(8826),Z=n(27945),q=n(13925),O=n(42124),A=n(76188),R=n(77917),B=n(80266),P=n(92112);function H(e){var t=e.children,n=e.onAddFieldClick;return(0,i.jsxs)("span",{onClick:n,className:"add-contact-field-button cursor-pointer",children:[(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:"inline-block align-middle",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("rect",{width:"24",height:"24",rx:"12",fill:"#00A09D"}),(0,i.jsxs)("g",{clipPath:"url(#clip0_8042_5517)",children:[(0,i.jsx)("path",{d:"M12 8.63965V15.3596",stroke:"white",strokeWidth:"0.96",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M8.63965 12H15.3596",stroke:"white",strokeWidth:"0.96",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"clip0_8042_5517",children:(0,i.jsx)("rect",{width:"11.52",height:"11.52",fill:"white",transform:"translate(6.24023 6.24023)"})})})]}),(0,i.jsx)("span",{className:"inline-block px-1.5 align-middle text-sm",children:t})]})}function T(e){var t=e.fieldName,n=e.required,a=e.children,l=e.className,o=void 0===l?"":l,r=e.showRemoveFieldButton,s=void 0!==r&&r,c=e.onRemoveFieldClicked,d=void 0===c?function(){}:c,u=e.showAddFieldButton,m=void 0!==u&&u,h=e.onAddFieldClicked,f=void 0===h?function(){}:h,x=e.addFieldButtonText,y=void 0===x?"":x;return(0,i.jsxs)("div",{className:(0,p.Z)("contact-form-row mb-4",o),children:[(0,i.jsxs)("div",{className:"contact-form-row__top flex items-center justify-between",children:[t?(0,i.jsxs)("label",{className:(0,p.Z)("ml-2 mb-2 block text-sm font-light text-kgrey-menuText"),children:[(0,i.jsx)("span",{children:t}),n?(0,i.jsx)("sup",{children:"*"}):null]}):null,s?(0,i.jsx)("span",{children:(0,i.jsx)(P.Qy,{onClick:d})}):null]}),a,m?(0,i.jsx)("div",{className:"contact-form-row__extra",children:(0,i.jsx)(H,{onAddFieldClick:f,children:y})}):null]})}var Y,W,U,z=n(9478),$=n(78820),X="".concat(z.Z.PUBLIC_ASSETS,"img/");function G(e){var t=e.setFieldValue,n=e.photo,l=(0,f.useState)(null),o=(0,r.Z)(l,2),s=o[0],c=o[1],d=(0,f.useState)(!1),u=(0,r.Z)(d,2),m=u[0],p=u[1],x=(0,f.useState)(n),y=(0,r.Z)(x,2),v=y[0],_=y[1],g=(0,f.useRef)(null);(0,f.useEffect)((function(){v&&t("photo",v)}),[v]);var b=(0,f.useCallback)((function(){var e,t;null==g||null===(e=g.current)||void 0===e||null===(t=e.uploader)||void 0===t||t.onClick()}),[g]),j=(0,f.useCallback)((function(){_(null),t("photo",null)}),[]);return(0,i.jsxs)("div",{className:"contact-image-uploader flex-center-center mb-4",children:[(0,i.jsx)("div",{className:"mr-4 hidden",children:(0,i.jsx)(a.bA,{ref:g,accept:"image/*",uploadMeta:s,setUploadMeta:c,cancelSending:m,setCancelSending:p,setFile:_})}),(0,i.jsxs)("div",{className:"contact-avatar-box__display flex-centered group relative h-20 w-20 overflow-hidden rounded-full",children:[(0,i.jsx)("img",{onClick:b,src:(0,h.get)(v,"thumbnail_150")||"".concat(X,"contact-image-upload-placeholder.png"),alt:"",className:"h-full object-cover"}),v&&!s&&(0,i.jsx)("div",{className:"absolute bottom-0 left-0 hidden h-1/3 w-full justify-center bg-kgrey-bg group-hover:flex",children:(0,i.jsx)(a.cP.DeleteButton,{clickHandler:j})}),null!==s&&(0,i.jsxs)("div",{className:"absolute top-1/2 left-1/2 z-10 h-10 w-10 -translate-y-1/2 -translate-x-1/2",children:[(0,i.jsx)("div",{className:"upload-media-spinner",children:(0,i.jsx)(a.aN,{variant:"determinate",value:s})}),(0,i.jsx)("div",{onClick:function(){p(!0),c(null)},className:"absolute top-1/2 left-1/2 z-20 h-8 w-8 -translate-y-1/2 -translate-x-1/2 cursor-pointer text-3xl text-primary-dark transition hover:text-primary",children:(0,i.jsx)($.SV5,{})})]})]})]})}function Q(e){var t,n,l,o=e.onModalClose,r=e.setFieldValue,s=e.values,d=e.dispatch,m=void 0===d?function(){}:d,p=e.isSubmitting,h=e.isEditForm,f=void 0!==h&&h,x=(0,c.$G)().t,y=(0,u.m)().companyId,v=function(e){var t,n=e.event,a=e.item,i=e.index,l=e.uniqueFieldKey,o=e.fieldListName;m({type:U.MODIFY_FIELD,payload:{index:i,fieldValue:null===(t=n.target)||void 0===t?void 0:t.value,type:null==a?void 0:a.type,code:null==a?void 0:a.code},fieldListName:o,uniqueFieldKey:l,setFieldValue:r})};return(0,i.jsx)(O.M,{utils:q.Z,children:(0,i.jsxs)("div",{className:"contact-form-elments",children:[(0,i.jsx)(G,{photo:s.photo,setFieldValue:r}),(0,i.jsxs)("div",{className:"contact-form-elements__main grid grid-cols-3 gap-x-2.5",children:[(0,i.jsx)(A.gN,{label:x("first_name"),name:"first_name",placeholder:x("enter_first_name"),onBlur:function(e){var t,n;r(e.target.name,null===(t=e.target)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.trim(),!0)},component:R.Mg,required:!0}),(0,i.jsx)(A.gN,{label:x("last_name"),name:"last_name",placeholder:x("enter_last_name"),onBlur:function(e){var t,n;r(e.target.name,null===(t=e.target)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.trim(),!0)},component:R.Mg,required:!0}),(0,i.jsx)(A.gN,{label:x("birthday"),name:"birthday",placeholder:"dd/mm/yyyy",format:"DD-MM-YYYY",component:R.z4,shouldDisableDate:function(e){var t=new Date;return t.setHours(0,0,0,0),!!e&&(null==e?void 0:e.toDate())>=t},dateValue:s.birthday})]}),null==s||null===(t=s[Y.phone_numbers])||void 0===t?void 0:t.map((function(e,t,n){return(0,i.jsx)(T,{fieldName:x("phone_number"),showRemoveFieldButton:t>0,onRemoveFieldClicked:function(){m({type:U.REMOVE_FIELD,payload:{index:t},fieldListName:Y.phone_numbers,setFieldValue:r})},showAddFieldButton:n.length-1===t,onAddFieldClicked:function(){m({type:U.ADD_FIELD,fieldListName:Y.phone_numbers,uniqueFieldKey:W.number,payload:{type:"Work",code:"WORK",fieldValue:""},setFieldValue:r})},addFieldButtonText:x("add_phone_number"),children:(0,i.jsx)(R.em,{type:"tel",value:e.number,name:"phone_number-".concat(t),onInputChange:function(n){v({event:n,item:e,index:t,uniqueFieldKey:W.number,fieldListName:Y.phone_numbers})},selectProps:{loadOptionsUrl:"/".concat(y,"/contacts/phone_email_network_types/"),loadOptionsKey:"phone_number_types.choices",loadOptionsParams:{extra:{type:"phone_number_types"}},value:{name:e.type,code:e.code},optionLabel:"name",optionValue:function(e){return e.code},onChange:function(e){m({type:U.MODIFY_FIELD,payload:{index:t,type:null==e?void 0:e.name,code:null==e?void 0:e.code,fieldValue:null},fieldListName:Y.phone_numbers,uniqueFieldKey:W.number,setFieldValue:r})}}})},t)})),null==s||null===(n=s[Y.emails])||void 0===n?void 0:n.map((function(e,t,n){return(0,i.jsx)(T,{fieldName:x("email_address"),showRemoveFieldButton:t>0,onRemoveFieldClicked:function(){m({type:U.REMOVE_FIELD,payload:{index:t},fieldListName:Y.emails,setFieldValue:r})},showAddFieldButton:n.length-1===t,onAddFieldClicked:function(){m({type:U.ADD_FIELD,fieldListName:Y.emails,uniqueFieldKey:W.email,payload:{type:"Work",code:"WORK",fieldValue:""},setFieldValue:r})},addFieldButtonText:x("add_email_address"),children:(0,i.jsx)(R.em,{type:"email",value:e.email,name:"email_address-".concat(t),onInputChange:function(n){v({event:n,item:e,index:t,uniqueFieldKey:W.email,fieldListName:Y.emails})},selectProps:{loadOptionsUrl:"/".concat(y,"/contacts/phone_email_network_types/"),loadOptionsKey:"email_types.choices",loadOptionsParams:{extra:{type:"email_types"}},value:{name:e.type,code:e.code},optionLabel:"name",optionValue:function(e){return e.code},onChange:function(e){m({type:U.MODIFY_FIELD,payload:{index:t,type:null==e?void 0:e.name,code:null==e?void 0:e.code,fieldValue:null},fieldListName:Y.emails,uniqueFieldKey:W.email,setFieldValue:r})}}})},t)})),(0,i.jsx)(T,{className:"react-select-dropdown",fieldName:x("category"),children:(0,i.jsx)(A.gN,{name:"categories",label:x("category"),loadOptionsUrl:"/".concat(y,"/contacts/category/"),loadOptionsKey:"results",optionLabel:"name",placeholder:x("select_category"),customStylesProps:B.KS,value:s.categories,onChange:function(e){r("categories",e)},component:a.qb,alwaysRefetch:!0,isMulti:!0})}),(0,i.jsx)(A.gN,{name:"addresses",label:x("address"),placeholder:x("enter_address"),component:R.Mg}),null==s||null===(l=s[Y.social_profiles])||void 0===l?void 0:l.map((function(e,t,n){return(0,i.jsx)(T,{fieldName:x("social_profiles"),showRemoveFieldButton:t>0,onRemoveFieldClicked:function(){m({type:U.REMOVE_FIELD,payload:{index:t},fieldListName:Y.social_profiles,setFieldValue:r})},showAddFieldButton:n.length-1===t,onAddFieldClicked:function(){m({type:U.ADD_FIELD,fieldListName:Y.social_profiles,uniqueFieldKey:W.username,payload:{type:"X",code:"X",fieldValue:""},setFieldValue:r})},addFieldButtonText:x("add_social_profile"),children:(0,i.jsx)(R.em,{type:"text",value:e.username,name:"social_profiles-".concat(t),onInputChange:function(n){v({event:n,item:e,index:t,uniqueFieldKey:W.username,fieldListName:Y.social_profiles})},selectProps:{loadOptionsUrl:"/".concat(y,"/contacts/phone_email_network_types/"),loadOptionsKey:"social_network_types.choices",loadOptionsParams:{extra:{type:"social_network_types"}},value:{name:e.type,code:e.code},optionLabel:"name",optionValue:function(e){return e.code},onChange:function(e){m({type:U.MODIFY_FIELD,payload:{index:t,type:null==e?void 0:e.name,code:null==e?void 0:e.code,fieldValue:null},fieldListName:Y.social_profiles,uniqueFieldKey:W.username,setFieldValue:r})}}})},t)})),(0,i.jsx)(A.gN,{name:"notes",label:x("notes"),placeholder:x("enter_note"),type:"textarea",component:R.Mg}),(0,i.jsxs)("div",{className:"contact-form-elements__buttons flex-center-end space-x-2.5",children:[(0,i.jsx)(a.Ik,{onClick:o,children:x("cancel")}),(0,i.jsx)(a.Ik,{isSubmitting:p,color:"primary",type:"submit",children:x(f?"save_changes":"save")})]})]})})}!function(e){e.phone_numbers="phone_numbers",e.emails="emails",e.social_profiles="social_profiles"}(Y||(Y={})),function(e){e.number="number",e.email="email",e.username="username"}(W||(W={})),function(e){e.ADD_FIELD="ADD_FIELD",e.ADD_EMAIL="ADD_EMAIL",e.ADD_SOCIAL_PROFILES="ADD_SOCIAL_PROFILES",e.MODIFY_FIELD="MODIFY_FIELD",e.REMOVE_FIELD="REMOVE_FIELD"}(U||(U={}));var J=n(4942);function ee(e,t){switch(t.type){case U.REMOVE_FIELD:var n=(0,C.Z)(null==e?void 0:e[t.fieldListName]).filter((function(e,n){var a;return n!==(null===(a=t.payload)||void 0===a?void 0:a.index)}));return t.setFieldValue(t.fieldListName,n),(0,s.Z)((0,s.Z)({},e),{},(0,J.Z)({},t.fieldListName,n));case U.MODIFY_FIELD:var a,i=t.payload,l=i.index,o=i.fieldValue,r=i.type,c=i.code,d=e[t.fieldListName].slice();return d[l]=(0,s.Z)((0,s.Z)({},d[l]),{},(a={type:r},(0,J.Z)(a,t.uniqueFieldKey,null!=o?o:d[l][t.uniqueFieldKey]),(0,J.Z)(a,"code",c),a)),t.setFieldValue(t.fieldListName,d),(0,s.Z)((0,s.Z)({},e),{},(0,J.Z)({},t.fieldListName,d));case U.ADD_FIELD:var u=t.payload,m=u.type,p=u.code,h=u.fieldValue,f=(0,J.Z)({type:m,code:p},t.uniqueFieldKey,h),x=[].concat((0,C.Z)(e[t.fieldListName]),[f]);return t.setFieldValue(t.fieldListName,x),(0,s.Z)((0,s.Z)({},e),{},(0,J.Z)({},t.fieldListName,x));default:return e}}var te=function(e,t){return e.length>0?e.map((function(e){return(0,J.Z)({type:e.code},t,e[t])})).filter((function(e){return!(0,h.isEmpty)(e[t])})):[]};function ne(e){var t=e.onModalClose,n=(0,u.m)().companyId,a=(0,v.Kx)(),l=a.changeUrlParams,o=a.query,s=(0,f.useReducer)(ee,{phone_numbers:[{type:"Mobile",code:"MOBILE",number:""}],emails:[{type:"Work",code:"WORK",email:""}],social_profiles:[{type:"X",code:"X",username:""}]}),d=(0,r.Z)(s,2),m=(d[0],d[1]),p=(0,v.eC)().showNotification,h=(0,c.$G)().t,x=(0,v.Zp)().reloadEntityAll;return(0,i.jsx)(Z.Z.Main,{entity:"contacts",name:"AllContacts-".concat(n),url:"/".concat(n,"/contacts/"),method:"post",sendAsFormData:!1,prependData:!1,appendData:!1,fields:[{name:"first_name",required:!0,onSubmitKey:"",type:"string"},{name:"last_name",required:!0,onSubmitKey:"",type:"string"},{name:"birthday",required:!1,onSubmitKey:"",onSubmitValue:function(e){return e?e.format("YYYY-MM-DD"):null},type:"string"},{name:"notes",required:!1,onSubmitKey:"",type:"string"},{name:"categories",required:!1,value:[],onSubmitKey:"",onSubmitValue:function(e){return e.map((function(e){return e.id}))},type:"array"},{name:"phone_numbers",required:!0,onSubmitKey:"",value:[{type:"Mobile",code:"MOBILE",number:""}],onSubmitValue:function(e){return te(e,"number")},type:"array"},{name:"emails",required:!1,value:[{type:"Work",code:"WORK",email:""}],onSubmitKey:"",onSubmitValue:function(e){return te(e,"email")},type:"array"},{name:"social_profiles",required:!1,value:[{type:"X",code:"X",username:""}],onSubmitKey:"",onSubmitValue:function(e){return te(e,"username")},type:"array"},{name:"addresses",required:!1,value:[],onSubmitKey:"",onSubmitValue:function(e){return e.length>0?[{adress:e}]:[]},type:"array"},{name:"photo",required:!1,value:null,onSubmitKey:"",type:"object"}],onSuccess:function(e,a){x({entity:"contacts",name:"AllContacts-".concat(n),url:"/".concat(n,"/contacts/"),replaceIds:!0,params:{extra:{categories:null==o?void 0:o.categories}}}),p({message:h("successfully_created")}),t(),l({contact:null==e?void 0:e.id})},onError:function(e,t){var n,a,i;p({message:null!==(n=null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.message)&&void 0!==n?n:h("something_went_wrong"),variant:"error"})},children:function(e){var n=e.values,a=e.setFieldValue,l=e.isSubmitting;return(0,i.jsx)(Q,{isEditForm:!1,isSubmitting:l,dispatch:m,values:n,setFieldValue:a,onModalClose:t})}})}var ae=function(e,t){return e.length?e:[t]};function ie(e){var t,n,a,l=e.onModalClose,o=(0,u.m)().companyId,s=(0,v.Kx)().query,d=(0,c.$G)().t,m=(0,v.eC)().showNotification,p=(0,v.r1)().updateEntities,h=Number(s.contact),x=(0,v.QY)({entityId:h,entity:"contacts",entityName:"ContactDetail-".concat(h)}).item,y=(0,f.useReducer)(ee,{phone_numbers:x.phone_numbers.map((function(e){return{code:e.type,number:e.number,type:(0,B.fm)(e.type)}})),emails:x.emails.map((function(e){return{code:e.type,email:e.email,type:(0,B.fm)(e.type)}})),social_profiles:x.social_profiles.map((function(e){return{code:e.type,username:e.username,type:(0,B.fm)(e.type)}}))}),_=(0,r.Z)(y,2),g=(_[0],_[1]);return(0,i.jsx)(Z.Z.Main,{id:h,primaryKey:"id",name:"contacts",entity:"AllContacts-".concat(o),url:"/".concat(o,"/contacts/").concat(h,"/"),method:"put",sendAsFormData:!1,prependData:!1,appendData:!1,updateData:!0,fields:[{name:"first_name",required:!0,value:x.first_name,onSubmitKey:"",type:"string"},{name:"last_name",required:!0,value:x.last_name,onSubmitKey:"",type:"string"},{name:"birthday",required:!1,onSubmitKey:"",value:x.birthday,onSubmitValue:function(e){return e?"string"==typeof e?e:e.format("YYYY-MM-DD"):null},type:"string"},{name:"notes",required:!1,value:x.notes,onSubmitKey:"",type:"string"},{name:"categories",required:!1,onSubmitKey:"",value:x.categories,onSubmitValue:function(e){return e.map((function(e){return e.id}))},type:"array"},{name:"phone_numbers",required:!0,onSubmitKey:"",value:ae(x.phone_numbers,{type:"Mobile",code:"MOBILE",number:""}),onSubmitValue:function(e){return te(e,"number")},type:"array"},{name:"emails",required:!1,value:ae(x.emails,{type:"Work",code:"WORK",email:""}),onSubmitKey:"",onSubmitValue:function(e){return te(e,"email")},type:"array"},{name:"social_profiles",required:!1,value:ae(x.social_profiles,{type:"X",code:"X",username:""}),onSubmitKey:"",onSubmitValue:function(e){return te(e,"username")},type:"array"},{name:"addresses",required:!1,value:null!==(t=null===(n=x.addresses)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.adress)&&void 0!==t?t:"",onSubmitKey:"",onSubmitValue:function(e){return e.length>0?[{adress:e}]:[]},type:"array"},{name:"photo",required:!1,value:x.photo,onSubmitKey:"",onSubmitValue:function(e){return e?{id:null==e?void 0:e.id,url:null==e?void 0:e.url,thumbnail:null==e?void 0:e.thumbnail,thumbnail_150:null==e?void 0:e.thumbnail_150,is_encrypted:null==e?void 0:e.is_encrypted}:null},type:"object"}],onSuccess:function(e,t){m({message:d("successfully_updated")}),l(),p({entity:"contacts",entityId:h,updatingData:e})},onError:function(e,t){var n,a,i;m({message:null!==(n=null==e||null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.message)&&void 0!==n?n:d("something_went_wrong"),variant:"error"})},children:function(e){var t=e.values,n=e.setFieldValue,a=e.isSubmitting;return(0,i.jsx)(Q,{isEditForm:!0,values:t,setFieldValue:n,onModalClose:l,isSubmitting:a,dispatch:g})}})}var le=(0,f.memo)((function(){var e=(0,v.dF)(),t=e.WhiteModal,n=e.open,a=e.modalHandler;return(0,i.jsxs)("div",{className:"add-contact-btn absolute bottom-24 right-10",children:[(0,i.jsx)("div",{className:"fixed",children:(0,i.jsx)(M.Z,{className:"fixed",onClick:a,color:"primary",size:"small",children:(0,i.jsx)(D.D0w,{className:"text-2xl text-white"})})}),(0,i.jsx)(t,{maxWidth:600,open:n,scrollable:!0,handleModalOpen:a,children:(0,i.jsx)(ne,{onModalClose:a})})]})}));le.displayName="AddContactButton";var oe=n(22553);function re(){var e=(0,f.useState)(""),t=(0,r.Z)(e,2),n=t[0],a=t[1],l=(0,f.useCallback)((function(e){a(e.target.value)}),[]),o=(0,oe.Z)(n,500),s=(0,r.Z)(o,1)[0];return(0,i.jsxs)("section",{className:"contacts-page__list relative w-[25rem]",children:[(0,i.jsx)(K,{query:n,onSearchInput:l}),(0,i.jsx)(N,{searchQuery:s}),(0,i.jsx)(le,{})]})}function se(){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(re,{})})}function ce(){var e=(0,v.Kx)().query,t=Number(null==e?void 0:e.contact),n=(0,u.m)().companyId;return(0,i.jsx)("section",{className:(0,p.Z)("contact-detail relative mb-3 max-h-full flex-1 rounded-10 bg-kgrey-bgmenu p-7 transition-transform duration-300 dark:bg-kdark-dark333",t?"translate-x-0":"translate-x-[100vw]"),children:t?(0,i.jsx)(d.Z.One,{id:t,entity:"contacts",name:"ContactDetail-".concat(t),params:{},relations:"",primaryKey:"id",url:"/".concat(n,"/contacts/").concat(t,"/"),children:function(e){var t,n,l,o=e.isFetched,r=e.item;return o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(pe,{photo:r.photo,first_name:r.first_name,last_name:r.last_name,phone_number:null===(t=null!==(n=r.phone_numbers)&&void 0!==n?n:[])||void 0===t?void 0:t[0],categories:null!==(l=r.categories)&&void 0!==l?l:[]}),(0,i.jsx)(ye,{contact:r}),(0,i.jsx)(ke,{is_locked:r.is_locked,created_by_id:r.created_by_id})]}):(0,i.jsx)(a.aN,{tiled:!0})}}):null})}function de(){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(ce,{})})}var ue=n(41578),me=(0,f.memo)((function(e){var t,n,a=e.first_name,l=e.last_name,o=e.phone_number,r=e.categories,s=e.photo,d=(0,c.$G)().t;return(0,i.jsxs)("div",{className:"contact-detail-header mb-4 flex items-center",children:[(0,i.jsx)(y.Rz,{letter:"".concat(null==a||null===(t=a[0])||void 0===t?void 0:t.toUpperCase()).concat(null==l||null===(n=l[0])||void 0===n?void 0:n.toUpperCase()),src:(0,h.get)(s,"thumbnail_150"),className:"contact-detail-header__avatar",size:120}),(0,i.jsxs)("div",{className:"contact-detail-header__primary-info px-5",children:[(0,i.jsxs)("p",{className:"primary-info__fullname pb-1.5 font-medium dark:text-kgrey-light-grey-3",children:[a," ",l]}),o?(0,i.jsxs)("div",{className:"primary-info__phone py-0.5",children:[(0,i.jsx)(ue.ri8,{size:24,className:"inline-block text-kgrey"}),(0,i.jsx)("span",{className:"primary-info__phone--text mx-2 inline-block align-middle text-base font-medium text-kdark dark:text-white",children:null==o?void 0:o.number})]}):null,r.length?(0,i.jsx)("div",{className:"primary-info__category",children:(0,i.jsxs)("span",{className:"primary-info__category--text inline-block align-middle text-base font-medium text-kdark dark:text-white",children:[(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ue.Lry,{size:24,className:"inline-block text-kgrey"}),(0,i.jsxs)("span",{className:"mx-2 inline-block",children:[d("category"),":"]})]}),null==r?void 0:r.map((function(e){return(0,i.jsx)("span",{className:"mx-1 my-0.5 inline-block rounded-xl bg-kgrey-bgDashboardItem px-1.5 py-1 dark:bg-kdark",children:null==e?void 0:e.name},e.id)}))]})}):null]})]})}));function pe(e){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(me,(0,s.Z)({},e))})}function he(e){var t=e.title,n=e.children,a=e.show;return void 0===a||a?(0,i.jsxs)("div",{className:"contact-detail-info__row mb-5 ",children:[(0,i.jsx)("h3",{className:"contact-detail-info__row--title text-sm uppercase text-kgrey-dark-2",children:t}),(0,i.jsx)("p",{className:"contact-detail-info__row--value mt-1 font-medium text-kdark dark:text-white",children:n})]}):null}function fe(e){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(he,(0,s.Z)({},e))})}me.displayName="ContactDetailHeaderInner";var xe=(0,f.memo)((function(e){var t,n,a,l,o,r=e.contact,s=(0,c.$G)().t;return(0,i.jsx)(m.ZP,{className:"rct-scroll",autoHide:!0,style:{height:"55vh"},children:(0,i.jsxs)("div",{className:"contact-detail-info",children:[(0,i.jsx)(fe,{title:s("phone_number"),show:!(0,h.isEmpty)(r.phone_numbers),children:null==r||null===(t=r.phone_numbers)||void 0===t?void 0:t.map((function(e){return(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{className:"text-base font-medium text-kgrey-menuText",children:[e.type,":"]}),(0,i.jsx)("span",{className:"mx-1",children:e.number})]},e.id)}))}),(0,i.jsx)(fe,{title:s("email_address"),show:!(0,h.isEmpty)(r.emails),children:null==r||null===(n=r.emails)||void 0===n?void 0:n.map((function(e){return(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{className:"text-base font-medium text-kgrey-menuText",children:[e.type,":"]}),(0,i.jsx)("span",{className:"mx-1",children:e.email})]},e.id)}))}),(0,i.jsx)(fe,{title:s("address"),show:!(0,h.isEmpty)(r.addresses),children:null===(a=r.addresses)||void 0===a||null===(l=a[0])||void 0===l?void 0:l.adress}),(0,i.jsx)(fe,{title:s("birthday"),show:!(0,h.isEmpty)(r.birthday),children:r.birthday}),(0,i.jsx)(fe,{title:s("social_profiles"),show:!(0,h.isEmpty)(r.social_profiles),children:null==r||null===(o=r.social_profiles)||void 0===o?void 0:o.map((function(e){return(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{className:"text-base font-medium text-kgrey-menuText",children:[e.type,":"]}),(0,i.jsx)("span",{className:"mx-1",children:e.username})]},e.id)}))}),(0,i.jsx)(fe,{title:s("notes"),show:!(0,h.isEmpty)(r.notes),children:r.notes})]})})}));function ye(e){return(0,i.jsx)(a.SV,{children:(0,i.jsx)(xe,(0,s.Z)({},e))})}xe.displayName="ContactDetailInfoInner";var ve=n(80180),_e=n(87818),ge=n(49935),be=n(97689),je=n(25763),ke=(0,f.memo)((function(e){var t=e.is_locked,n=e.created_by_id,l=(0,c.$G)().t,o=(0,be.a)().userData,r=(0,u.m)(),s=r.companyId,d=r.isAdmin,m=(0,v.eC)().showNotification,p=(0,v.dF)(),h=p.WhiteModal,f=p.open,y=p.modalHandler,_=(0,v.dF)(),g=_.open,b=_.modalHandler,j=(0,v.dF)(),k=j.open,N=j.modalHandler,F=(0,v.Kx)(),w=F.query,C=F.removeMultipleParams,D=(0,v.r1)().updateEntities,L=(0,_e.I0)(),I=Number(null==w?void 0:w.contact),S=n===(null==o?void 0:o.id),E=t?S:S||d,V=(0,ve.v)({name:"AllContacts-".concat(s),entity:"contacts",method:"delete",url:"/".concat(s,"/contacts/").concat(I,"/"),deleteData:!0,id:I,cb:{success:function(){b(),m({message:l("successfully_deleted")}),C(["contact"]),L((0,ge.KX)("contacts","AllContacts-".concat(s)))},error:function(e){var t,n,a;m({message:null!==(t=null===(n=e.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message)&&void 0!==t?t:l("something_went_wrong"),variant:"error"})}}}).handleRequest,K=(0,v.bK)({url:"/".concat(s,"/contacts/").concat(I,"/"),method:"patch",values:{is_locked:!t},cb:{success:function(e){m({message:l("successfully_updated")}),N(),D({entity:"contacts",entityId:I,updatingData:{is_locked:null==e?void 0:e.is_locked}})},error:function(e){var t,n,a;m({message:null!==(t=null===(n=e.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message)&&void 0!==t?t:l("something_went_wrong"),variant:"error"})}}}),M=K.fetchData,Z=K.loading;return(0,i.jsxs)("div",{className:"contact-detail__buttons absolute bottom-2 right-10 space-x-2",children:[E?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.Ik,{onClick:y,iconComponent:(0,i.jsx)(x.oTc,{}),color:"primary",children:l("edit")}),(0,i.jsx)(a.Ik,{onClick:b,iconComponent:(0,i.jsx)(x.F1H,{}),className:"bg-red-500 text-white hover:bg-red-400 dark:bg-red-500",children:l("delete")})," "]}):null,S?(0,i.jsx)(a.Ik,{onClick:N,iconComponent:t?(0,i.jsx)(je.k6,{}):(0,i.jsx)(je.bCI,{}),className:"bg-kgrey text-white hover:bg-kgrey dark:bg-kgrey",children:l(t?"locked":"lock")}):null,(0,i.jsx)(h,{maxWidth:600,open:f,handleModalOpen:y,scrollable:!0,children:(0,i.jsx)(ie,{onModalClose:y})}),(0,i.jsx)(a.oL,{icon:(0,i.jsx)(x.XPx,{size:24}),primaryBtnText:l("yes_delete_it"),type:"error",featureHandler:function(){V()},title:l("delete_contact_confirmation"),isOpen:g,toggleHandler:b}),(0,i.jsx)(a.oL,{hasLoader:Z,isLoading:Z,icon:(0,i.jsx)(x.wU4,{size:24}),type:"success",primaryBtnText:l(t?"yes_unlock_it":"yes_lock_it"),featureHandler:function(){M()},title:l(t?"unlock_contact_confirmation":"lock_contact_confirmation"),helperText:l(t?"unlock_contact_helper_text":"lock_contact_helper_text"),isOpen:k,toggleHandler:N})]})}));ke.displayName="ContactDetailActions"}}]);
//# sourceMappingURL=6993.0275df07.chunk.js.map