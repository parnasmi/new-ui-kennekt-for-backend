"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[6396],{76396:function(e,t,n){n.r(t),n.d(t,{default:function(){return _e}});var a=n(42982),s=n(1413),i=n(30168),r=n(15861),l=n(70885),o=n(64687),d=n.n(o),c=n(47313),u=n(77344),m=n(30686),h=n(79320),g=n(5958),v=n(26926),f=n(14636),x=n(53251),p=n(46417);function y(e){var t=e.statusId,n=e.name,a=e.isConfirmationRequired,s=(0,x.X9)(),i=s.open,r=s.anchorEl,l=s.handleClick,o=s.handleCloseMenu,d=(0,u.m)(),c=d.setSelectedStatus,m=d.isAdmin;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:" absolute top-3 right-2.5 w-4 h-6 more-btn w-4 text-right cursor-pointer text-kgrey-menuText hover:text-primary dark:hover:text-primary transition-colors dark:text-white",onClick:l,children:(0,p.jsx)(g.T41,{className:"inline"})}),i?(0,p.jsxs)(v.v2,{id:"long-menu",anchorEl:r,keepMounted:!0,open:i,onClose:o,children:[m?(0,p.jsx)(f.Z,{onClick:function(){o(),c({name:n,statusId:t,type:"edit"})},children:"Edit Status Name"}):null,m?(0,p.jsx)(f.Z,{onClick:function(){o(),c({name:n,statusId:t,type:"delete"})},children:"Delete Status"}):null,(0,p.jsx)(f.Z,{onClick:function(){o(),c({name:n,statusId:t,type:"mark_all_read"})},children:"Mark All Read"}),(0,p.jsx)(f.Z,{onClick:function(){o(),c({name:n,statusId:t,type:"add_buttons"})},children:(0,p.jsx)(v.D8,{control:(0,p.jsx)(v.XZ,{color:"primary",checked:a,className:"!py-0"}),label:"Add Buttons",labelPlacement:"start",className:"!ml-0"})})]}):null]})}var b=n(54070),_=n(51425),S=n(83061);function C(e){var t=e.name,n=e.totalCount,a=e.statusId,i=e.draggableHandleProps,r=e.isConfirmationRequired,l=(0,u.m)(),o=l.unreadCasesCountByStatus,d=l.selectedCaseFilter,c=l.caseType,m=l.setStatusReverseState,h=l.statusReverseState;return(0,p.jsxs)("div",(0,s.Z)((0,s.Z)({className:"relative status__header w-full bg-kgrey-bg dark:bg-kdark-lighter rounded-xl mb-4 pl-5 pr-14 py-3.5 leading-none flex-shrink-0"},i),{},{children:[(0,p.jsx)("strong",{className:"text-black font-medium dark:text-white",children:t}),a in o&&!d[c]?(0,p.jsxs)("span",{className:"text-kgrey-variant-2 text-sm font-thin ml-2",children:["/ unread cases:"," ",(0,p.jsx)("strong",{className:"font-semibold",children:o[a]})]}):null,n>0?(0,p.jsxs)("span",{className:"text-kgrey-variant-2 text-sm font-thin ml-2",children:["/ total cases: ",(0,p.jsx)("strong",{className:"font-semibold",children:n})]}):null,(0,p.jsx)(b.Z,{className:(0,S.Z)("!absolute right-6 top-2",{"!text-primary":null===h||void 0===h?void 0:h[a]}),size:"small",onClick:function(){return m(a)},children:null!==h&&void 0!==h&&h[a]?(0,p.jsx)(_.FO,{}):(0,p.jsx)(_.tK,{})}),(0,p.jsx)(y,{statusId:a,name:t,isConfirmationRequired:r})]}))}function j(e){return(0,p.jsx)(h.SV,{isCompact:!0,children:(0,p.jsx)(C,(0,s.Z)({},e))})}var Z=n(26005),k=n(95762),N=n(35990),D=function(e){return(0,p.jsxs)(N.ZP,(0,s.Z)((0,s.Z)({speed:2,width:362,height:150,viewBox:"0 0 362 150",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb"},e),{},{children:[(0,p.jsx)("rect",{x:"4",y:"24",rx:"0",ry:"0",width:"0",height:"1"}),(0,p.jsx)("rect",{x:"117",y:"153",rx:"0",ry:"0",width:"0",height:"1"}),(0,p.jsx)("rect",{x:"8",y:"1",rx:"4",ry:"4",width:"104",height:"12"}),(0,p.jsx)("rect",{x:"274",y:"0",rx:"7",ry:"7",width:"61",height:"17"}),(0,p.jsx)("circle",{cx:"351",cy:"7",r:"6"}),(0,p.jsx)("circle",{cx:"372",cy:"30",r:"6"}),(0,p.jsx)("circle",{cx:"351",cy:"23",r:"6"}),(0,p.jsx)("circle",{cx:"351",cy:"38",r:"6"}),(0,p.jsx)("circle",{cx:"26",cy:"56",r:"22"}),(0,p.jsx)("rect",{x:"66",y:"39",rx:"5",ry:"5",width:"199",height:"13"}),(0,p.jsx)("rect",{x:"68",y:"63",rx:"3",ry:"3",width:"136",height:"10"}),(0,p.jsx)("rect",{x:"68",y:"83",rx:"3",ry:"3",width:"135",height:"8"}),(0,p.jsx)("rect",{x:"25",y:"119",rx:"5",ry:"5",width:"242",height:"14"}),(0,p.jsx)("rect",{x:"327",y:"120",rx:"7",ry:"7",width:"17",height:"14"}),(0,p.jsx)("rect",{x:"304",y:"120",rx:"8",ry:"8",width:"17",height:"14"})]}))},w=function(e){return(0,p.jsxs)(N.ZP,(0,s.Z)((0,s.Z)({speed:2,width:362,height:800,viewBox:"0 0 362 800",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb"},e),{},{children:[(0,p.jsx)("rect",{x:"4",y:"24",rx:"0",ry:"0",width:"0",height:"1"}),(0,p.jsx)("rect",{x:"117",y:"153",rx:"0",ry:"0",width:"0",height:"1"}),(0,p.jsx)("circle",{cx:"372",cy:"30",r:"6"}),(0,p.jsx)("rect",{x:"5",y:"5",rx:"5",ry:"5",width:"350",height:"49"}),(0,p.jsx)("rect",{x:"6",y:"79",rx:"5",ry:"5",width:"347",height:"724"})]}))},I=n(47636),O=n(46225),P=n(65188),T=n(12723),M=n(72198),A=n(13165),R=n(38384),F=n(2797),E=function(e){var t=e.caseData,n=e.isDragging,a=e.toggleCaseDetailsOpen,s=(0,c.useRef)(null),i=(0,u.m)().unreadMessagesCount,r=t.department,l=t.sub_department,o=t.title,d=t.last_message_type,m=t.last_message_text,h=t.last_message_author,g=t.case_number,v=t.last_message_time,f=t.id,x=t.status.id,y=t.priority,b=t.draft_message,_=t.has_linked_case,S=t.related_to_id,C=t.recurring_id,j=t.assignee_ids,Z=(0,c.useMemo)((function(){return null===i||void 0===i?void 0:i[f]}),[f,i]);return(0,p.jsx)("div",{ref:s,className:"case-".concat(f," h-full"),children:(0,p.jsx)(F.y,{case_number:g,caseTitle:o,department:r,sub_department:l,last_message_author:h,last_message_time:v,last_message_type:d,last_message_text:m,hasUnread:Z,caseId:f,statusId:x,pin_time:t.pin_time,priority:y,draftMessage:b,assigneeIds:j,isDragging:n,toggleCaseDetailsOpen:a,hasLinkedCase:_,relatedTo:S,recurringId:C})})};function K(e){return(0,p.jsx)(h.SV,{isCompact:!0,children:(0,p.jsx)(E,(0,s.Z)({},e))})}var B=function(e){var t,n,a,s,i,r,l,o,d=e.caseData,c=e.isDragging,m=e.toggleCaseDetailsOpen,h=(0,u.m)().unreadMessagesCount,g=null===(t=d.case_)||void 0===t?void 0:t.department,v=null===(n=d.case_)||void 0===n?void 0:n.sub_department,f=null===d||void 0===d?void 0:d.text,x=null===(a=d.case_)||void 0===a?void 0:a.last_message_type,y=d.text,b=null===(s=d.case_)||void 0===s?void 0:s.last_message_author,_=null===(i=d.case_)||void 0===i?void 0:i.case_number,S=null===(r=d.case_)||void 0===r?void 0:r.priority,C=null===(l=d.case_)||void 0===l?void 0:l.last_message_time,j=null===d||void 0===d?void 0:d.entity_id,Z=null===d||void 0===d?void 0:d.case_.status,k=null===d||void 0===d?void 0:d.case_.draft_message,N=null===d||void 0===d?void 0:d.case_.assignee_ids,D=null===d||void 0===d?void 0:d.case_.has_linked_case,w=null===d||void 0===d?void 0:d.recurring_id,I=null===h||void 0===h?void 0:h[j];return(0,p.jsx)(F.y,{case_number:_,caseTitle:f,department:g,sub_department:v,last_message_author:b,last_message_time:C,last_message_type:x,last_message_text:y,hasUnread:I,caseId:j,pin_time:null===(o=d.case_)||void 0===o?void 0:o.pin_time,statusId:Z,searchedMessageId:d.id,priority:S,draftMessage:k,assigneeIds:N,isDragging:c,toggleCaseDetailsOpen:m,recurringId:w,relatedTo:null,hasLinkedCase:D})};function q(e){return(0,p.jsx)(h.SV,{isCompact:!0,children:(0,p.jsx)(B,(0,s.Z)({},e))})}function H(e){var t=e.draggableStyle,n=e.virtualStyle,a=e.isDragging,i=(0,s.Z)((0,s.Z)({},n),t);return(0,s.Z)((0,s.Z)({},i),{},{height:a?i.height:i.height-10,marginBottom:10})}function z(e){var t=e.provided,n=e.item,a=e.style,i=void 0===a?{}:a,r=e.isDragging,l=e.isFetched,o=void 0!==l&&l,d=e.toggleCaseDetailsOpen;return(0,p.jsx)("div",(0,s.Z)((0,s.Z)((0,s.Z)({},t.draggableProps),t.dragHandleProps),{},{ref:t.innerRef,style:H({draggableStyle:t.draggableProps.style,virtualStyle:i,isDragging:r}),className:"item ".concat(r?"is-dragging":""),children:"case_"in n?(0,p.jsx)(q,{caseData:n,isDragging:r,toggleCaseDetailsOpen:d}):(0,p.jsx)(K,{caseData:n,isFetched:o,isDragging:r,toggleCaseDetailsOpen:d})}))}var L,U=c.memo((function(e){var t=e.data,n=e.index,a=e.style,s=t.itemsData[n],i=t.toggleCaseDetailsOpen;if(!s)return null;var r=function(e){return"case_"in e?"".concat(e.id.toString(),"|").concat(e.case_.id.toString()):"".concat(e.id.toString(),"|").concat(e.id.toString())}(s);return(0,p.jsx)(M._l,{draggableId:r,index:n,children:function(e,n){return(0,p.jsx)(z,{isFetched:t.isFetched,provided:e,item:s,style:a,isDragging:n.isDragging,toggleCaseDetailsOpen:i})}},r)}),A.wy),V=n(32335),X=c.memo((function(e){var t=e.items,n=e.status,a=e.isFetched,s=e.loadMore,i=e.hasNextPage,r=e.toggleCaseDetailsOpen,l=e.currentStatusReverseState,o=(0,P.iP)().height,d=(0,c.useRef)(null),u=(0,c.useRef)(!1);return(0,c.useEffect)((function(){var e;u.current&&(d.current&&(null===d||void 0===d||null===(e=d.current)||void 0===e||e.resetloadMoreItemsCache()));u.current=!0}),[l]),(0,p.jsx)(M.bK,{droppableId:n.id.toString(),mode:"virtual",type:V.Z.CASES_DROPPABLE_TYPE,renderClone:function(e,n,s){return(0,p.jsx)(z,{provided:e,isDragging:n.isDragging,item:t[s.source.index],isFetched:a,toggleCaseDetailsOpen:r})},children:function(e){var n=i?t.length+1:t.length;return(0,p.jsx)(R.Z,{isItemLoaded:function(e){return e<t.length},itemCount:n,loadMoreItems:s,ref:d,children:function(s){var i=s.onItemsRendered,l=s.ref;return(0,p.jsx)(A.t7,{height:o?o-(O.tq?120:144):0,itemCount:n,itemSize:166,width:362,outerRef:e.innerRef,itemData:{itemsData:t,isFetched:a,toggleCaseDetailsOpen:r},className:"task-list",onItemsRendered:i,ref:l,children:U})}})}})})),W=n(76061),Y=n(70654),Q=n(1568),G=function(){return(0,Q.tZ)(Q.HY,{children:(0,a.Z)(Array(6)).map((function(e,t){return(0,Q.tZ)("div",{className:"mb-2",children:(0,Q.tZ)(D,{})},t)}))})},J=function(){return(0,Q.tZ)("div",{className:"h-[148px] border rounded-xl border-dashed flex-centered font-poppins text-kgrey",children:"No Cases"})};function $(e){var t=e.status,n=e.index,a=(0,c.useState)(1),r=(0,l.Z)(a,2),o=r[0],d=r[1],h=(0,c.useState)(1),g=(0,l.Z)(h,2),f=g[0],p=g[1],y=(0,u.m)(),b=y.searchQuery,_=y.caseType,C=y.isPermitted,N=y.statusReverseState,D=(0,I.Z)(),w=(0,l.Z)(D,2),A=w[0],R=w[1].height,F=(0,T.A)({statusId:t.id}),E=F.extraParams,K=F.casesUrl,B=F.selectedFilterTemplate,q=(0,Y.w5)({statusId:t.id,caseType:_,searchQuery:b,selectedFilterTemplate:B}),H=(0,P.s6)({entity:"cases",entityId:t.id,entityName:q}).all,z=null===N||void 0===N?void 0:N[t.id],U=(0,x.GH)(),V=U.toggleCaseDetailsOpen,$=U.caseDetailsOpen,ee=U.closeCaseDetailModal;(0,x.KT)(t),(0,c.useEffect)((function(){p(1),d(1)}),[b,B,z]);var te=(0,c.useCallback)((function(e){e&&(b.length?p(f+1):d(o+1))}),[b,o,f]);return(0,Q.tZ)(k.Z.All,{entity:"cases",name:q,url:K,params:{extra:(0,s.Z)({},E),limit:10,page:b.length?f:o},appendData:!0,cancelField:"status",replaceIds:1===o,isCancellable:!!b.length,children:function(e){var a=e.items,r=e.isFetched,l=e.meta,o=r&&(null===l||void 0===l?void 0:l.current_page)&&(null===l||void 0===l?void 0:l.last_page)&&(null===l||void 0===l?void 0:l.current_page)<(null===l||void 0===l?void 0:l.last_page);return(0,Q.tZ)(M._l,{draggableId:t.id.toString(),index:n,isDragDisabled:O.tq||!C,children:function(e){var n;return(0,Q.BX)("div",(0,s.Z)((0,s.Z)({className:(0,S.Z)("status status-".concat(t.id," flex h-full flex-col w-[362px] mr-4"),{hidden:r&&b.length&&!a.length})},e.draggableProps),{},{ref:e.innerRef,children:[(0,Q.tZ)(j,{name:t.title,totalCount:null===H||void 0===H||null===(n=H.meta)||void 0===n?void 0:n.count,statusId:t.id,isConfirmationRequired:t.is_confirmation_required,draggableHandleProps:e.dragHandleProps}),(0,Q.tZ)("div",{ref:A,className:"status__body w-full flex-grow bg-white dark:bg-transparent rounded-xl overflow-hidden relative",children:(0,Q.BX)("div",{css:(0,m.iv)(L||(L=(0,i.Z)(["\n\t\t\t\t\t\t\t\t\t\t\t\theight: ",";\n\t\t\t\t\t\t\t\t\t\t\t"])),O.G6&&"".concat(R,"px")),className:(0,S.Z)("h-full",!a.length&&"no-cases-found"),children:[(0,Q.BX)(Z.$B,{style:{height:"100%"},autoHide:!0,children:[!r&&0===a.length&&(0,Q.tZ)(G,{}),0===a.length&&r&&(0,Q.tZ)(J,{}),(0,Q.tZ)(X,{status:t,items:a,isFetched:r,loadMore:te,hasNextPage:o,toggleCaseDetailsOpen:V,currentStatusReverseState:z})]}),(0,Q.tZ)(v.Cx,{handleModalOpen:ee,open:Boolean($),minWidth:362,maxWidth:550,scrollable:!0,children:(0,Q.tZ)(W.z,{caseId:$,closeCaseDetailModal:ee})})]})})]}))}})}})}function ee(e){return(0,Q.tZ)(h.SV,{children:(0,Q.tZ)($,(0,s.Z)({},e))})}var te=n(67695),ne=n(81601),ae=n(82454),se=n(70163),ie=n.n(se),re=n(90182),le=n(36289),oe=(n(78884),n(94715)),de=n(84365),ce=n(17480),ue=n(92241);var me=function(e){var t,n,a=e.onClose,s=(0,u.m)(),i=s.companyId,r=s.caseType,l=(0,P.eC)().showNotification,o=(0,ue.v9)((function(e){return e.entity})),d="AllStatuses-".concat(i),c=null!==(t=null===(n=o.statuses)||void 0===n?void 0:n[d].ids)&&void 0!==t?t:[];return(0,p.jsx)(de.Z.Main,{entity:"statuses",name:"AllStatuses-".concat(i),url:"/".concat(i,"/my/company/case_statuses/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},appendData:!0,fields:[{name:"title",required:!0,onSubmitKey:""},{name:"order_number",value:c.length,onSubmitKey:""},{name:"is_default",value:!1,onSubmitKey:""},{name:"is_staff",value:r===V.Z.STAFF,onSubmitKey:""},{name:"is_feedback_required",value:!1,onSubmitKey:""},{name:"is_confirmation_required",value:!1,onSubmitKey:""}],onSuccess:function(e,t){l({message:"Status has been successfully created",variant:"success"}),a()},onError:function(e,t){var n,a,s;l({message:null!==(n=null===e||void 0===e||null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)&&void 0!==n?n:"Something went wrong",variant:"error"})},children:function(e){var t=e.values,n=e.isSubmitting;return(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{className:"font-bold text-xl mb-4",children:"Create New Status"}),(0,p.jsx)(oe.gN,{label:"Status Title",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",name:"title",component:ce.Mg,placeholder:"Type Status Title",required:!0}),(0,p.jsxs)("div",{className:"flex items-center justify-end mt-4",children:[(0,p.jsx)(v.zx,{variant:"outlined",type:"button",onClick:a,children:"Cancel"}),(0,p.jsx)(v.zx,{variant:"contained",type:"submit",className:"!ml-4",color:"primary",disabled:!t.title||n,children:"Create"})]}),n&&(0,p.jsx)(h.aN,{tiled:!0})]})}})};function he(){var e=(0,c.useState)(!1),t=(0,l.Z)(e,2),n=t[0],a=t[1],s=function(){return a((function(e){return!e}))};return(0,p.jsxs)("div",{className:"status flex h-full flex-col w-[362px] mr-4",children:[(0,p.jsx)(h.zx,{variant:"outlined",color:"primary",onClickHandler:s,children:"Create Status"}),(0,p.jsx)(v.Cx,{handleModalOpen:s,open:n,maxWidth:446,children:(0,p.jsx)(me,{onClose:s})})]})}var ge=n(61818);function ve(e){var t=e.closeEditStatusModal,n=(0,u.m)(),a=n.isStaff,s=n.companyId,i=n.selectedStatus,r=(0,P.eC)().showNotification,l=(0,P.s6)({entity:"statuses",entityName:"AllStatuses-".concat(s)}).all.items.find((function(e){return e.id===(null===i||void 0===i?void 0:i.statusId)}));return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(de.Z.Main,{id:null===i||void 0===i?void 0:i.statusId,entity:"statuses",name:"AllStatuses-".concat(s),url:"/".concat(s,"/my/company/case_statuses/").concat(null===i||void 0===i?void 0:i.statusId,"/"),method:"patch",primaryKey:"id",appendData:!0,sendAsFormData:!1,normalizeData:function(e){return e},fields:[{name:"confirmed",value:null===l||void 0===l?void 0:l.confirmed,onSubmitValue:function(e){return e?{id:e.id}:null},onSubmitKey:"",type:"object"},{name:"not_confirmed",value:null===l||void 0===l?void 0:l.not_confirmed,onSubmitValue:function(e){return e?{id:e.id}:null},onSubmitKey:"",type:"object"},{name:"is_confirmation_required",value:!0,onSubmitValue:function(e,t){return!!t.not_confirmed},onSubmitKey:"",type:"object"},{name:"title",value:null===l||void 0===l?void 0:l.title,onSubmitKey:"",type:"object"}],onSuccess:function(e,n){t()},onError:function(e,t){var n,a,s;r({message:null!==(n=null===e||void 0===e||null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)&&void 0!==n?n:"Something went wrong",variant:"error"})},children:function(e){var n=e.values,i=e.isSubmitting;return(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{className:"font-bold text-lg mb-6",children:"Action Buttons"}),(0,p.jsx)("div",{className:"mb-4",children:(0,p.jsx)(oe.gN,{component:ge.Z,customStylesProps:Y.gb,label:"Not Confirmed",labelClasses:"ml-2 text-sm font-light text-kgrey-menuText mb-2 block",name:"not_confirmed",optionLabel:"title",optionValue:"id",isSearchable:!0,isCached:!0,isClearable:!0,placeholder:"Select Not Confirmed Status",reverse:!0,loadOptionsUrl:"/".concat(s,"/my/company/case_statuses/"),loadOptionsParams:function(e){return{extra:{search:e,is_staff:a?"true":"false"}}},isOptionDisabled:function(e){var t;return e.id===(null===l||void 0===l?void 0:l.id)||(null===n||void 0===n||null===(t=n.confirmed)||void 0===t?void 0:t.id)===e.id},loadOptionsKey:""})}),(0,p.jsx)("div",{className:"mb-4",children:(0,p.jsx)(oe.gN,{component:ge.Z,customStylesProps:Y.gb,label:"Confirmed",labelClasses:"ml-2 text-sm font-light text-kgrey-menuText mb-2 block",name:"confirmed",optionLabel:"title",optionValue:"id",isSearchable:!0,isCached:!0,placeholder:"Select Confirmed Status",reverse:!0,isClearable:!0,loadOptionsUrl:"/".concat(s,"/my/company/case_statuses/"),loadOptionsParams:function(e){return{extra:{search:e,is_staff:a?"true":"false"}}},isOptionDisabled:function(e){var t;return e.id===(null===l||void 0===l?void 0:l.id)||(null===n||void 0===n||null===(t=n.not_confirmed)||void 0===t?void 0:t.id)===e.id},loadOptionsKey:""})}),(0,p.jsxs)("div",{className:"flex items-center justify-end mt-4",children:[(0,p.jsx)(v.zx,{variant:"outlined",type:"button",onClick:t,children:"Cancel"}),(0,p.jsx)(v.zx,{variant:"contained",type:"submit",className:"!ml-4",color:"primary",disabled:i||!(!!n.confirmed===!!n.not_confirmed),children:n.confirmed&&n.not_confirmed?"Add":"Reset"})]}),i&&(0,p.jsx)(h.aN,{tiled:!0})]})}})})}var fe=function(e){var t=e.onClose,n=(0,u.m)(),a=n.companyId,s=n.selectedStatus,i=(0,P.eC)().showNotification;return(0,p.jsx)(de.Z.Main,{id:null===s||void 0===s?void 0:s.statusId,entity:"statuses",name:"AllStatuses-".concat(a),url:"/".concat(a,"/my/company/case_statuses/").concat(null===s||void 0===s?void 0:s.statusId,"/"),method:"put",primaryKey:"id",appendData:!0,sendAsFormData:!1,normalizeData:function(e){return e},fields:[{name:"title",required:!0,value:(null===s||void 0===s?void 0:s.name)||"",onSubmitKey:""}],onSuccess:function(e,n){i({message:"Status has been successfully updated",variant:"success"}),t()},onError:function(e,t){var n,a,s;i({message:null!==(n=null===e||void 0===e||null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)&&void 0!==n?n:"Something went wrong",variant:"error"})},children:function(e){var n=e.values,a=e.isSubmitting;return(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{className:"font-bold text-xl mb-4",children:"Edit Status Name"}),(0,p.jsx)(oe.gN,{label:"Status Title",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",name:"title",component:ce.Mg,placeholder:"Type Status Title",required:!0,autoFocus:!0,id:"mail.com"}),(0,p.jsxs)("div",{className:"flex items-center justify-end mt-4",children:[(0,p.jsx)(v.zx,{variant:"outlined",type:"button",onClick:t,children:"Cancel"}),(0,p.jsx)(v.zx,{variant:"contained",type:"submit",className:"!ml-4",color:"primary",disabled:!n.title||a,children:"Update"})]}),a&&(0,p.jsx)(h.aN,{tiled:!0})]})}})};function xe(){var e=(0,u.m)(),t=e.isStaff,n=e.statusChangePayload,a=e.companyId,s=e.setStatusChangePayload,i=(0,c.useState)(!1),o=(0,l.Z)(i,2),m=o[0],g=o[1],f=(0,le.g)().changeCaseStatus,x=(0,c.useState)(null),y=(0,l.Z)(x,2),b=y[0],_=y[1],S=function(){var e=(0,r.Z)(d().mark((function e(a){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),g(!0),e.prev=2,e.next=5,f({prevStatusId:null===n||void 0===n?void 0:n.prevStatus,nextStatusId:null===b||void 0===b?void 0:b.id,isStaffCase:t,sourceIndex:null===n||void 0===n?void 0:n.sourceIndex,destinationIndex:0,entityId:Number(null===n||void 0===n?void 0:n.entityId),searchEntityId:null===n||void 0===n?void 0:n.searchEntityId,isDragging:!1});case 5:g(!1),C(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),g(!1);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){return s(null)};return(0,p.jsxs)("form",{onSubmit:S,children:[(0,p.jsx)("h2",{className:"mb-4 font-bold text-xl",children:"Status Change"}),(0,p.jsx)(h.qb,{customStylesProps:Y.gb,name:"status_change",placeholder:"Select Status",optionValue:"id",optionLabel:"title",loadOptionsKey:"",isSearchable:!0,isClearable:!0,alwaysRefetch:!0,value:b,loadOptionsOnMenuOpen:!0,reverse:!0,loadOptionsUrl:"/".concat(a,"/my/company/case_statuses/"),loadOptionsParams:function(e){return{extra:{search:e,is_staff:t?"true":"false"}}},isOptionDisabled:function(e){return e.id===(null===n||void 0===n?void 0:n.prevStatus)},onChange:function(e){return _(e)}}),(0,p.jsxs)("div",{className:"flex items-center justify-end mt-4",children:[(0,p.jsx)(v.zx,{variant:"outlined",type:"button",onClick:C,children:"Cancel"}),(0,p.jsx)(v.zx,{variant:"contained",type:"submit",className:"!ml-4",color:"primary",disabled:m||!b,children:"Change"})]}),m&&(0,p.jsx)(h.aN,{tiled:!0})]})}var pe,ye=n(63994);function be(){var e=(0,u.m)(),t=e.setPageType,n=e.caseType,o=e.selectedCaseFilter,g=e.setSelectedStatus,f=e.selectedStatus,p=e.statusChangePayload,y=e.setStatusChangePayload,b=e.isPermitted,_=(0,I.Z)(),S=(0,l.Z)(_,3),C=S[0],j=S[1].height,Z=(S[2],(0,u.m)()),N=Z.companyId,D=Z.setSearchQuery,T=Z.toggleChatPanel,A=Z.statusPriorityMessagePopup,R=Z.setStatusPriorityMessagePopup,F=(0,P.gQ)(),E=F.unreadCasesQuantity,K=F.isHidden,B=(0,le.g)(),q=B.onStatusDragEnd,H=B.fetchCasesUnreadCount,z=(0,x.X9)(),L=z.deleteStatusHandler,U=z.statusDeleteLoader,X=z.markAllReadHandler,W=z.markAllReadLoader;(0,x.lP)(),(0,x.jg)();var G=JSON.parse(Y.tO.get("selectedCaseFilter")||"{}")[n],J=o[n]||G;(0,c.useEffect)((function(){return t(!0),function(){t(!1)}}),[t]),(0,c.useEffect)((function(){return function(){D(""),T(!1)}}),[]),(0,c.useEffect)((function(){N&&(0,r.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:case"end":return e.stop()}}),e)})))()}),[N,n]);var $=function(){return g(null)},se=function(){return y(null)},oe=function(){return R(null)};return(0,Q.tZ)(ne.M,{utils:ae.Z,children:(0,Q.BX)("div",{ref:C,className:" cases-page-wrapper w-full h-full pl-2 lg:pl-7 pb-1 pt-2 lg:pt-5 flex flex-col",children:[(!K||0===E)&&(0,Q.tZ)(re.q,{children:(0,Q.tZ)("title",{children:"KENNEKT | Cases"})}),N?(0,Q.tZ)(k.Z.All,{entity:"statuses",name:"AllStatuses-".concat(N),url:"/".concat(N,"/my/company/case_statuses/"),reverse:!0,params:{extra:{is_staff:n===V.Z.STAFF?"true":"false"}},dataKey:function(e){return e},children:function(e){var t=e.items,n=e.isFetched,r=(e.meta,t.map((function(e){return e})));return(0,Q.tZ)(M.Z5,{onDragEnd:q,children:(0,Q.BX)("div",{className:"case-statuses-scroll-container flex h-full bg-white dark:bg-kdark flex-grow overflow-hidden overflow-x-auto relative",css:(0,m.iv)(pe||(pe=(0,i.Z)(["\n\t\t\t\t\t\t\t\t\t\t\theight: ","px;\n\t\t\t\t\t\t\t\t\t\t"])),j-(O.tq?8:20)),children:[(0,Q.tZ)(M.bK,{droppableId:V.Z.STATUS_DROPPABLE_ID,direction:"horizontal",type:V.Z.STATUS_DROPPABLE_TYPE,children:function(e){var t,a,i;return(0,Q.tZ)("div",{className:"flex",children:(0,Q.BX)("div",(0,s.Z)((0,s.Z)({className:"statuses-wrapper flex"},e.droppableProps),{},{ref:e.innerRef,children:[(0,Q.BX)(Q.HY,{children:[(null!==J&&void 0!==J&&null!==(t=J.filter_json)&&void 0!==t&&null!==(a=t.status)&&void 0!==a&&a.length?ie()(null===J||void 0===J||null===(i=J.filter_json)||void 0===i?void 0:i.status,"order_number"):r).map((function(e,t){return(0,Q.tZ)(te.Z,{in:!0,timeout:500*(t+1),children:(0,Q.tZ)(ee,{status:e,index:t},e.id)},e.id||t)})),e.placeholder]}),n&&b?(0,Q.tZ)(he,{}):null]}))})}}),!n&&(0,Q.tZ)(Q.HY,{children:(0,Q.tZ)("div",{className:"flex",children:(0,a.Z)(Array(6)).map((function(e,t){return(0,Q.tZ)(te.Z,{in:!0,timeout:300*(t+1),children:(0,Q.tZ)("div",{className:"mr-4",children:(0,Q.tZ)(w,{})})},t)}))})}),(0,Q.tZ)(v.Cx,{handleModalOpen:$,open:"edit"===(null===f||void 0===f?void 0:f.type)&&!!f,maxWidth:446,children:(0,Q.tZ)(fe,{onClose:$})}),(0,Q.tZ)(h.sm,{featureHandler:L,isOpen:Boolean("delete"===(null===f||void 0===f?void 0:f.type)&&!!f),toggleHandler:$,title:"Are You Sure To Delete ".concat(null===f||void 0===f?void 0:f.name.toUpperCase()," Status?"),hasLoader:!0,isLoading:U}),(0,Q.tZ)(h.sm,{featureHandler:X,isOpen:Boolean("mark_all_read"===(null===f||void 0===f?void 0:f.type)&&!!f),toggleHandler:$,title:"Are You Sure To Mark All Cases Read?",hasLoader:!0,isLoading:W}),(0,Q.tZ)(v.Cx,{handleModalOpen:$,open:"add_buttons"===(null===f||void 0===f?void 0:f.type)&&!!f,maxWidth:446,children:(0,Q.tZ)(ve,{closeEditStatusModal:$})}),(0,Q.tZ)(v.Cx,{handleModalOpen:se,open:!!p,maxWidth:446,children:(0,Q.tZ)(xe,{})}),(0,Q.tZ)(v.Cx,{handleModalOpen:oe,open:!!A,maxWidth:446,children:(0,Q.tZ)(ye.Rd,{onClose:oe})})]})})}}):null]})})}function _e(){return(0,Q.tZ)(h.SV,{children:(0,Q.tZ)(be,{})})}}}]);