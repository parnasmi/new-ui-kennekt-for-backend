"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[2566],{92566:function(e,n,l){l.r(n),l.d(n,{default:function(){return q}});var t=l(47313),a=l(65188),s=l(95762),i=l(77344),r=l(79320),o=l(26926),c=l(69706),d=l.n(c),m=l(930),u=l(84365),h=l(1413),x=l(70885),p=l(32335),b=l(94715),j=l(81934),v=l(70654),g=l(17480),y=l(61818),f=l(45522),N=l.n(f),C=l(46417),_="".concat(p.Z.PUBLIC_ASSETS,"img/");function k(e){var n=e.setFieldValue,l=e.onSuccess,s=e.isSubmitting,c=(0,i.m)().companyId,m=(0,t.useState)({firstname:"",lastname:"",phone:"",email:"",avatar:"".concat(_,"avatar-placeholder.png"),is_individual:!0,businessName:null}),u=(0,x.Z)(m,2),p=u[0],f=u[1],k=p.firstname,w=p.lastname,S=p.phone,F=p.email,P=p.avatar,E=p.is_individual,I=p.businessName,U=(0,t.useState)({}),O=(0,x.Z)(U,2),A=O[0],L=O[1];(0,a.ZS)((function(){var e=d()(A,"is_individual"),n=d()(A,"owner.first_name"),l=d()(A,"owner.last_name"),t=d()(A,"owner.mobile"),a=d()(A,"owner.username"),s=d()(A,"owner.avatar.thumbnail_150");return f((function(i){return(0,h.Z)((0,h.Z)({},i),{},{firstname:n||"No Firstname",lastname:l||"No Lastname",phone:e?t:A.phone||"No Phone",email:a||"No Email",avatar:s||null,is_individual:e,businessName:e?null:d()(A,"name")})})),function(){L({})}}),[A]);var q=!N()(A);return(0,C.jsxs)("div",{className:"w-full react-select-dropdown",children:[(0,C.jsx)("div",{className:"mb-4 react-select-dropdown",children:(0,C.jsx)(r.qb,{name:"route",customStylesProps:v.gb,placeholder:"Select Client to Link",optionLabel:function(e){return d()(e,"first_name")&&d()(e,"last_name")?"".concat(d()(e,"first_name")," ").concat(d()(e,"last_name")," (").concat(d()(e,"name"),") ").concat(d()(e,"is_individual")?" - Individual":" - Business"):"".concat(d()(e,"name")," ").concat(d()(e,"is_individual")?" - Individual":" - Business")},optionValue:"id",loadOptionsUrl:"/".concat(c,"/client_companies/"),loadOptionsParams:function(e){return{extra:{search:e}}},loadOptionsKey:"results",isSearchable:!0,isClearable:!0,onChange:function(e){e?(n("from_company",e.id),L(e)):L({})}})}),q?(0,C.jsx)(b.gN,{component:y.Z,customStylesProps:v.gb,name:"role",placeholder:"Select role here",optionLabel:"name",optionValue:"id",isSearchable:!0,isClearable:!1,loadOptionsKey:"results",loadOptionsUrl:"/".concat(c,"/my/company/client/roles/"),loadOptionsParams:function(e){return{extra:{search:e}}}}):null,!E&&q?(0,C.jsx)("div",{className:"mt-4",children:(0,C.jsx)(g.Qp,{name:"businessName",placeholder:"Business name",label:"Business name (Not Editable)",onChange:function(){},value:I,error:!1,helperText:"",disabled:!0})}):null,E&&q?(0,C.jsx)("div",{className:"mt-4",children:(0,C.jsx)(g.Qp,{name:"fullName",placeholder:"Full name",label:"Full name (Not Editable)",onChange:function(){},value:"".concat(k," ").concat(w),error:!1,helperText:"",disabled:!0})}):null,q?(0,C.jsxs)("div",{className:"flex items-end justify-between mb-4",children:[(0,C.jsx)("div",{className:"flex-grow",children:(0,C.jsx)(g.Qp,{name:"phone",placeholder:"Phone",label:"Phone No (Not Editable)",onChange:function(){},value:S,error:!1,helperText:"",disabled:!0,classNames:"!mb-0"})}),(0,C.jsx)(o.Rz,{size:40,letter:(null===I||void 0===I?void 0:I[0])||(null===k||void 0===k?void 0:k[0]),alt:I||k,src:P,className:"ml-4 mb-1"})]}):null,E&&q?(0,C.jsx)("div",{className:"mt-4",children:(0,C.jsx)(g.Qp,{name:"email",placeholder:"Email",label:"Email (Not Editable)",onChange:function(){},value:F,error:!1,helperText:"",disabled:!0})}):null,(0,C.jsx)("div",{className:"mt-8 flex-center-between",children:(0,C.jsx)(j.p,{onSuccess:l,isSubmitting:s,submitText:"Create Linked Client",disableOptions:!q})})]})}function w(e){var n=e.onSuccess,l=e.clientId,t=(0,i.m)().companyId,s=(0,a.eC)().showNotification;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(u.Z.Main,{entity:"linked-clients",name:"AllLinkedClients",url:"/".concat(t,"/my/company/linked_client/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},prependData:!0,fields:[{name:"role",onSubmitValue:function(e){return d()(e,"id")},onSubmitKey:"",required:!0,type:"object"},{name:"from_company",onSubmitKey:""},{name:"to_company",value:Number(l),onSubmitKey:""}],onSuccess:function(e,l){s({message:"Success! Waiting for client accepting.."}),n(),l()},onError:function(e,n){var l,t,a=(null===e||void 0===e||null===(l=e.response)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.message)||"Something went wrong";s({message:a,variant:"error"})},children:function(e){var l=e.isSubmitting,t=(e.values,e.setFieldValue),a=e.resetForm;return(0,C.jsxs)("div",{children:[(0,C.jsx)(r.ph,{resetForm:a,title:"Please search existing client user to link",isEditing:!0}),(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)("div",{className:"flex items-center",children:[(0,C.jsx)(k,{setFieldValue:t,isSubmitting:l,onSuccess:n}),l&&(0,C.jsx)(r.aN,{tiled:!0,withOverlay:!0})]})})]})}})})}function S(e){var n=e.clientId,l=(0,i.m)(),c=l.companyId,u=l.isPermitted,h=(0,a.h0)(),x=h.page,p=h.handlePage,b=h.removePage,j=(0,a.A3)(),g=j.query,y=j.setQuery,f=j.searchQuery,N=(0,a.dF)(),_=N.open,k=N.modalHandler,S=N.WhiteModal,F=(0,m.tY)(),P=F.handleRoleUpdate,E=F.deleteVisible,I=F.showDeleteVisible,U=F.deleteLoading,O=F.closeDeletePopup,A=F.handleLinkedClientDelete;(0,t.useEffect)((function(){return function(){return b()}}),[]);return(0,C.jsxs)("div",{className:"relative mb-8",children:[(0,C.jsx)(o.Bu,{title:"Linked Clients",query:g,isPermitted:u,placeholder:"Search For Linked Clients",handleSearch:function(e){return y(e.target.value)},btnHandler:k,btnText:"New linked client"}),c?(0,C.jsx)(s.Z.All,{entity:"linked-clients",name:"AllLinkedClients",url:"/".concat(c,"/my/company/linked_client/"),params:{page:x,limit:5,extra:{search:f,to_company:n.toString()}},children:function(e){var l=e.items,t=e.isFetched,a=e.meta;return(0,C.jsx)(C.Fragment,{children:t?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(o.xJ,{classes:{root:"relative "},children:(0,C.jsxs)(r.k6,{"aria-label":"simple table",classes:{root:"table-fixed dark-mode-styled-table"},children:[(0,C.jsx)(o.ss,{children:(0,C.jsxs)(r.AF,{children:[(0,C.jsx)(r.EU,{style:{width:"22%"},children:"Full name (or business name)"}),(0,C.jsx)(r.EU,{style:{width:"10%"},children:"Client type"}),(0,C.jsx)(r.EU,{style:{width:"22%"},children:"Email"}),(0,C.jsx)(r.EU,{style:{width:"13%"},children:"Phone number"}),(0,C.jsx)(r.EU,{style:{width:"25%"},children:"Role"}),(0,C.jsx)(r.EU,{style:{width:"8%"},children:"Actions"})]})}),(0,C.jsx)(o.RM,{children:l.map((function(e){var n=e.id,l=d()(e,"from_company_details.first_name"),t=d()(e,"from_company_details.last_name"),a=d()(e,"from_company_details.username"),s=d()(e,"from_company_details.mobile"),i=d()(e,"from_company_details");return(0,C.jsxs)(r.AF,{children:[(0,C.jsx)(r.Yk,{children:l?"".concat(l," ").concat(t):d()(e,"from_company.name","")}),(0,C.jsx)(r.Yk,{children:i?"Individual":"Business"}),(0,C.jsx)(r.Yk,{children:(0,C.jsx)("div",{className:"truncate",children:a||"No email"})}),(0,C.jsx)(r.Yk,{children:s||d()(e,"from_company.phone","")}),(0,C.jsx)(r.Yk,{children:(0,C.jsx)(r.qb,{name:"route",customStylesProps:v.gb,placeholder:"Choose role here",optionLabel:"name",optionValue:"id",loadOptionsUrl:"/".concat(c,"/my/company/client/roles/"),loadOptionsParams:function(e){return{extra:{search:e}}},value:e.role,loadOptionsKey:"results",isSearchable:!0,isClearable:!0,onChange:function(n){P(n,e)}})}),(0,C.jsx)(r.Yk,{children:(0,C.jsx)("div",{className:"flex-centered",children:(0,C.jsx)(r.cP.DeleteButton,{isDisabled:!u,clickHandler:function(){return I(e)}})})})]},n)}))})]})}),(0,C.jsx)("div",{className:"news__pagination my-4",children:l.length?(0,C.jsx)(o.tl,{count:null===a||void 0===a?void 0:a.last_page,page:x?+x:1,defaultPage:6,siblingCount:1,color:"primary",onChange:p}):null}),(0,C.jsx)(S,{open:_,handleModalOpen:k,children:(0,C.jsx)(w,{onSuccess:k,clientId:n})}),(0,C.jsx)(r.sm,{featureHandler:function(){return A(E)},isOpen:Boolean(E),toggleHandler:O,title:"Are You Sure To Delete Linked Client?",hasLoader:!0,isLoading:U})]}):(0,C.jsx)(r.aN,{tiled:!0,withOverlay:!0})})}}):null]})}var F=l(35911),P=l(80834),E=l(4901),I=l(26672),U=l(51425);function O(e){var n=e.clientCompany,l=e.isIndividual,t=(0,F.$)(l,n.name,n.owner);return(0,C.jsxs)("div",{className:"flex items-center mb-8 flex-wrap",children:[(0,C.jsx)("div",{className:"py-4",children:(0,C.jsx)(o.Rz,{size:108,letter:t[0],alt:t,src:(0,P.n)(l,n.icon,n.owner),className:"!mr-8"})}),(0,C.jsx)(o.ev,{text:n.status,title:"Status",wrapperClassnames:"bg-kgrey-bgmenu",textClassName:"!text-lg font-semibold",children:(0,C.jsx)(E.g3P,{className:"text-kgrey"})}),(0,C.jsx)(o.ev,{text:l?"Individual":"Business",title:"Client Type",wrapperClassnames:"bg-kgrey-bgmenu",textClassName:"!text-lg font-semibold",children:(0,C.jsx)(I.VRY,{className:"text-kgrey"})}),l?null:(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(o.ev,{text:n.users_count,title:"Client Users count:",wrapperClassnames:"bg-kgrey-bgmenu",textClassName:"!text-lg font-semibold",children:(0,C.jsx)(U.$P,{className:"text-kgrey"})})}),(0,C.jsx)(o.ev,{text:t,title:l?"Client Name:":"Business Name:",wrapperClassnames:"bg-kgrey-bgmenu",textClassName:"!text-lg font-semibold",children:(0,C.jsx)(I.I$,{className:"text-kgrey"})})]})}function A(e){var n=e.onSuccess,l=e.clientId,t=(0,i.m)().companyId,s=(0,a.eC)().showNotification;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(u.Z.Main,{entity:"clients",name:"AllClients",url:"/".concat(t,"/my/company/clients/").concat(l,"/member/"),method:"post",primaryKey:"id",sendAsFormData:!1,fields:[{name:"first_name",required:!0,value:"",onSubmitKey:""},{name:"last_name",required:!0,value:"",onSubmitKey:""},{name:"email",onSubmitKey:"",required:!0,type:"email",value:""},{name:"position",onSubmitKey:"",required:!1,value:""},{name:"mobile",onSubmitKey:"",required:!0,value:""},{name:"is_admin",onSubmitKey:"",value:!1}],onSuccess:function(e,l){s({message:"Success! Waiting for client accepting.."}),n(),l()},onError:function(e,n){var l,t;console.log(e);var a=(null===e||void 0===e||null===(l=e.response)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.message)||"Something went wrong";s({message:a,variant:"error"})},children:function(e){var l=e.isSubmitting,t=(e.values,e.setFieldValue),a=e.resetForm;return(0,C.jsxs)("div",{children:[(0,C.jsx)(r.ph,{resetForm:a,title:"Invite Business Client User"}),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.gN,{label:"First Name",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",name:"first_name",component:g.Mg,placeholder:"Type your firstname..",required:!0,autoComplete:"off"}),(0,C.jsx)(b.gN,{label:"Last Name",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",name:"last_name",component:g.Mg,placeholder:"Type your lastname..",required:!0,autoComplete:"off"}),(0,C.jsx)(b.gN,{label:"Email",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",name:"email",component:g.Mg,placeholder:"Type your email..",required:!0,autoComplete:"off"}),(0,C.jsx)(b.gN,{label:"Phone",name:"mobile",component:g.UO,placeholder:"Enter company mobile phone number",enableSearch:!0,required:!0,labelClasses:"!text-xs !ml-6 !text-kgrey-welcome",onChangeHandler:t}),(0,C.jsx)(b.gN,{label:"Position",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",name:"position",component:g.Mg,placeholder:"Type client user position..",autoComplete:"off"}),(0,C.jsxs)("div",{className:"flex items-center justify-end",children:[l&&(0,C.jsx)(r.aN,{tiled:!0,withOverlay:!0}),(0,C.jsx)(j.p,{onSuccess:n,isSubmitting:l,submitText:"Invite Client User"})]})]})]})}})})}function L(e){var n=e.clientId,l=(0,i.m)(),c=l.companyId,d=l.isPermitted,m=(0,a.h0)(),u=m.page,h=m.handlePage,x=m.removePage,p=(0,a.A3)(),b=p.query,j=p.setQuery,v=p.searchQuery,g=(0,a.dF)(),y=g.open,f=g.modalHandler,N=g.WhiteModal;(0,t.useEffect)((function(){return function(){return x()}}),[]);return(0,C.jsxs)("div",{className:"relative mb-8",children:[(0,C.jsx)(o.Bu,{title:"Client Users",query:b,placeholder:"Search For Users",handleSearch:function(e){return j(e.target.value)},btnHandler:f,btnText:"Invite New Client User",isPermitted:d}),(0,C.jsx)(s.Z.All,{entity:"client-users",name:"AllClientUser-".concat(n),url:"/".concat(c,"/my/company/clients/").concat(n,"/employee/"),params:{page:u,limit:5,extra:{search:v}},children:function(e){var l=e.items,t=e.isFetched,a=e.meta;return(0,C.jsx)(C.Fragment,{children:t?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(o.xJ,{classes:{root:"relative "},children:(0,C.jsxs)(r.k6,{"aria-label":"simple table",classes:{root:"table-fixed dark-mode-styled-table"},children:[(0,C.jsx)(o.ss,{children:(0,C.jsxs)(r.AF,{children:[(0,C.jsx)(r.EU,{style:{width:"30%"},children:"Full Name"}),(0,C.jsx)(r.EU,{style:{width:"20%"},children:"Email"}),(0,C.jsx)(r.EU,{style:{width:"20%"},children:"Phone Number"}),(0,C.jsx)(r.EU,{style:{width:"10%"},children:"Role"}),(0,C.jsx)(r.EU,{style:{width:"10%"},children:"Status"})]})}),(0,C.jsx)(o.RM,{children:l.map((function(e){var n=e.first_name,l=e.last_name,t=e.roles,a=e.email,s=e.mobile,i=e.status,o=e.id;return(0,C.jsxs)(r.AF,{children:[(0,C.jsx)(r.Yk,{children:"".concat(n," ").concat(l)}),(0,C.jsx)(r.Yk,{children:a}),(0,C.jsx)(r.Yk,{children:s}),(0,C.jsx)(r.Yk,{children:null===t||void 0===t?void 0:t[0]}),(0,C.jsx)(r.Yk,{children:i})]},o)}))})]})}),(0,C.jsx)("div",{className:"news__pagination my-4",children:l.length?(0,C.jsx)(o.tl,{count:null===a||void 0===a?void 0:a.last_page,page:u?+u:1,defaultPage:6,siblingCount:1,color:"primary",onChange:h}):null}),(0,C.jsx)(N,{open:y,handleModalOpen:f,children:(0,C.jsx)(A,{onSuccess:f,clientId:n})})]}):(0,C.jsx)(r.aN,{tiled:!0,withOverlay:!0})})}})]})}var q=function(){var e=(0,a.tv)().params,n=(0,i.m)().companyId,l=parseInt(null===e||void 0===e?void 0:e.clientId);return n?(0,C.jsxs)("div",{className:"py-8",children:[(0,C.jsx)("h1",{className:"font-semibold text-2xl mb-6 dark:text-white",children:"Client Details"}),(0,C.jsx)(s.Z.One,{id:l,relations:"",entity:"clients",name:"AllClients",url:"/".concat(n,"/client_companies/").concat(l,"/"),params:{},children:function(e){var n=e.item,l=e.isFetched,t=n.is_individual;return(0,C.jsx)(C.Fragment,{children:l?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(O,{clientCompany:n,isIndividual:t}),t?null:(0,C.jsx)(L,{clientId:n.id}),(0,C.jsx)(S,{clientId:n.id})]}):(0,C.jsx)(r.aN,{tiled:!0,withOverlay:!0})})}})]}):null}}}]);