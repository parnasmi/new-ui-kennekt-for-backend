"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[4588],{14588:function(e,t,n){n.r(t),n.d(t,{default:function(){return nn}});var a=n(70885),i=n(47313),s=n(3925),r=n(94024),l=n(77344),o=n(57718),c=n(84365),d=n(17480),u=n(94715),m=n(9044),h=n(69706),p=n.n(h),x=n(57864),g=n(32335),v=n(46417),f="".concat(g.Z.PUBLIC_ASSETS,"img");function _(e){var t=e.onSuccess,n=e.setFieldValue,s=e.isSubmitting,r=e.values,l=e.isEditing,o=void 0!==l&&l,c=(0,i.useState)(null),h=(0,a.Z)(c,2),g=h[0],_=h[1],b=(0,i.useState)(!1),y=(0,a.Z)(b,2),j=y[0],Z=y[1],w=(0,i.useState)(o?r.image:null),N=(0,a.Z)(w,2),C=N[0],k=N[1];return(0,i.useEffect)((function(){C&&n("image",C)}),[C]),(0,v.jsxs)("div",{children:[(0,v.jsx)("h2",{className:"font-bold text-xl mb-4",children:"".concat(o?"Edit":"Create"," Group Chat")}),(0,v.jsx)(u.gN,{label:"Group chat title",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",name:"title",component:d.Mg,placeholder:"Group chat title",required:!0,autoComplete:"off",maxLength:100}),(0,v.jsx)(u.gN,{label:"Group description",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",placeholder:"Type Group Description",name:"description",component:d.Mg,type:"textarea",autoComplete:"off",maxLength:250}),(0,v.jsxs)("div",{className:"flex items-center mb-4",children:[(0,v.jsx)("div",{className:"mr-4",children:(0,v.jsx)(m.bA,{uploadMeta:g,setUploadMeta:_,cancelSending:j,setCancelSending:Z,setFile:k})}),(0,v.jsxs)("div",{className:"user-avatar-box__display relative w-20 h-20 rounded-full overflow-hidden",children:[(0,v.jsx)("img",{src:p()(C,"thumbnail_150")||"".concat(f,"/chat-placeholder.svg"),alt:"",className:"object-cover h-full"}),null!==g&&(0,v.jsxs)("div",{className:"absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 w-10 h-10 z-10",children:[(0,v.jsx)("div",{className:"upload-media-spinner",children:(0,v.jsx)(m.aN,{variant:"determinate",value:g})}),(0,v.jsx)("div",{onClick:function(){Z(!0),_(null)},className:"absolute w-8 h-8 z-20 top-[21px] left-[25px] -translate-y-1/2 -translate-x-1/2 text-3xl text-primary-dark hover:text-primary transition cursor-pointer",children:(0,v.jsx)(x.SV5,{})})]})]})]}),(0,v.jsxs)("div",{className:"btn-row mt-6 flex justify-end",children:[s&&(0,v.jsx)(m.aN,{tiled:!0,withOverlay:!0}),(0,v.jsx)(m.zx,{className:"text-kgrey border-kgrey border mr-5",type:"button",onClickHandler:t,children:"Cancel"}),(0,v.jsx)(m.Ik,{type:"submit",className:"dark:hover:bg-primary-300 ml-4 dark:focus:ring-primary-300 dark:text-white",color:"primary",isDisabled:s||!!g,children:o?"Edit Group Chat":"Create Group Chat"})]})]})}function b(e){var t=e.onSuccess,n=(0,l.m)(),a=n.companyId,i=n.groupSearchQuery,s=(0,o.Kx)().changeUrlParams;return(0,v.jsx)(c.Z.Main,{entity:"ims-chats",name:"AllImsChats-".concat(a,"-").concat(i),url:"/".concat(a,"/ims/groups/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},prependData:!0,fields:[{name:"title",required:!0,value:"",onSubmitKey:""},{name:"description",value:"",onSubmitKey:""},{name:"image",onSubmitKey:"",type:"object"}],onSuccess:function(e,n){s({chat:e.id}),t(),n()},onError:function(e,t){console.log(e)},children:function(e){var n=e.isSubmitting,a=e.values,i=e.setFieldValue;return(0,v.jsx)(_,{onSuccess:t,isSubmitting:n,setFieldValue:i,values:a})}})}var y=n(64659),j=n(60860),Z=n(58821);function w(e){var t,n=e.toggleIsUnreadFilter,c=e.isUnreadFilter,d=(0,i.useState)(""),u=(0,a.Z)(d,2),m=u[0],h=u[1],p=(0,r.Z)(m,500),g=(0,a.Z)(p,1)[0],f=(0,l.m)(),_=f.setGroupSearchQuery,w=f.groupsUnreadCountData,N=(0,o.dF)(),C=N.open,k=N.modalHandler,S=N.WhiteModal;return(0,i.useEffect)((function(){_(g)}),[g]),(0,v.jsxs)("div",{className:"flex mb-4",children:[null!==(t=Object.keys(w))&&void 0!==t&&t.length?(0,v.jsx)("div",{onClick:function(){return n()},className:"relative cursor-pointer mr-3 mt-1.5 bg-kgrey-dark-2 rounded-10 p-2",children:c?(0,v.jsx)(x.n5H,{}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"bg-kred-pink text-white text-center rounded-md absolute -top-1 left-1.5 right-1.5 text-10px",children:Object.keys(w).length}),(0,v.jsx)(Z.nzA,{})]})}):null,(0,v.jsxs)("div",{className:"group-sidebar__search relative pr-2  flex-grow",children:[(0,v.jsx)("input",{type:"search",value:m,className:"group-sidebar__search-input w-full outline-none border-b border-kgrey-border-solid focus:border-primary transition pl-7 placeholder-[rgba(45, 45, 45, 0.3)] py-2 dark:bg-kdark dark:text-white",placeholder:"Search for chats",onChange:function(e){return h(e.target.value)}}),(0,v.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0",children:(0,v.jsx)("div",{className:"text-kgrey",children:(0,v.jsx)(s.lnn,{})})})]}),(0,v.jsx)(y.Z,{color:"primary",size:"small",onClick:k,children:(0,v.jsx)(j.D0w,{className:"text-white text-2xl"})}),(0,v.jsx)(S,{handleModalOpen:k,open:C,children:(0,v.jsx)(b,{onSuccess:k})})]})}var N=n(1413),C=n(42982),k=n(35990),S=n(30168),M=n(83061),I=n(30686),F=n(91907),D=n(70131),P=n(22934),A=n(57129),E=n(26926),R=n(14636),O=n(51425),B=n(32),L=n(92241),H=B.Z.entities.updateEntitiesSuccess;function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=(0,i.useState)(null),r=(0,a.Z)(s,2),c=r[0],d=r[1],u=(0,i.useState)(!1),m=(0,a.Z)(u,2),h=m[0],p=m[1],x=(0,l.m)(),g=x.companyId,v=Boolean(c),f=(0,L.I0)(),_=function(e){d(e.currentTarget)},b=(0,o.bK)({url:"/".concat(g,"/ims/groups/").concat(t,"/pin/"),method:"".concat(e?"delete":"put"),cb:{success:function(e,i){var s=(0,a.Z)(i,1)[0];f(H({entity:"ims-chats",entityId:String(t),data:{pin_time:s?Date.now():null}})),n&&f(H({entity:"ims-chats",entityId:String(t),data:{pin_time:s?Date.now():null}}))},error:function(e){}}}),y=b.fetchData,j=function(e,t){"clickaway"!==t&&p(!1)},Z=function(e){switch(e){case"pin":y(!0);break;case"unpin":y(!1);break;default:return null}},w=function(){d(null)};return{open:v,handleClick:_,anchorEl:c,managerRequested:h,handleNotificationClose:j,handleMenuItemClick:Z,handleCloseMenu:w}}var G,K=n(1568),T="".concat(g.Z.PUBLIC_ASSETS,"img/");function V(e){var t=e.chatId,n=e.image,a=e.title,i=e.last_message_author,s=e.last_message_type,r=e.last_message_text,c=e.last_message_time,d=e.pin_time,u=e.draftMessage,m=e.isMuted,h=void 0!==m&&m,p=e.lastReadMessage,x=void 0===p?null:p,g=(0,l.m)(),v=g.groupsUnreadCountData,f=g.setActiveDraft,_=(0,o.Kx)(),b=_.changeUrlParams,y=_.query,j=U(d,t),Z=j.open,w=j.handleClick,C=j.anchorEl,k=j.handleMenuItemClick,B=j.handleCloseMenu,L=(0,l.m)().setChatUuid,H=y&&Number(y.chat)===t,V=n||"".concat(T,"chat-placeholder.png"),W=null===v||void 0===v?void 0:v[t];return console.log("lastReadMessage",x),(0,K.tZ)("div",{className:(0,M.Z)("chat-item mb-3 transition p-2 rounded-lg cursor-pointer hover:opacity-80 ",{"bg-primary-300 dark:bg-primary-300":H,"dark:bg-white/10":!H}),children:(0,K.BX)("div",{className:"chat-item__inner w-full flex justify-between items-center",children:[(0,K.tZ)("div",{className:"chat-item__img w-14 h-14 rounded-full overflow-hidden flex-shrink-0",children:(0,K.tZ)("img",{src:V,alt:"",className:"object-cover h-full"})}),(0,K.BX)("div",{className:"chat-item__body pl-2 flex-grow flex items-center justify-between",css:(0,I.iv)(G||(G=(0,S.Z)(["\n\t\t\t\t\t\twidth: 275px;\n\t\t\t\t\t"]))),children:[(0,K.BX)("div",{className:"chat-item__content w-9/12 overflow-hidden pr-2",onClick:function(){b((0,N.Z)({chat:t},(0,N.Z)({},x&&W?{unread:x,hasUnreadMessage:!0}:{}))),L((0,F.x0)()),f(u)},children:[(0,K.BX)("div",{className:"chat-item__title font-semibold text-sm truncate dark:text-white flex-center-y",children:[(0,K.tZ)("span",{children:a}),h&&(0,K.tZ)("span",{className:"block w-4 h-4 ml-1 text-kgrey",children:(0,K.tZ)(O.vP,{})})]}),(0,K.tZ)("div",{className:"chat-item__muted",children:i?(0,K.tZ)(D.cm,{last_message_type:s,last_message_text:r||"",last_message_author:i,draftMessage:u}):null})]}),(0,K.BX)("div",{className:"chat-item__info  flex-shrink-0 flex flex-col items-end  w-3/12",children:[(0,K.BX)("div",{className:"chat-item___actions mb-2.5 flex items-center justify-between",children:[(0,K.tZ)("div",{className:"chat-item__date font-bold text-kgrey-chatGrey/30 text-[10px] dark:text-white",children:P.XV.toLastTime(c)}),(0,K.BX)("div",{className:"chat-item__dots",children:[(0,K.tZ)("div",{className:"more-btn w-4 text-right cursor-pointer text-kgrey-menuText hover:text-primary dark:hover:text-primary transition-colors dark:text-white",onClick:w,children:(0,K.tZ)(A.i,{className:"inline"})}),(0,K.tZ)(E.v2,{id:"long-menu",anchorEl:C,keepMounted:!0,open:Z,onClose:B,children:(0,K.tZ)(R.Z,{onClick:function(){B(),k(d?"unpin":"pin")},children:"".concat(d?"Unpin":"Pin"," Chat")})})]})]}),(0,K.BX)("div",{className:"chat-item___pin mt-auto flex items-center justify-end leading-none",children:[d?(0,K.tZ)(O.Dg,{className:"text-kgrey-menuText"}):null,W?(0,K.tZ)("div",{className:(0,M.Z)("w-6 h-6 rounded-full  text-center text-white text-sm font-semibold ml-2 leading-6",{"bg-primary":!h,"bg-kgrey":h}),children:W}):null]})]})]})]})})}function W(e){var t=e.chatId,n=e.image,a=e.pin_time,i=e.last_message_type,s=e.last_message_text,r=e.title,l=e.last_message_author,o=e.last_message_time,c=e.isMuted,d=e.draftMessage,u=e.lastReadMessage;return(0,v.jsx)(V,{chatId:t,title:r,image:n,last_message_author:l,last_message_type:i,last_message_text:s,last_message_time:o,pin_time:a,isMuted:c,draftMessage:d,lastReadMessage:u})}function z(e){return(0,v.jsx)(m.SV,{isCompact:!0,children:(0,v.jsx)(W,(0,N.Z)({},e))})}var Q=n(95762),q=n(11760);function X(e){var t=e.isUnreadFilter,n=(0,i.useState)(1),s=(0,a.Z)(n,2),r=s[0],c=s[1],d=(0,i.useState)(1),u=(0,a.Z)(d,2),h=u[0],p=u[1],x=(0,l.m)(),g=x.companyId,f=x.groupSearchQuery,_=x.groupsUnreadCountData,b=(0,q.a)().userData,y=(0,o.Kx)().query.chat;return(0,i.useEffect)((function(){p(1),c(1)}),[f]),(0,v.jsx)("div",{className:"group-sidebar__chats flex-grow overflow-y-auto pt-2 2",children:g?(0,v.jsx)(Q.Z.All,{entity:"ims-chats",name:"AllImsChats-".concat(g,"-").concat(f),url:"/".concat(g,"/ims/groups/"),params:{extra:{search:f},limit:10,page:f.length?h:r},appendData:!0,isCancellable:!!f.length,cancelField:"groupChat",children:function(e){var n=e.items,a=e.isFetched,s=e.meta;return(0,v.jsxs)(v.Fragment,{children:[n.filter((function(e,n){return t?Object.keys(_).includes(e.id.toString())||e.id.toString()===y:e})).map((function(e){var t;return(0,v.jsx)(i.Fragment,{children:(0,v.jsx)(z,{chatId:e.id,title:e.title,pin_time:e.pin_time,last_message_type:e.last_message_type,last_message_author:e.last_message_author,last_message_text:e.last_message_text,last_message_time:e.last_message_time,image:(null===(t=e.image)||void 0===t?void 0:t.thumbnail_150)||null,isMuted:e.members.find((function(e){return e.user.id===b.id})).is_mute,draftMessage:e.draft_message,lastReadMessage:e.last_read_message},e.id)},e.id)})),(0,v.jsxs)(v.Fragment,{children:[a?null:(0,v.jsx)(v.Fragment,{children:(0,C.Z)(Array(10)).map((function(e,t){return(0,v.jsx)("div",{className:"mb4",children:(0,v.jsx)(Y,{})},t)}))}),!n.length&&a&&(0,v.jsx)("p",{className:"text-kgrey",children:"You have not any group chats"})]}),(0,v.jsx)(v.Fragment,{children:a&&null!==s&&void 0!==s&&s.current_page&&null!==s&&void 0!==s&&s.last_page&&(null===s||void 0===s?void 0:s.current_page)<(null===s||void 0===s?void 0:s.last_page)?(0,v.jsx)(m.$K,{setPage:function(){return f.length?p(h+1):c(r+1)}}):null})]})}}):null})}function $(e){return(0,v.jsx)(m.SV,{children:(0,v.jsx)(X,(0,N.Z)({},e))})}function Y(){return(0,v.jsxs)(k.ZP,{speed:2,width:362,height:72,viewBox:"0 0 362 72",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb",children:[(0,v.jsx)("circle",{cx:"48",cy:"33",r:"24"}),(0,v.jsx)("rect",{x:"79",y:"14",rx:"7",ry:"7",width:"217",height:"18"}),(0,v.jsx)("rect",{x:"80",y:"42",rx:"5",ry:"5",width:"155",height:"11"}),(0,v.jsx)("rect",{x:"351",y:"12",rx:"4",ry:"4",width:"12",height:"32"}),(0,v.jsx)("rect",{x:"313",y:"13",rx:"5",ry:"5",width:"30",height:"11"})]})}var J,ee=n(54546),te=n(26005),ne=n(47636),ae=n(46225),ie=n(3889),se=n(89355),re=n(6993),le=n(13063),oe=n(85508),ce=n.n(oe),de=n(19909);function ue(e){var t=e.chatId,n=(0,ne.Z)(),i=(0,a.Z)(n,2),s=i[0],r=i[1].height,c=(0,re.O9)(),d=c.setIsDelayedMessage,u=c.isDelayedMessage,h=(0,o.JN)().afterMessagesFetchService,p=(0,l.m)(),x=(p.entityPage,p.groupsUnreadCountData),g=p.isDarkMode,v=(0,o.Kx)().query,f=v.unread&&Number(v.unread)||null,_=!(null===x||void 0===x||!x[t]),b=(0,ie.m)(),y=b.entityId,j=b.isSetSearchReply,Z=b.allowToLoad,w=b.setAllowToLoad,C=b.direction,k=b.messagesLimit,F=b.replyLoading,D=b.scrollToMsgId,P=(b.state,b.setScrollPosition),A=b.isInBottom,E=b.isMsgHasBeenIndicated,R=(0,o.QY)({entity:"ims-chats",entityId:y,entityName:"GroupChat-".concat(y,"One")}),O=(0,le.W)(),B=O.cursorTop,L=O.cursorBot,H=O.chatScrollRef,U=O.prevScrollHeight,G=O.handlePageLoading,T=O.localEntityId,V=O.scrollIntoElement,W=O.isLoadedRepliedMessage,z=O.messageVisibleHandler,q=O.setUpdateEntityPage,X=O.searchedMessageId,$=O.paginationDepsRef,Y=O.cursor,ee=O.isLastPageFetched,oe=O.setIsLastPageFetched,ue=O.isFirstPageFetched,me=O.setIsFirstPageFetched,he=O.totalMessagesCount;return(0,K.tZ)(Q.Z.All,{entity:"imsMessages",name:"AllImsMessages-".concat(T),url:"/messages/massive-load/cursor-based/",primaryKey:"custom_uuid",prependData:("next"===C||null===C)&&!j,appendData:"previous"===C&&!j,isUniq:!0,cursorBased:!0,direction:f&&null===C?"1":Y===Number(D)?"0":"next"===C||null===C?"-1":"1",replaceIds:W&&Y===D&&null===C||null===Y&&("next"===C||null===C)||_&&!!f,params:{limit:k,extra:{entity_id:T,cursor:Y}},onInit:function(e){h({data:e,isDelayedMessage:u,setIsDelayedMessage:d,isSetSearchReply:j,setAllowToLoad:w,direction:C,scrollToMsgId:D,isMsgHasBeenIndicated:E,cursorTop:B,cursorBot:L,chatScrollRef:H,prevScrollHeight:U,scrollIntoElement:V,setUpdateEntityPage:q,searchedMessageId:X,paginationDepsRef:$,cursor:Y,setIsLastPageFetched:oe,messagesLimit:k,setIsFirstPageFetched:me,totalMessagesCount:he,isLoadedRepliedMessage:W})},children:function(e){var t,n=e.items,a=e.isFetched,i=n;return(0,K.tZ)("div",{ref:s,id:"chat-body",className:(0,M.Z)("chat__body flex-grow"),children:(0,K.tZ)("div",{className:(0,M.Z)("px-5 h-full w-full",{"pt-11":null===(t=R.item)||void 0===t?void 0:t.pinned_message}),css:(0,I.iv)(J||(J=(0,S.Z)(["\n\t\t\t\t\t\t\t\theight: ",";\n\t\t\t\t\t\t\t"])),ae.G6&&"".concat(r,"px")),children:(0,K.tZ)(te.$B,{renderTrackVertical:function(e){return(0,K.tZ)("div",(0,N.Z)((0,N.Z)({},e),{},{className:"chat_messages_scroll_track"}))},renderThumbVertical:function(e){return(0,K.tZ)("div",(0,N.Z)((0,N.Z)({},e),{},{className:(0,M.Z)("chat_messages_scroll_thumb",{"chat_messages_scroll_thumb-dark":g})}))},renderView:function(e){return(0,K.tZ)("div",(0,N.Z)((0,N.Z)({},e),{},{className:"chat_messages_scroll_view"}))},style:{height:"100%"},autoHide:!0,ref:H,onScrollFrame:function(e){1!==e.top||A||P(!0),1!==e.top&&A&&P(!1)},children:(0,K.BX)(K.HY,{children:[!a&&0===n.length&&!j&&(0,K.tZ)(se.JE,{}),(0,K.tZ)(K.HY,{children:!a&&!j&&n.length>0&&("next"===C||null===C)&&(0,K.tZ)("div",{className:"chat-loader absolute left-1/2 -translate-x-1/2 ",children:(0,K.tZ)(m.aN,{})})}),Z&&a&&!ue&&(0,K.tZ)(m.ez,{setPage:function(e){G(e,"next",y)}}),a&&!F||!j?(0,K.tZ)(K.HY,{children:i.map((function(e,t){var n,a,s,r,l={id:1e8,name:"Error message",text:"Error occured. This message is not valid",type:"ERROR",from_user:{}},o=(0,de.i)({currentMsgAuthorId:e.from_user.id,prevMsgAuthorId:null===(n=i[t-1])||void 0===n?void 0:n.from_user.id,nextMsgAuthorId:null===(a=i[t+1])||void 0===a?void 0:a.from_user.id,prevMsgType:null===(s=i[t-1])||void 0===s?void 0:s.type,nextMsgType:null===(r=i[t+1])||void 0===r?void 0:r.type}),c=o.isSameFromUserWithPrev,d=o.isSameFromUserWithNext,u=e?(null===e||void 0===e?void 0:e.custom_uuid)||e.id:l.id;return(0,K.tZ)(ce(),{onChange:function(t){z(t,e)},children:(0,K.tZ)(se.J,{message:e||l,isSameFromUserWithPrev:c,isSameFromUserWithNext:d},u)},u)}))}):(0,K.tZ)(se.JE,{}),!ee&&(Z||ue&&!Z)&&a&&(0,K.tZ)(m.$K,{setPage:function(e){G(e,"previous",y)}}),("previous"===C||null===C)&&!a&&(0,K.tZ)("div",{className:"chat-loader absolute left-1/2 -translate-x-1/2",children:(0,K.tZ)(m.aN,{})})]})})})})}})}function me(e){var t=(0,i.useMemo)((function(){return e.chatId}),[e.chatId]),n=(0,i.useCallback)((function(){window.location.reload()}),[]);return(0,K.tZ)(m.SV,{resetKeys:t,onResetHandler:n,children:(0,K.tZ)(ue,(0,N.Z)({},e))})}var he=n(32146),pe=n(62345),xe=n(37180).Z.getOne();function ge(e){var t=e.isAllowedSendMsg,n=(0,he.O)(),s=n.setMessage,r=n.reply,c=n.setReply,d=n.editingMessage,u=n.isDelayedMessage,m=n.setIsDelayedMessage,h=n.message,p=(0,ie.m)(),x=p.entityId,g=p.entityType,f=p.isLastPageFetched,_=(0,pe.R)().sendJsonMessage,b=(0,o.bL)({sendJsonMessage:_,entityId:x,entityType:g}).sendChatMessage,y=(0,o.r1)().updateEntities,j=(0,l.m)(),Z=j.setActiveDraft,w=j.activeDraft,C=(0,o.cX)(),k=C.removeLS,S=C.updateEntityDraft,M=C.getLS,I=(0,i.useState)(null),D=(0,a.Z)(I,2),P=D[0],A=D[1],E=M(),R=(0,L.v9)((function(e){return xe(e,{id:x,entity:"case"===g?"cases":"ims-chats",name:"".concat("case"===g?"CaseChat":"GroupChat","-").concat(x,"One")})})),O=function(e){var t,n,a;(null===e||void 0===e||e.preventDefault(),P&&A(null),(w||x in E)&&(S("reset"),Z(null),k(x)),d&&(null===d||void 0===d?void 0:d.id)===(null===R||void 0===R||null===(t=R.item.pinned_message)||void 0===t?void 0:t.id))&&y({entity:"ims-chats",entityId:x,updatingData:{pinned_message:(0,N.Z)((0,N.Z)({},null===R||void 0===R||null===(a=R.item)||void 0===a?void 0:a.pinned_message),{},{text:h})}});b({type:"text",replied_to_id:r?r.id:null,replied_to:null,msgSendingChatId:x,uuid:(0,F.x0)(),edited:!!d,is_draft:!(null===(n=R.item)||void 0===n||!n.draft_message)}),s(""),r&&c(null)};(0,i.useEffect)((function(){!u&&P&&O(P)}),[u]);return(0,v.jsx)(se.lv,{onFormSubmit:function(e){if(!f&&!d)return m(!0),void A(e);O(e)},isAllowedSendMsg:t,isGroup:!0})}function ve(e){return(0,v.jsx)(m.SV,{children:(0,v.jsx)(ge,(0,N.Z)({},e))})}var fe=n(45522),_e=n.n(fe),be=n(60798),ye=n(97241),je=n(88137),Ze=n(15861),we=n(4942),Ne=n(64687),Ce=n.n(Ne),ke=n(73923),Se=n(5958),Me=n(22539),Ie=n(3394);var Fe=n(39169),De=n(52602);function Pe(e){var t=e.text,n=e.Component,a=e.iconProp,i=e.field_name,s=e.handleChange,r=e.property;return(0,v.jsx)("div",{className:"permissions__item mb-4 ",children:(0,v.jsxs)("div",{className:"permission dark:bg-kdark-dark333 rounded-xl bg-white shadow-lg p-3 flex items-center",children:[(0,v.jsx)("div",{className:"icon w-10 h-10 rounded-lg bg-primary flex-centered",children:(0,v.jsx)("div",{className:"text-white",children:(0,v.jsx)(n,(0,N.Z)({},a))})}),(0,v.jsx)("div",{className:"text-sm ml-4",children:t}),(0,v.jsx)("div",{className:"ml-auto",children:(0,v.jsx)(De.B,{handleChange:function(e){return s(e)},disabled:!1,name:i,checked:r[i]})})]})})}function Ae(e){var t=e.handler,n=e.Icon,a=e.text;return(0,v.jsxs)("div",{className:"permissions__leave flex items-center pl-2 font-semibold cursor-pointer transition hover:text-primary",onClick:t,children:[(0,v.jsx)("div",{className:"icon w-10 h-10  flex-centered",children:(0,v.jsx)(n,{})}),(0,v.jsx)("div",{className:"text-sm ml-2",children:a})]})}var Ee=n(32916);function Re(e){var t=e.onSuccess,n=e.title,a=e.description,i=e.image,s=e.id,r=(0,l.m)(),o=r.groupSearchQuery,d=r.companyId;return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(c.Z.Main,{entity:"ims-chats",name:"AllImsChats-".concat(d,"-").concat(o),url:"/".concat(d,"/ims/groups/").concat(s,"/"),id:s,method:"put",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},prependData:!0,fields:[{name:"title",required:!0,value:n,onSubmitKey:""},{name:"description",value:a,onSubmitKey:""},{name:"image",onSubmitKey:"",type:"object",value:i}],onSuccess:function(e,n){t(),n()},onError:function(e,t){console.log(e)},children:function(e){var n=e.isSubmitting,a=e.values,i=e.setFieldValue;return(0,v.jsx)(_,{onSuccess:t,isSubmitting:n,setFieldValue:i,values:a,isEditing:!0})}})})}function Oe(e){var t=e.title,n=e.image,r=e.membersCount,c=e.isMuted,d=e.chatId,u=e.memberId,h=e.isOwner,g=function(e){var t,n,r,c,d=e.chatId,u=e.isMuted,m=e.memberId,h=(0,l.m)(),g=h.companyId,v=h.groupSearchQuery,f=h.isAdmin,_=(0,q.a)().userData,b=(0,o.Kx)(),y=b.removeQueryParams,j=b.query,Z=(0,i.useState)(!1),w=(0,a.Z)(Z,2),k=w[0],S=w[1],M=(0,i.useState)(!1),I=(0,a.Z)(M,2),F=I[0],D=I[1],P=(0,i.useState)(!1),A=(0,a.Z)(P,2),E=A[0],R=A[1],O=(0,i.useState)(!1),B=(0,a.Z)(O,2),L=B[0],H=B[1],U=function(){return R((function(e){return!e}))},G=function(){return H((function(e){return!e}))},K=(0,i.useRef)(null),T=(0,o.r1)().updateEntities,V=null!==j&&void 0!==j&&j.searchedMessageId?null===j||void 0===j?void 0:j.searchedMessageId:d,W=(0,o.QY)({entity:"ims-chats",entityId:d,entityName:"GroupChat-".concat(V,"One")});(0,i.useEffect)((function(){K.current=W.item.property}),[W.item.property]);var z=p()(W,"item.members",[]).find((function(e){return"OWNER"===e.role})),Q=p()(W,"item.members",[]).find((function(e){return e.user.id===_.id})),X=(null===z||void 0===z?void 0:z.user.id)===_.id,$=!0;(X||f||null===Q||void 0===Q||!Q.is_allowed_exit_group)&&($=!1);var Y=!1;(f||X||null!==Q&&void 0!==Q&&Q.is_allowed_delete_group)&&(Y=!0);var J=(0,o.bK)({url:"/".concat(g,"/ims/groups/").concat(d,"/"),dynamicValues:!0,method:"put",cb:{success:function(e,t){},error:function(e,t){var n,a;te(null===(n=t[0])||void 0===n?void 0:n.fieldName,!(null!==(a=t[0])&&void 0!==a&&a.checked))}}}).fetchData,ee=(0,i.useCallback)((function(e,t){var n;T({entity:"ims-chats",entityId:e,updatingData:{members:[].concat((0,C.Z)(null===W||void 0===W||null===(n=W.item)||void 0===n?void 0:n.members.filter((function(e){return e.user.id!==_.id}))),[(0,N.Z)((0,N.Z)({},Q),t)])}})}),[null===W||void 0===W?void 0:W.item]),te=function(e,t){var n=(0,N.Z)({},K.current)||{};T({entity:"ims-chats",entityId:d,updatingData:{property:(0,N.Z)((0,N.Z)({},n),{},(0,we.Z)({},e,t))}})},ne=(0,i.useCallback)(function(){var e=(0,Ze.Z)(Ce().mark((function e(t){var n,a;return Ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.name,a=t.target.checked,te(n,a),e.next=5,J({values:(0,we.Z)({},n,a),fieldName:n,checked:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[W.item.property]),ae=(0,o.bK)({url:"/".concat(g,"/ims/groups/").concat(d,"/"),method:"put",values:{is_mute:!u},cb:{success:function(e,t){},error:function(e,t){null===ee||void 0===ee||ee(d,{is_mute:u})}}}).fetchData,ie=(0,ke.v)({entity:"ims-chats",name:"AllImsChats-".concat(g,"-"),deleteData:!0,id:d,url:"",method:"delete",cb:{success:function(e){},error:function(e){},finally:function(){}}}).handleLocalDelete,se=(0,ke.v)({entity:"ims-chats",name:"AllImsChats-".concat(g,"-").concat(v),method:F?"patch":"delete",url:F?"/".concat(g,"/ims/groups/").concat(d,"/members/").concat(m,"/leave/"):"/".concat(g,"/ims/groups/").concat(d,"/"),deleteData:!0,id:Number(V),cb:{success:function(e){null===S||void 0===S||S(!1),null===D||void 0===D||D(!1),L&&G(),E&&U(),y(),v&&ie()},error:function(e){null===S||void 0===S||S(!1),G()},finally:function(){}}}).handleRequest;return{leaveGroupChat:function(){null===S||void 0===S||S(!0),se()},localDelete:function(){ie(),null===D||void 0===D||D(!1),y()},permissions:[{Component:Se.kK8,handleChange:ne,iconProp:{},text:"Send Messages",field_name:"is_allowed_send_msg",show:f||X},{Component:s.wZc,handleChange:ne,iconProp:{},text:"Add Users",field_name:"is_allowed_add_user",show:f||X},{Component:Me.XH4,handleChange:ne,iconProp:{},text:"Remove users",field_name:"is_allowed_remove_user",show:f||X},{Component:x.bI9,handleChange:ne,iconProp:{},text:"Pin Messages",field_name:"is_allowed_pin_msg",show:f||X},{Component:x.$iz,handleChange:ne,iconProp:{width:11,height:11},text:"Edit Group Info",field_name:"is_allowed_edit_info",show:f||X},{Component:Ie.wzU,handleChange:ne,iconProp:{className:"chat-icon-exit"},text:"Exit From Group",field_name:"is_allowed_exit_group",show:f||X}],handlePropertyChange:ne,currentUserProperty:null!==(t=null===W||void 0===W||null===(n=W.item)||void 0===n?void 0:n.members.find((function(e){return(null===e||void 0===e?void 0:e.id)===m})))&&void 0!==t?t:{},property:null!==(r=null===W||void 0===W||null===(c=W.item)||void 0===c?void 0:c.property)&&void 0!==r?r:{},handlerSwitchMute:function(e){ee(d,{is_mute:!e}),ae(e)},canLeaveChat:$,canDeleteChat:Y,deleteVisible:E,deleteLoading:L,toggleDeleteVisible:U,deleteGroupChat:function(){G(),se()},exitLoading:k,open:F,setExitOpen:D,imsData:null===W||void 0===W?void 0:W.item}}({chatId:d,isMuted:c,memberId:u}),f=g.leaveGroupChat,_=g.permissions,b=g.handlePropertyChange,y=g.property,j=g.handlerSwitchMute,Z=g.canLeaveChat,w=g.canDeleteChat,k=g.deleteVisible,S=g.deleteLoading,M=g.toggleDeleteVisible,I=g.deleteGroupChat,F=g.exitLoading,D=g.open,P=g.setExitOpen,A=g.imsData,E=g.currentUserProperty,R=(0,l.m)().isPermitted,O=(0,o.dF)(),B=O.open,L=O.modalHandler,H=O.WhiteModal;return(0,v.jsx)("div",{className:"w-72 ",children:(0,v.jsxs)("div",{className:"permissions font-poppins",children:[(0,v.jsx)("div",{className:"permissions__top",children:(0,v.jsxs)("div",{className:"permission__header bg-primary rounded-lg shadow-lg p-2 flex  text-white",children:[(0,v.jsx)("div",{className:"permissions__img w-14 h-14 rounded-md mr-2 bg-white flex-centered text-primary-dark flex-shrink-0 overflow-hidden",children:n?(0,v.jsx)("img",{src:n.thumbnail_150,alt:t}):null===t||void 0===t?void 0:t[0].toUpperCase()}),(0,v.jsxs)("div",{className:"permissions__header-text flex-grow ",children:[(0,v.jsxs)("div",{className:"text-base flex-center-between",children:[(0,v.jsx)("span",{children:t}),(R||h||(null===E||void 0===E?void 0:E.is_allowed_edit_info))&&(0,v.jsx)("div",{className:"cursor-pointer transition hover:text-primary-dark",onClick:L,children:(0,v.jsx)(Ee.vPQ,{})}),(0,v.jsx)(H,{handleModalOpen:L,open:B,children:(0,v.jsx)(Re,{onSuccess:L,title:A.title,description:A.description,image:A.image,id:A.id})})]}),(0,v.jsx)("div",{className:"text-sm",children:"".concat(r," members")})]})]})}),(0,v.jsxs)("div",{className:"permissions__content mt-4",children:[_.map((function(e){return(0,v.jsx)(i.Fragment,{children:e.show?(0,v.jsx)(Pe,{text:e.text,Component:e.Component,iconProp:e.iconProp,field_name:e.field_name,handleChange:b,property:y},e.text):null},e.text)})),(0,v.jsx)(Ae,{text:c?"Unmute notifications":"Mute notifications",handler:function(){return j(c)},Icon:c?Fe.rZs:Fe.sF0}),w?(0,v.jsx)(Ae,{text:"Delete Group",handler:M,Icon:Me.$vK}):null,Z?(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(Ae,{text:"Leave group",handler:function(){return P(!0)},Icon:Ie.wzU})}):null,(0,v.jsx)(m.sm,{featureHandler:f,isOpen:Boolean(D),toggleHandler:function(){return P((function(e){return!e}))},title:"Are you sure to exit ".concat(t," group"),hasLoader:!0,isLoading:F}),(0,v.jsx)(m.sm,{featureHandler:I,isOpen:Boolean(k),toggleHandler:M,title:"Are you sure to delete  ".concat(t," group"),hasLoader:!0,isLoading:S})]})]})})}function Be(e){return(0,v.jsx)(m.SV,{isCompact:!0,children:(0,v.jsx)(Oe,(0,N.Z)({},e))})}function Le(){var e=(0,i.useState)(""),t=(0,a.Z)(e,2),n=t[0],s=t[1],o=(0,i.useState)(1),c=(0,a.Z)(o,2),d=c[0],u=c[1],h=(0,r.Z)(n,300),p=(0,a.Z)(h,1)[0],x=(0,re.mx)().entityId,g=(0,l.m)().companyId;return(0,v.jsxs)("div",{className:"group-members",children:[(0,v.jsx)("h2",{className:"font-bold text-xl mb-4",children:"Group chat members"}),(0,v.jsx)("div",{className:"mb-4",children:(0,v.jsx)("input",{type:"text",className:"border rounded-xl w-full inline-block p-2 focus:border-primary outline-none dark:bg-kdark-lighter dark:text-white hover:border-primary",value:n,onChange:function(e){return s(e.target.value)},placeholder:"Search members"})}),(0,v.jsx)("div",{className:"group-members__content h-48",children:(0,v.jsx)(te.$B,{autoHide:!0,style:{height:"100%"},children:(0,v.jsx)(Q.Z.All,{entity:"group-members",name:"GroupMembers-".concat(x),url:"/".concat(g,"/ims/").concat(x,"/members_list/"),params:{extra:{search:p},page:d,limit:10},appendData:!0,children:function(e){var t=e.items,n=e.isFetched,a=e.meta,i=(0,C.Z)(t);return(0,v.jsxs)(v.Fragment,{children:[i.map((function(e){var t,n,a;return(0,v.jsxs)("div",{className:"msg-info__content-user flex items-center mb-3",children:[(0,v.jsx)("div",{className:"avatar flex-shrink-0 mr-3",children:(0,v.jsx)(E.Rz,{size:36,smallSize:36,className:"",letter:"".concat(e.user.first_name[0]).concat(e.user.last_name[0]),alt:"".concat(e.user.first_name," ").concat(e.user.last_name),src:(null===(t=e.user.avatar)||void 0===t?void 0:t.thumbnail_150)||(null===(n=e.user.avatar)||void 0===n?void 0:n.thumbnail)||(null===(a=e.user.avatar)||void 0===a?void 0:a.url)})}),(0,v.jsx)("div",{className:"msg-info__user-content",children:(0,v.jsxs)("div",{className:"msg-info__user-name text-sm mb-1",children:[(0,v.jsx)("span",{children:"".concat(e.user.first_name," ").concat(e.user.last_name)}),"OWNER"===e.role&&(0,v.jsx)("span",{className:"text-kgrey italic",children:" Group owner"})]})})]},e.id)})),n?null:(0,C.Z)(Array(6)).map((function(e,t){return(0,v.jsx)("div",{className:"mb-2",children:(0,v.jsx)(Ue,{})},t)})),n&&null!==a&&void 0!==a&&a.current_page&&null!==a&&void 0!==a&&a.last_page&&(null===a||void 0===a?void 0:a.current_page)<(null===a||void 0===a?void 0:a.last_page)?(0,v.jsx)(m.$K,{setPage:function(){return u((function(e){return e+1}))}}):null]})}})})})]})}function He(){return(0,v.jsx)(m.SV,{children:(0,v.jsx)(Le,{})})}function Ue(){return(0,v.jsxs)(k.ZP,{speed:2,width:369,height:40,viewBox:"0 0 369 40",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb",children:[(0,v.jsx)("circle",{cx:"75",cy:"125",r:"27"}),(0,v.jsx)("circle",{cx:"30",cy:"20",r:"20"}),(0,v.jsx)("rect",{x:"55",y:"10",rx:"4",ry:"4",width:"69",height:"18"}),(0,v.jsx)("rect",{x:"131",y:"10",rx:"4",ry:"4",width:"151",height:"18"})]})}function Ge(){var e=(0,l.m)(),t=e.setGroupSearchOpen,n=e.groupSearchOpen;return{handleSearchBtnClick:function(){console.log("clicked")},toggleSearchSidebar:function(){return t(!n)}}}var Ke=n(45987),Te=n(44133),Ve=n(9018),We=n(62300),ze=n(59321),Qe=n(30342),qe=n(57009),Xe=n(336),$e=n(3187),Ye=n(48195),Je=n(46123),et=n.n(Je),tt=n(68809),nt=n(80279),at=n(13188),it=n(28037),st=n(54070),rt=n(90374),lt=n(69124),ot=n(53838),ct=(0,ye.Z)((function(e){return{root:{display:"flex","& > *":{margin:e.spacing(1)}},purple:{color:e.palette.getContrastText(Ye.Z[500]),backgroundColor:Ye.Z[500]}}})),dt=function(e){var t=e.member,n=e.areAddedMembers,a=e.onClickHandler,i=void 0===a?function(){}:a,s=e.selectedMembers,r=void 0===s?[]:s,l=e.isAddingMember,o=void 0!==l&&l,c=e.isOwner,d=void 0!==c&&c,u=e.isAdminManager,m=e.showChatEditSettingModal,h=void 0===m?function(){}:m,x=e.setOpen,g=e.currentMember,f=ct(),_=o?t.first_name:p()(t,"user.first_name"),b=o?t.last_name:p()(t,"user.last_name"),y=o?p()(t,"avatar.thumbnail_150"):p()(t,"user.avatar.thumbnail_150"),j=_[0].toUpperCase(),Z=b[0].toUpperCase(),w="".concat(_," ").concat(b),C=o?t.id:p()(t,"user.id"),k=o?null:t.role,S=o?null:null===t||void 0===t?void 0:t.is_admin,M=o?null:t.is_staff,I="OWNER"===t.role;return(0,v.jsxs)(tt.Z,{button:!n,onClick:function(){return i(C,t)},className:et()("member-list-item",{"item-active":r.includes(C)}),children:[(0,v.jsx)(nt.Z,{children:(0,v.jsx)($e.Z,{alt:j,src:y,className:f.purple,children:"".concat(j," ").concat(Z)})}),(0,v.jsx)(at.Z,(0,N.Z)({primary:w},n?{secondary:"".concat(I?"GROUP ":"").concat(k," ").concat(n?M&&I?"":M&&!I?"| Staff":"| Client":"")}:{})),r.includes(C)&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(it.Z,{children:(0,v.jsx)(st.Z,{edge:"end","aria-label":"checked",children:(0,v.jsx)(rt.Z,{})})})}),n&&(u||d||g.is_allowed_remove_user)&&(0,v.jsxs)(it.Z,{children:[(u||d)&&(0,v.jsx)(st.Z,{edge:"end","aria-label":"checked",disabled:"OWNER"===k||S,onClick:function(){return h(t)},children:(0,v.jsx)(ot.Z,{})}),(0,v.jsx)(st.Z,{edge:"end","aria-label":"checked",disabled:"OWNER"===k,onClick:function(){return x(t)},children:(0,v.jsx)(lt.Z,{})})]})]})},ut=n(58167),mt=n(47942),ht=n(90431);var pt=function(e){var t=e.className,n=e.handler,a=e.text,i=e.Component,s=e.iconProp,r=e.hasSwitch,l=e.field_name,o=e.handleChange,c=e.property,d=e.isMuteSetting,u=e.isMute;return(0,v.jsxs)("div",{className:"chat-sett-toggler flex items-center ".concat(t),onClick:function(){return d?o({target:{checked:!u}}):n(!0)},children:[(0,v.jsx)("div",{className:"chat-sett-toggler__icon flex items-center justify-center text-white",children:(0,v.jsx)(i,(0,N.Z)({},s))}),(0,v.jsx)("div",{className:"chat-sett-toggler__name",children:a}),r&&!d&&(0,v.jsx)("div",{className:"chat-sett-toggler__switch",children:(0,v.jsx)(ht.Z,{color:"primary",edge:"end",name:l,checked:c[l],onChange:o,inputProps:{"aria-labelledby":"switch-list-label-group-admin"}})})]})},xt=B.Z.entity.formRequest,gt=function(e){var t=e.companyId,n=e.member,s=e.chatId,r=e.isOwner,l=e.staffMembersLength,c=e.isAdminManager,d=n&&n,u=d.is_allowed_send_msg,m=d.is_allowed_add_user,h=d.is_allowed_remove_user,p=d.is_allowed_pin_msg,x=d.is_allowed_edit_info,g=d.is_allowed_delete_group,f=d.is_allowed_exit_group,_=d.is_mute,b=(0,i.useState)({is_allowed_send_msg:u,is_allowed_add_user:m,is_allowed_remove_user:h,is_allowed_pin_msg:p,is_allowed_edit_info:x,is_allowed_delete_group:g,is_allowed_exit_group:f,is_mute:_}),y=(0,a.Z)(b,2),j=y[0],Z=y[1],w=n.id,C=(0,o.Zp)().reloadEntityAll,k=(0,L.I0)(),S=function(e){var a=e.target.name,i=e.target.checked,r=(0,N.Z)({},j);Z((function(e){return(0,N.Z)((0,N.Z)({},e),{},(0,we.Z)({},a,i))}));var o=(0,we.Z)({},a,i);k(xt({id:null===n||void 0===n?void 0:n.id,entity:"chatmembers",name:"Allchatmembers-".concat(s,"-").concat(l),url:"/".concat(t,"/ims/groups/").concat(s,"/members/").concat(w,"/"),method:"patch",params:{},updateData:!0,values:o,normalizeData:function(e){return e},cb:{success:function(e){C({url:"/".concat(t,"/ims/").concat(s,"/members_list/"),entity:"userCompanies",name:"Allchatmembers-".concat(s,"-").concat(l),params:{page:1,limit:10}})},error:function(e){Z(r)},finally:function(){}}}))},M=[{Component:O.fu,handleChange:S,iconProp:{},text:"Send Messages",field_name:"is_allowed_send_msg",className:"",handler:function(){},hasSwitch:!0,show:c||r},{Component:O.N_,handleChange:S,iconProp:{},text:"Add Users",field_name:"is_allowed_add_user",className:"",handler:function(){},hasSwitch:!0,show:c||r},{Component:O.HF,handleChange:S,iconProp:{},text:"Remove users",field_name:"is_allowed_remove_user",className:"",handler:function(){},hasSwitch:!0,show:c||r},{Component:O.Dg,handleChange:S,iconProp:{},text:"Pin Messages",field_name:"is_allowed_pin_msg",className:"",handler:function(){},hasSwitch:!0,show:c||r},{Component:O.yl,handleChange:S,iconProp:{width:11,height:11},text:"Edit Group Info",field_name:"is_allowed_edit_info",className:"",handler:function(){},hasSwitch:!0,show:c||r},{Component:O.WC,handleChange:S,iconProp:{className:"chat-icon-exit"},text:"Exit From Group",field_name:"is_allowed_exit_group",className:"white-icon",handler:function(){},hasSwitch:!0,show:c||r}];return(0,v.jsx)("div",{className:"chat-settings__inner",children:(0,v.jsxs)("div",{className:"chat-settings__content",children:[(0,v.jsx)("div",{className:"chat-settings__title mb-4 font-bold",children:"Individual Permissions"}),(0,v.jsx)("div",{className:"chat-settings__l",children:M.map((function(e){var t=e.className,n=e.handler,a=e.text,i=e.hasSwitch,s=e.field_name,r=e.Component,l=e.iconProp,o=e.show,c=e.handleChange;return o&&(0,v.jsx)("div",{className:"chat-settings__i",children:(0,v.jsx)(pt,{className:t,handler:n,text:a,Component:r,iconProp:l,hasSwitch:i,field_name:s,handleChange:c,property:j,isMuteSetting:!1,isMute:!1})},s)}))})]})})},vt=n(93905),ft=B.Z.entity.formRequest,_t=function(e){var t=(0,i.useState)(1),n=(0,a.Z)(t,2),s=n[0],c=n[1],d=(0,i.useState)(""),u=(0,a.Z)(d,2),h=u[0],p=u[1],x=(0,r.Z)(h,300),g=(0,a.Z)(x,1)[0],f=(0,i.useState)(!1),_=(0,a.Z)(f,2),b=_[0],y=_[1],j=(0,i.useState)(!1),Z=(0,a.Z)(j,2),w=Z[0],N=Z[1],C=(0,i.useState)(!1),k=(0,a.Z)(C,2),S=k[0],M=k[1],I=(0,l.m)().companyId,F=(0,re.mx)().entityId,D=(0,L.I0)(),P=(0,o.eC)().showNotification,A=e.isAdminManager,R=e.isOwner,O=e.currentMember,B=e.staffMembersLength,H=function(){return y(!1)};return(0,v.jsx)("div",{className:"members-list",children:(0,v.jsx)(Q.Z.All,{entity:"chatmembers",name:"Allchatmembers-".concat(F,"-").concat(B),url:"/".concat(I,"/ims/").concat(F,"/members_list/"),appendData:!0,params:{page:s,limit:20,extra:{search:g}},onInit:function(e){},children:function(e){var t=e.items,n=e.isFetched,a=e.meta;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"members-list__search p-4",children:(0,v.jsx)(mt.Z,{label:"Search members",value:h,onChange:function(e){return p(e.target.value)},variant:"outlined",size:"small",fullWidth:!0})}),(0,v.jsx)(te.$B,{className:"rct-scroll",autoHide:!0,style:{height:"300px"},children:(0,v.jsx)("div",{className:"members-list__list",children:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ut.Z,{dense:!0,children:t.map((function(e){return(0,v.jsx)(dt,{member:e,isAdminManager:A,isOwner:R,showChatEditSettingModal:N,setOpen:y,currentMember:O,areAddedMembers:!0},e.id)}))}),n&&(null===a||void 0===a?void 0:a.current_page)&&(null===a||void 0===a?void 0:a.last_page)&&(null===a||void 0===a?void 0:a.current_page)<(null===a||void 0===a?void 0:a.last_page)&&(0,v.jsx)(m.$K,{setPage:function(){return c((function(e){return e+1}))}}),n?null:(0,v.jsx)("div",{className:"case-chat-loader flex items-center justify-center",children:(0,v.jsx)(m.aN,{})}),(0,v.jsx)(m.sm,{featureHandler:function(){return e=b,M(!0),void D(ft({entity:"chatmembers",name:"Allchatmembers-".concat(F,"-").concat(B),method:"delete",url:"/".concat(I,"/ims/groups/").concat(F,"/members/").concat(e.id,"/"),deleteData:!0,id:e.id,cb:{success:function(){D((0,vt.Gx)({id:F,entity:"ims-chats",name:"GroupChat-".concat(F),url:"/".concat(I,"/ims/groups/").concat(F,"/"),params:{},primaryKey:"id",relations:""})),P({message:"Successfully deleted",variant:"success"})},error:function(e){P({message:"Something went wrong",variant:"error"})},finally:function(){y(!1),M(!1)}},params:{},primaryKey:"id",values:{}}));var e},isOpen:Boolean(b),toggleHandler:H,title:"Are you sure to remove the member from group chat?",hasLoader:!0,isLoading:S}),(0,v.jsx)(E.Cx,{handleModalOpen:function(){return N(!1)},open:w,maxWidth:310,minWidth:310,children:(0,v.jsx)(gt,{companyId:I,chatId:F,isAdminManager:A,isOwner:R,member:w,staffMembersLength:B})})]})})})]})}})})};function bt(e){return(0,v.jsx)(m.SV,{children:(0,v.jsx)(_t,(0,N.Z)({},e))})}var yt=n(85888),jt=n(78797),Zt=n(78326),wt=n(56446),Nt=n(6085),Ct=n(71807),kt=function(e){var t=e.value,n=e.handleChange;return(0,v.jsx)("div",{className:"members-list__filter",children:(0,v.jsxs)(Nt.Z,{component:"fieldset",children:[(0,v.jsx)(Ct.Z,{component:"legend",children:"Filter:"}),(0,v.jsx)(Zt.Z,{"aria-label":"gender",name:"filter",value:t,onChange:n,children:(0,v.jsxs)("div",{className:"members-list__filter_inner",children:[(0,v.jsx)("div",{className:"members-list__filter_item",children:(0,v.jsx)(wt.Z,{value:"all",control:(0,v.jsx)(jt.Z,{color:"primary"}),label:"All"})}),(0,v.jsx)("div",{className:"members-list__filter_item",children:(0,v.jsx)(wt.Z,{value:"staff",control:(0,v.jsx)(jt.Z,{color:"primary"}),label:"Staff"})}),(0,v.jsx)("div",{className:"members-list__filter_item",children:(0,v.jsx)(wt.Z,{value:"individual",control:(0,v.jsx)(jt.Z,{color:"primary"}),label:"Individual Clients"})}),(0,v.jsx)("div",{className:"members-list__filter_item",children:(0,v.jsx)(wt.Z,{value:"clients",control:(0,v.jsx)(jt.Z,{color:"primary"}),label:"Business Client Users"})})]})})]})})},St=n(41407),Mt=function(e){var t=(0,i.useState)(1),n=(0,a.Z)(t,2),s=n[0],c=n[1],d=e.onSuccess,u=e.activeChat,h=e.staffMembersLength,p=(0,l.m)().companyId,x=(0,re.mx)().entityId,g=(0,i.useState)([]),f=(0,a.Z)(g,2),_=f[0],b=f[1],j=(0,i.useState)([]),Z=(0,a.Z)(j,2),w=Z[0],N=Z[1],k=(0,i.useState)(!1),S=(0,a.Z)(k,2),M=S[0],I=S[1],F=(0,i.useState)("all"),D=(0,a.Z)(F,2),P=D[0],A=D[1],R=(0,i.useState)({is_individual:"true",is_business:"true",is_member:"true"}),O=(0,a.Z)(R,2),B=O[0],H=O[1],U=(0,L.I0)(),G=(0,i.useState)("All"),K=(0,a.Z)(G,2),T=K[0],V=K[1],W=(0,o.eC)().showNotification,z=(0,ke.v)({entity:"chatmembers",name:"Allchatmembers-".concat(x,"-").concat(h),method:"post",url:"/".concat(p,"/ims/groups/").concat(x,"/members/"),values:w.reduce((function(e,t){return[].concat((0,C.Z)(e),[{user:{id:t.id},role:"MEMBER",company:{id:t.companyId}}])}),[]),cb:{success:function(e){U((0,vt.Gx)({id:x,entity:"ims-chats",name:"GroupChat-".concat(x),url:"/".concat(p,"/ims/groups/").concat(x,"/"),params:{},primaryKey:"id",relations:""})),W({message:"Members successfully added",variant:"success"})},error:function(e){W({message:"Something went wrong",variant:"error"})},finally:function(){I(!1),d()}}}).handleRequest;(0,i.useEffect)((function(){!function(){switch(P){case"all":V("All");break;case"individual":V("Individual Clients");break;case"clients":V("Business Client Users");break;case"staff":V("Staff");break;default:;}}()}),[P]);var q=B.is_individual,X=B.is_business,$=B.is_member,Y=(0,i.useState)(""),J=(0,a.Z)(Y,2),ee=J[0],ne=J[1],ae=(0,i.useState)(!1),ie=(0,a.Z)(ae,2),se=ie[0],le=ie[1],oe=(0,r.Z)(ee,300),ce=(0,a.Z)(oe,1)[0];(0,i.useEffect)((function(){c(1)}),[ce]);var de=function(e,t){if(_.includes(e)){var n=_.filter((function(t){return t!==e})),a=w.filter((function(t){return t.id!==e}));b(n),N(a)}else b((function(t){return[].concat((0,C.Z)(t),[e])})),N((function(e){return[].concat((0,C.Z)(e),[{id:t.id,companyId:t.company_id}])}))};return(0,v.jsxs)("div",{className:"members-list relative",children:[(0,v.jsx)(Q.Z.All,{entity:"clientMembers",name:"AllClientMembers-".concat(x,"-").concat(h),url:"/".concat(p,"/my/company/client_users/"),appendData:!0,params:{page:s,limit:20,extra:{search:ce,is_individual:q,is_business:X,is_member:$,exclude_ids:u.members.filter((function(e){return"KICKED"!==e.role.toUpperCase()})).reduce((function(e,t){return[].concat((0,C.Z)(e),[null===t||void 0===t?void 0:t.user.id])}),[]).join(",")}},onInit:function(e){I(!1)},children:function(e){var t=e.items,n=e.isFetched,a=e.meta;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"members-list__settings",children:[(0,v.jsx)("div",{className:"members-list__search",children:(0,v.jsx)(mt.Z,{label:"Search members",value:ee,onChange:function(e){c(1),ne(e.target.value)},variant:"outlined",size:"small",fullWidth:!0})}),(0,v.jsx)("div",{className:"members-list__filter-btn pl-2.5",children:(0,v.jsx)(st.Z,{"aria-label":"filter",color:"default",onClick:function(){return le(!0)},children:(0,v.jsx)(St.Z,{})})})]}),(0,v.jsxs)("div",{className:"flex items-center ml-2.5",children:[(0,v.jsx)("div",{className:"mr-2.5",children:(0,v.jsx)("strong",{children:"Filtering type:"})}),(0,v.jsx)("div",{className:"mr-2.5",children:T})]}),(0,v.jsx)(te.$B,{className:"rct-scroll",autoHide:!0,style:{height:"300px"},children:(0,v.jsxs)("div",{className:"members-list__list",children:[M&&(0,v.jsx)(m.aN,{tiled:!0}),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ut.Z,{dense:!0,children:t.map((function(e){return(0,v.jsx)(dt,{member:e,onClickHandler:de,selectedMembers:_,isAddingMember:!0},e.id)}))}),n&&(null===a||void 0===a?void 0:a.current_page)&&(null===a||void 0===a?void 0:a.last_page)&&(null===a||void 0===a?void 0:a.current_page)<(null===a||void 0===a?void 0:a.last_page)&&(0,v.jsx)(m.$K,{setPage:function(){return c((function(e){return e+1}))}}),n?null:(0,v.jsx)("div",{className:"case-chat-loader flex items-center justify-center",children:(0,v.jsx)(m.aN,{})})]})]})})]})}}),(0,v.jsx)(E.Cx,{handleModalOpen:function(){return le(!1)},open:se,children:(0,v.jsx)(kt,{value:P,handleChange:function(e){var t=e.target.value;switch(A(t),I(!0),c(1),le(!1),t){case"all":H({is_individual:"true",is_business:"true",is_member:"true"});break;case"individual":H({is_individual:"true",is_business:"false",is_member:"false"});break;case"clients":H({is_individual:"false",is_business:"true",is_member:"false"});break;case"staff":H({is_individual:"false",is_business:"false",is_member:"true"});break;default:return null}}})}),(0,v.jsx)("div",{className:"absolute bottom-2.5 right-2.5",children:(0,v.jsx)(y.Z,{color:"primary","aria-label":"add",onClick:function(){I(!0),z()},disabled:0===_.length,children:(0,v.jsx)(yt.Z,{})})})]})};function It(e){return(0,v.jsx)(m.SV,{children:(0,v.jsx)(Mt,(0,N.Z)({},e))})}var Ft=["children","value","index"];function Dt(e){var t=e.children,n=e.value,a=e.index,i=(0,Ke.Z)(e,Ft);return(0,v.jsx)("div",(0,N.Z)((0,N.Z)({role:"tabpanel",hidden:n!==a,id:"scrollable-force-tabpanel-".concat(a),"aria-labelledby":"scrollable-force-tab-".concat(a)},i),{},{children:n===a&&(0,v.jsx)(Xe.Z,{p:0,children:(0,v.jsx)(qe.Z,{component:"div",children:t})})}))}function Pt(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}var At=function(e){var t=e.onSuccess,n=(0,l.m)(),s=n.isPermitted,r=n.companyId,c=(0,re.mx)().entityId,d=(0,q.a)().userData,u=i.useState(0),m=(0,a.Z)(u,2),h=m[0],x=m[1],g=(0,o.QY)({entity:"ims-chats",entityId:c,entityName:"GroupChat-".concat(c,"One")}),f=g.item||{},_=p()(g,"item.members",[]).find((function(e){return"OWNER"===e.role})),b=p()(g,"item.members",[]).find((function(e){return e.user.id===d.id})),y=(null===_||void 0===_?void 0:_.user.id)===d.id,j=(null===b||void 0===b?void 0:b.is_allowed_add_user)||s;return(0,v.jsxs)("div",{className:"case-form case-form_group-chat -mt-5 rounded-xl",children:[(0,v.jsx)(Te.Z,{position:"static",color:"default",children:(0,v.jsxs)(Ve.Z,{value:h,onChange:function(e,t){x(t)},variant:"fullWidth",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable2 force tabs example",children:[(0,v.jsx)(We.Z,(0,N.Z)({label:"Members",icon:(0,v.jsx)(ze.Z,{})},Pt(0))),(0,v.jsx)(We.Z,(0,N.Z)((0,N.Z)({label:"Add Members",icon:(0,v.jsx)(Qe.Z,{})},Pt(1)),{},{disabled:!j}))]})}),(0,v.jsx)(Dt,{value:h,index:0,children:(0,v.jsx)(bt,{isAdminManager:s,isOwner:y,currentMember:b,staffMembersLength:123})}),(0,v.jsx)(Dt,{value:h,index:1,children:(0,v.jsx)(It,{chatId:c,companyId:r,onSuccess:t,activeChat:f,staffMembersLength:123})})]})},Et=(0,ye.Z)((0,je.Z)({paper:{borderRadius:"16px",padding:"10px"}}));function Rt(e){var t,n,a,s,r,c,d,u,m=e.imsData,h=e.isFetched,p=(0,ie.m)(),g=p.setScrollToMessageHandler,f=p.lastReadMessageId,_=(0,q.a)().userData,b=Et(),y=(0,o.Kx)().removeQueryParams,j=(0,re.RT)().closeSocket,Z=(0,l.m)(),w=Z.setActiveDraft,N=Z.activeDraft,C=Z.setGroupSearchOpen,k=Z.groupSearchOpen,S=Z.isAdmin,M=(0,o.cX)().saveDraft,I=Ge().toggleSearchSidebar,F=m.pin_time,D=(0,o.dF)(),P=D.open,A=D.modalHandler,R=D.WhiteModal,B=(0,o.r1)().updateEntities,L=(0,o.dF)(),H=L.open,G=L.modalHandler,K=L.WhiteModal,T=U(m.pin_time,m.id,!0),V=T.open,W=T.handleClick,z=T.anchorEl,Q=T.handleCloseMenu,X=m.title,$=null;h&&!_e()(m)&&($={avatarSrc:null===m||void 0===m||null===(d=m.image)||void 0===d?void 0:d.thumbnail_150,avatarLetter:null===m||void 0===m||null===(u=m.title)||void 0===u?void 0:u[0],avatarAlt:null===m||void 0===m?void 0:m.title});var Y=null===m||void 0===m||null===(t=m.members)||void 0===t?void 0:t.find((function(e){var t;return(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id)===_.id})),J=null===m||void 0===m||null===(n=m.members)||void 0===n?void 0:n.find((function(e){return"OWNER"===e.role})),ee=(null===J||void 0===J||null===(a=J.user)||void 0===a?void 0:a.id)===_.id;return(0,i.useEffect)((function(){"draft_message"in m&&null!==m&&void 0!==m&&m.draft_message&&!N&&w(m.draft_message)}),[m]),(0,v.jsx)(be.F,{isFetched:!0,HeaderActions:(0,v.jsxs)(v.Fragment,{children:[F?(0,v.jsx)("div",{className:"mr-4",children:(0,v.jsx)(O.Dg,{className:"text-kgrey-menuText"})}):null,S||ee||null!==Y&&void 0!==Y&&Y.is_allowed_add_user?(0,v.jsx)("button",{className:"w-8 h-8 rounded-full bg-primary text-white flex-centered hover:bg-primary-dark transition active:shadow-inner active:translate-y-0.5 mr-2",onClick:G,children:(0,v.jsx)(x.Zev,{})}):(0,v.jsx)("button",{className:"w-8 h-8 rounded-full bg-primary text-white flex-centered hover:bg-primary-dark transition active:shadow-inner active:translate-y-0.5",onClick:A,children:(0,v.jsx)(Ee.WY8,{})}),(0,v.jsx)(K,{handleModalOpen:G,open:H,noPadding:!0,cropRounded:!0,children:(0,v.jsx)(At,{onSuccess:G})}),(0,v.jsx)(R,{handleModalOpen:A,open:P,children:(0,v.jsx)(He,{})}),(0,v.jsx)("button",{className:"w-8 h-8 rounded-full bg-primary text-white flex-centered hover:bg-primary-dark transition active:shadow-inner active:translate-y-0.5 ml-2",onClick:I,children:(0,v.jsx)(x.RB5,{})}),(0,v.jsx)("div",{className:"more-btn w-4 text-right cursor-pointer text-kdark-dark333 hover:text-primary dark:hover:text-primary transition dark:text-white",onClick:W,children:(0,v.jsx)(x.fXH,{className:"inline text-3xl"})}),(0,v.jsx)(E.v2,{id:"long-menu",anchorEl:z,keepMounted:!0,open:V,classes:{paper:b.paper},onClose:Q,children:h?(0,v.jsx)(Be,{image:null===m||void 0===m?void 0:m.image,title:null===m||void 0===m?void 0:m.title,membersCount:null===m||void 0===m||null===(s=m.members)||void 0===s?void 0:s.length,isMuted:null===Y||void 0===Y?void 0:Y.is_mute,chatId:m.id,memberId:null===Y||void 0===Y?void 0:Y.id,isOwner:ee}):null}),(0,v.jsx)("button",{className:"lg:ml-4 flex-center-y text-kred-pink transition hover:opacity-80 px-4 py-2 border-l border-border-solid",type:"button",onClick:function(){k&&C(!1),y(),null===j||void 0===j||j(),N&&M();try{B({entity:"ims-chats",entityId:null===m||void 0===m?void 0:m.id,updatingData:{last_read_message:f}})}catch(e){}},children:(0,v.jsx)("div",{className:"icon ",children:(0,v.jsx)(Ie.bjh,{})})})]}),mainText:X,data:$,pinnedMessage:{title:null===m||void 0===m||null===(r=m.pinned_message)||void 0===r?void 0:r.text,id:null===m||void 0===m||null===(c=m.pinned_message)||void 0===c?void 0:c.id},scrollToHandler:g})}function Ot(e){return(0,v.jsx)(m.SV,{children:(0,v.jsx)(Rt,(0,N.Z)({},e))})}function Bt(){var e=(0,o.Kx)().query,t=(0,l.m)(),n=t.companyId,a=(t.setActiveDraft,Number("chat"in e?e.chat:void 0)),i=(0,q.a)().userData;return(0,v.jsx)(v.Fragment,{children:a&&n?(0,v.jsx)(Q.Z.One,{id:String(a),relations:"",entity:"ims-chats",name:"GroupChat-".concat(a),url:"/".concat(n,"/ims/groups/").concat(a,"/"),params:{},children:function(e){var t,n=e.item,s=e.isFetched,r=(0,N.Z)({},n),l=null===r||void 0===r||null===(t=r.members)||void 0===t?void 0:t.find((function(e){var t;return(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id)===i.id}));return(0,v.jsx)(re.Rv,{entityId:a,entityType:"ims",children:(0,v.jsx)(re.GR,{children:(0,v.jsx)(re.eo,{entityId:a,entityType:"ims",children:(0,v.jsx)(ee.g,{ChatHeader:(0,v.jsx)(Ot,{isFetched:s,imsData:r}),ChatBody:(0,v.jsx)(me,{chatId:a}),ChatInput:(0,v.jsx)(ve,{isAllowedSendMsg:null===l||void 0===l?void 0:l.is_allowed_send_msg})})})})})}}):(0,v.jsx)("div",{className:"h-full w-full flex-centered font-semibold text-xl dark:text-white",children:"Please select group chat"})})}function Lt(){return(0,v.jsx)(m.SV,{children:(0,v.jsx)(Bt,{})})}var Ht=n(35890);var Ut=n(90182),Gt=n(4058),Kt=n(66842),Tt=n(25566),Vt=n.n(Tt);function Wt(e){var t=e.searchQuery,n=e.messageText;if(t){var a=t.split(/\s/).filter((function(e){return e})),i=""+(0,D.H$)(n,t,25);return(0,v.jsx)("span",{children:(0,v.jsx)(Vt(),{highlightClassName:"highlighted",searchWords:a,textToHighlight:i})})}return(0,v.jsx)("span",{children:n})}var zt=function(e){var t,n,a,i,s=e.message,r=e.listItemClickHandler,l=e.searchQuery,o="".concat(null===(t=s.from_user)||void 0===t?void 0:t.first_name," ").concat(null===(n=s.from_user)||void 0===n?void 0:n.last_name),c=null===s||void 0===s||null===(a=s.from_user)||void 0===a||null===(i=a.avatar)||void 0===i?void 0:i.thumbnail_150;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(tt.Z,{onClick:function(){return r(s.message_id)},className:"cursor-pointer hover:bg-kprimary-200 transition",children:[(0,v.jsx)(nt.Z,{children:(0,v.jsx)($e.Z,{alt:o,src:c})}),(0,v.jsx)(at.Z,{className:"dark:text-white",primary:o,secondary:(0,v.jsx)(Wt,{messageText:(null===s||void 0===s?void 0:s.text)||"",searchQuery:l})})]}),(0,v.jsx)(Kt.Z,{variant:"inset",component:"li"})]})};function Qt(){var e=(0,i.useState)(1),t=(0,a.Z)(e,2),n=t[0],s=t[1],r=(0,l.m)(),c=r.groupSearchOpen,d=r.companyId,u=r.setGroupMessageSearchQuery,h=r.setIsLastPageLoadedTriggered,p=(0,o.A3)(),g=p.query,f=p.setQuery,_=p.searchQuery,b=Ge().toggleSearchSidebar,y=(0,o.Kx)().query,j=(0,o.Kx)().changeUrlParams,Z=(0,i.useRef)(null),w=(0,i.useCallback)((function(e){_.length>0&&(j({chat:Number(y.chat),searchedMessageId:e}),h(!0))}),[_,y]);(0,i.useEffect)((function(){c&&Z.current&&setTimeout((function(){(null===Z||void 0===Z?void 0:Z.current).focus()}),300)}),[c]),(0,i.useEffect)((function(){u(_)}),[_]);var N=null===y||void 0===y?void 0:y.chat;return(0,v.jsxs)("div",{className:"h-full flex flex-col p-1 border-l pr-2 dark:bg-kdark-dark333",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center",children:[(0,v.jsx)(st.Z,{"aria-label":"close",onClick:function(){j({chat:Number(y.chat)},!0),b()},className:"!mr-1",children:(0,v.jsx)(Gt.Z,{})}),(0,v.jsxs)("div",{className:"search-input flex-grow relative",children:[(0,v.jsx)("input",{type:"search",className:"group-search-input dark:bg-kdark-lighter dark:text-white border rounded w-full p-2 pr-4 focus:outline-none focus:ring focus:ring-primary transition",value:g,onChange:function(e){s(1),f(e.target.value)},ref:Z,placeholder:"Type message keywords"}),(0,v.jsx)("div",{className:"absolute right-3 top-3 hover:text-kprimary cursor-pointer",children:g.length?null:(0,v.jsx)(x.RB5,{})})]})]}),(0,v.jsx)("div",{className:"content flex-grow",children:(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(te.$B,{className:"rct-scroll",autoHide:!0,style:{height:"calc(100vh - 104px)"},onScroll:function(){},children:(0,v.jsx)(ut.Z,{className:"p-0 mb-0",children:_.length&&d?(0,v.jsx)(Q.Z.All,{entity:"search-messages",name:"".concat(d,"-AllSearchMessages-").concat(N),url:"/".concat(d,"/ims/message_search/"),appendData:!0,params:{page:n,limit:20,extra:{search:_,group_chat_id:N}},primaryKey:"message_id",children:function(e){var t=e.isFetched,n=e.items,a=e.meta;return!n.length&&_&&t?(0,v.jsx)("p",{className:"p-4 font-bold !text-xl dark:text-white",children:"No messages found"}):(0,v.jsxs)(v.Fragment,{children:[n.map((function(e){return(0,v.jsx)(zt,{searchQuery:_,listItemClickHandler:w,message:e},e.message_id)})),!t&&(0,v.jsx)("div",{style:{textAlign:"center"},children:(0,v.jsx)(m.aN,{})}),t&&null!==a&&void 0!==a&&a.current_page&&null!==a&&void 0!==a&&a.last_page&&(null===a||void 0===a?void 0:a.current_page)<(null===a||void 0===a?void 0:a.last_page)?(0,v.jsx)(m.$K,{setPage:function(){return s((function(e){return e+1}))}}):null]})}}):(0,v.jsx)("p",{className:"!p-4 dark:text-white",children:"Please search for messages"})})})})})]})}var qt=285,Xt=28,$t=362,Yt=8,Jt=285,en=77;function tn(){!function(){var e=(0,l.m)(),t=e.setPageType,n=e.companyId,a=(0,Ht.Y)().fetchGroupsUnreadMessagesCount;(0,i.useEffect)((function(){n&&a()}),[n]),(0,i.useEffect)((function(){return t(!0),function(){t(!1)}}),[t])}();var e=(0,o.gQ)("Group chats"),t=e.unreadCasesQuantity,n=e.isHidden,s=(0,o.Kx)().query,r=(0,l.m)(),c=r.groupSearchOpen,d=r.groupsUnreadCountData,u=(0,o.iP)().width,m=(0,i.useState)(!1),h=(0,a.Z)(m,2),p=h[0],x=h[1],g=(0,i.useCallback)((function(){x((function(e){return!e}))}),[]);(0,i.useEffect)((function(){var e;!p||null!==(e=Object.keys(d))&&void 0!==e&&e.length||x(!1)}),[d]);var v=u-qt-Xt-$t-Yt-Jt;return(0,K.tZ)("div",{className:"w-full h-full pl-2 lg:pl-7  lg:pt-7 pb-1 flex flex-col",children:(0,K.BX)("div",{className:"flex h-full relative",children:[(!n||0===t)&&(0,K.tZ)(Ut.q,{children:(0,K.tZ)("title",{children:"KENNEKT | Group chats"})}),(0,K.tZ)("div",{className:(0,M.Z)("w-full transition-all lg:mr-2 flex-shrink-0",{hidden:s.chat&&ae.tq,"lg:w-[362px]":!c,"lg:w-[285px]":c}),children:(0,K.BX)("div",{className:"group-sidebar flex flex-col h-full font-poppins pt-4 lg:pt-0",children:[(0,K.tZ)(w,{isUnreadFilter:p,toggleIsUnreadFilter:g}),(0,K.tZ)($,{isUnreadFilter:p})]})}),(0,K.tZ)("div",{className:(0,M.Z)(!c&&"flex-grow","transition-all"),style:{width:c?"".concat(v+en,"px"):"auto"},children:(0,K.tZ)(Lt,{})}),(0,K.BX)("div",{className:(0,M.Z)("transition message-search bg-white w-[285px] top-0 bottom-o right-0 absolute",{"translate-x-[285px]":!c,"translate-x-0":c}),children:[(0,K.tZ)(Qt,{}),(0,K.tZ)("span",{className:" focus:ring-2 focus:ring-primary hidden"})]})]})})}function nn(){return(0,K.tZ)(m.SV,{children:(0,K.tZ)(tn,{})})}},52602:function(e,t,n){n.d(t,{B:function(){return h.B}});var a=n(1413),i=(n(47313),n(93015)),s=n(97241),r=n(88137),l=n(46417),o=(0,s.Z)((function(e){return(0,r.Z)({root:{border:"1px solid #B8BCCF",fontSize:"15px",lineHeight:1,borderRadius:"12px",padding:"10px 30px",fontWeight:300,width:"100%"},input:{padding:0}})}));function c(e){var t=o();return(0,l.jsx)(i.Z,(0,a.Z)({classes:{root:t.root,input:t.input}},e))}var d=n(21144),u=n(18550),m=(0,s.Z)((function(e){return(0,r.Z)({root:{border:"1px solid #B8BCCF",fontSize:"15px",lineHeight:1,borderRadius:"12px",padding:"10px 40px 10px 20px",fontWeight:300,width:"100%"},input:{padding:0},gridContainer:{position:"relative"},iconRoot:{position:"absolute",top:"50%",transform:"translateY(-50%)",fontSize:"22px",width:"22px",height:"22px",right:"15px"},svgRoot:{position:"absolute"}})}));var h=n(52654);h.B}}]);