"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[8313],{68313:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var r=n(47313),a=n(32335),s=n(1413),l=n(45987),i=n(83061),c=n(46417),o=["children","isActive","isFixed","className"],d=function(e){var t=e.children,n=e.isActive,r=void 0!==n&&n,a=e.isFixed,d=void 0!==a&&a,m=e.className,u=(0,l.Z)(e,o);return(0,c.jsx)("div",(0,s.Z)((0,s.Z)({className:(0,i.Z)("border rounded-lg cursor-pointer transition hover:border-primary flex-centered flex-col",{"border-kgrey-dark-2":!r,"border-primary-dark bg-primary-dark-50":r,"px-4 pt-5 pb-4":!d,"w-[105px] h-[105px]":d},m)},u),{},{children:t}))},m=n(26926),u=n(11760);function x(e){var t,n,r,a,s,l=e.invoiceId,i=(0,u.a)().company;return(0,c.jsxs)("div",{className:"checkout__header border-b pb-2.5",children:[(0,c.jsx)("h2",{className:"text-lg text-kdark-lighter mb-4 font-semibold dark:text-white",children:"Order summary ".concat(l?"for unpaid invoice "+l+" (Upgradable)":"")}),(0,c.jsx)("div",{className:"text-xs text-kgrey-menuText mb-4",children:"Upgrade Business:"}),(0,c.jsxs)("div",{className:"flex-center-y",children:[(0,c.jsx)(m.Rz,{size:40,letter:"S",alt:"some descr",src:(null===i||void 0===i||null===(t=i.company)||void 0===t||null===(n=t.icon)||void 0===n?void 0:n.thumbnail_150)||(null===i||void 0===i||null===(r=i.company)||void 0===r||null===(a=r.icon)||void 0===a?void 0:a.url)}),(0,c.jsx)("div",{className:"ml-2 text-xs text-kdark-text dark:text-white",children:null===i||void 0===i||null===(s=i.company)||void 0===s?void 0:s.name})]})]})}var p=[{id:1,title:"Billed Yearly",price:2,type:"year"},{id:2,title:"Billed Monthly",price:4,type:"month"}],h=[{id:1,text:"Credit Card",type:"card"},{id:2,text:"Paypal",type:"paypal"}];function f(e){var t=e.planClickHandler,n=e.plan,r=e.price,a=e.yearlyDiscount;return(0,c.jsx)("div",{className:"checkout__plans flex mb-5",children:p.map((function(e){var s="year"===e.type;return(0,c.jsx)(d,{onClick:function(){return t(e.type)},className:(0,i.Z)("mr-3 last:mr-0",{relative:s}),isActive:n===e.type,children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h4",{className:"text-10px text-kdark-text mb-1.5 dark:text-white",children:e.title}),(0,c.jsx)("strong",{className:"block text-primary-dark text-xl mb-1.5",children:"$".concat(r[s?"year":"month"])}),(0,c.jsx)("span",{className:"uppercase text-kgrey-menuText text-8px",children:"PER member PER MONTH"}),s&&(0,c.jsx)(v,{yearlyDiscount:a})]})},e.id)}))})}function v(e){var t=e.yearlyDiscount;return(0,c.jsx)("div",{className:"absolute flex-centered text-10px text-white -top-[7px] -right-[7px] bg-primary-dark w-[30px] h-[30px] rounded-full",children:"-".concat(t,"%")})}var y=n(51425);function b(e){var t=e.methodClickHandler,n=e.method;return(0,c.jsxs)("div",{className:"checkout__pmethods",children:[(0,c.jsx)("h2",{className:"text-lg text-kdark-lighter mb-4 font-semibold dark:text-white",children:"Payment Method"}),(0,c.jsx)("div",{className:"flex-center-y",children:h.map((function(e){return(0,c.jsx)(d,{onClick:function(){return t(e.type)},className:"mr-3 last:mr-0",isActive:n===e.type,isFixed:!0,children:(0,c.jsxs)(c.Fragment,{children:["card"===e.type?(0,c.jsx)(y.bl,{}):(0,c.jsx)(y.KT,{}),(0,c.jsx)("div",{className:"mt-1.5 text-10px font-medium dark:text-white",children:e.text})]})},e.id)}))})]})}n(17480);var k=n(5958);function j(e){var t=e.price,n=e.memberCount,r=e.decrementMemberCount,a=e.incrementMemberCount,s=e.plan,l=e.setCounterHandler,i=e.monthsLeft,o=e.isExtraInvoice;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsxs)("h2",{className:"py-2.5 text-lg font-semibold dark:text-white",children:["month"===s?"Monthly":"Yearly"," Plan"]}),(0,c.jsxs)("div",{className:"mb-6 divide-y divide-y divide-dashed  divide-kgrey-light-grey-6 rounded-lg bg-primary-dark-50  px-2.5",children:[(0,c.jsxs)("div",{className:"py-2.5 flex-center-between text-kgrey-menuText",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("button",{type:"button",onClick:r,className:"mr-1 checkout-counter",children:(0,c.jsx)(k.pwh,{className:"pointer-events-none"})}),(0,c.jsx)("input",{value:n,className:"w-10 border-b bg-transparent text-xs font-semibold text-center",type:"number",onChange:l}),(0,c.jsx)("button",{type:"button",onClick:a,className:"ml-1 checkout-counter",children:(0,c.jsx)(k.poH,{className:"pointer-events-none"})})]}),(0,c.jsxs)("div",{className:"leading-none pointer-events-none",children:[(0,c.jsx)("strong",{className:"text-10px text-kgrey-2d2d2d pointer-events-none dark:text-white",children:"$".concat(t)}),(0,c.jsxs)("span",{className:"text-8px pointer-events-none",children:["/ per member ",(0,c.jsx)("br",{}),"per month"]})]})]}),(0,c.jsx)("div",{className:"py-2.5",children:(0,c.jsxs)("div",{className:"flex-center-between",children:[(0,c.jsx)("span",{className:"text-sm font-medium dark:text-white",children:"Total:"}),(0,c.jsx)("strong",{className:"font-bold text-lg dark:text-white",children:"$".concat(Math.round(t*n*100*("year"===s?o?i:12:1))/100)})]})})]})]})})}var g=n(90325),N="".concat(a.Z.PUBLIC_ASSETS,"img");function _(){return(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-10px text-kgrey-menuText mb-2.5",children:"We accept the following payment methods"}),(0,c.jsx)("div",{className:"flex items-center",children:["logo-visa","logo-mastercard","logo-paypal"].map((function(e){return(0,c.jsx)("img",{className:"mr-2.5 last:mr-0",src:"".concat(N,"/").concat(e,".svg"),alt:""},e)}))})]})}var C=n(15861),w=n(70885),P=n(64687),S=n.n(P),Z=n(85457),I=n(77344),M=n(22934),A=n(93851);var H=n(79513);function T(e){var t=e.details,n=e.onSuccess,a=(0,I.m)().companyId,s=(0,u.a)().company,l=(0,r.useState)(!1),i=(0,w.Z)(l,2),o=i[0],d=i[1],x=(0,Z.eC)().showNotification,p=(0,Z.bK)({url:"/".concat(a,"/payment/create-checkout-session/"),values:t,method:"post",cb:{success:function(e,t){d(!1),"payment_link"in e?(n(),location.href=e.payment_link):x({message:"Something went wrong",variant:"error"})},error:function(e,t){var n,r,a=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message;console.log("error payment",{response:e.response,errorText:a}),x({message:a||"Something went wrong",variant:"error"}),d(!1)}}}).fetchData,h=function(){var e=(0,C.Z)(S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,p();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"font-bold text-lg mb-6",children:"Are you sure to process payment with following details?"}),o&&(0,c.jsx)(H.aN,{tiled:!0,withOverlay:!0}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("dl",{className:"flex-center-y mb-4",children:[(0,c.jsx)("dt",{className:"mr-2 ",children:"Business Company:"}),(0,c.jsx)("dd",{className:"font-medium",children:null===s||void 0===s?void 0:s.company.name})]}),(0,c.jsxs)("dl",{className:"flex-center-y mb-4",children:[(0,c.jsx)("dt",{className:"mr-2 ",children:"Staffs Count:"}),(0,c.jsx)("dd",{className:"font-medium",children:null===t||void 0===t?void 0:t.staffs_count})]}),(0,c.jsxs)("dl",{className:"flex-center-y mb-4",children:[(0,c.jsx)("dt",{className:"mr-2 ",children:"Payment Type:"}),(0,c.jsx)("dd",{className:"font-medium",children:"PAYPAL"===(null===t||void 0===t?void 0:t.payment_type)?"Paypal":"Stripe"})]}),(0,c.jsxs)("dl",{className:"flex-center-y mb-4",children:[(0,c.jsx)("dt",{className:"mr-2 ",children:"Amount:"}),(0,c.jsxs)("dd",{className:"font-medium",children:["$",null===t||void 0===t?void 0:t.amount]})]}),(0,c.jsxs)("dl",{className:"flex-center-y mb-4",children:[(0,c.jsx)("dt",{className:"mr-2 ",children:"Payment frequency:"}),(0,c.jsx)("dd",{className:"font-medium",children:null!==t&&void 0!==t&&t.is_monthly?"Monthly":"Yearly"})]})]}),(0,c.jsx)("p",{className:"mb-6 text-kgrey text-sm italic",children:"You will be forwarded to ".concat("PAYPAL"===(null===t||void 0===t?void 0:t.payment_type)?"Paypal's":"Stripe's"," website to process payment")}),(0,c.jsxs)("div",{className:"flex-center-end",children:[(0,c.jsx)(m.R9,{className:"mr-4",onClick:n,children:"Cancel"}),(0,c.jsx)(m.R9,{color:"primary",onClick:h,children:"Process Payment"})]})]})}var E="".concat(a.Z.PUBLIC_ASSETS,"img");function D(){var e=function(){var e=(0,I.m)(),t=e.companyId,n=e.isAppAvailable,a=(0,u.a)().companies,s=(0,r.useState)("year"),l=(0,w.Z)(s,2),i=l[0],c=l[1],o=(0,r.useState)("card"),d=(0,w.Z)(o,2),m=d[0],x=d[1],p=(0,r.useState)(0),h=(0,w.Z)(p,2),f=h[0],v=h[1],y=(0,r.useState)(0),b=(0,w.Z)(y,2),k=b[0],j=b[1],g=(0,r.useState)(null),N=(0,w.Z)(g,2),_=N[0],P=N[1],H=(0,r.useState)(null),T=(0,w.Z)(H,2),E=T[0],D=T[1],L=(0,r.useState)(null),B=(0,w.Z)(L,2),F=B[0],R=B[1],Y=(0,r.useState)({month:6.5,year:Math.floor(390)/100}),O=(0,w.Z)(Y,2),$=O[0],K=O[1],U=(0,r.useState)(null),q=(0,w.Z)(U,2),z=q[0],J=q[1],Q=(0,r.useState)(null),V=(0,w.Z)(Q,2),W=V[0],G=V[1],X=(0,Z.tv)(),ee=X.params,te=X.history,ne=n&&"PRO"===(null===z||void 0===z?void 0:z.subscription_type);(0,r.useEffect)((function(){if(z){var e=(0,M.$4)(null===z||void 0===z?void 0:z.end_date),t=parseInt(e[0])/30,n=t%1===0?t:Math.ceil(t);G(n<=12?n:12)}}),[z]),(0,r.useEffect)((function(){if(t&&a.length){var e=a.find((function(e){return e.company.id===t})),n=null===e||void 0===e?void 0:e.company.comp_subscription;n&&J(n)}}),[a,t]);var re=parseInt(null===ee||void 0===ee?void 0:ee.invoice),ae=parseInt(null===ee||void 0===ee?void 0:ee.isMonthly),se=parseInt(null===ee||void 0===ee?void 0:ee.staffsCount);(0,r.useEffect)((function(){c(ae?"month":"year")}),[ae]);var le=(0,r.useCallback)((function(){R(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?null:{company_id:t,staffs_count:f,payment_type:"card"===m?"STRIPE":"PAYPAL",amount:(0,M.QV)($[i]*f*("year"===i?ne?W:12:1)),subscription_plan_id:null===E||void 0===E?void 0:E.id,is_monthly:"month"===i,order_id:re||null,is_extra:ne})}),[t,f,m,i,E,$,re,ne]),ie=(0,Z.bK)({url:"/".concat(t,"/companies/staffs_count/")}),ce=ie.fetchData,oe=ie.response,de=ie.loading,me=(0,Z.bK)({url:"/".concat(t,"/payment/plans/")}),ue=me.fetchData,xe=me.response,pe=me.loading;(0,r.useEffect)((function(){t&&(0,C.Z)(S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:return e.next=4,ue();case 4:case"end":return e.stop()}}),e)})))()}),[t]),(0,r.useEffect)((function(){var e;if(null!==xe&&void 0!==xe&&null!==(e=xe.results)&&void 0!==e&&e.length&&oe){var t=oe.staffs_count,n=(0,A.P)(null===xe||void 0===xe?void 0:xe.results),r=(0,M.gJ)(t,n);j(ne?se||1:t),v(ne?se||1:t),P(n),K(r.price),D(r)}}),[xe,oe,ne,se]),(0,r.useEffect)((function(){if(f>0&&null!==_&&void 0!==_&&_.length){var e=(0,M.gJ)(f,_);D(e),K(e.price)}}),[f,_]);var he=(0,r.useCallback)((function(e){return c(e)}),[]),fe=(0,r.useCallback)((function(e){return x(e)}),[]),ve=(0,r.useCallback)((function(){v((function(e){return e>k?e-1:e}))}),[k]),ye=(0,r.useCallback)((function(){return v((function(e){return e+1}))}),[]),be=(0,r.useCallback)((function(e){var t=e.target.value;k&&v(+t>k?+t:k)}),[k]);return{plan:i,method:m,planClickHandler:he,methodClickHandler:fe,price:$,decrementMemberCount:ve,incrementMemberCount:ye,memberCount:f,setCounterHandler:be,staffCountLoading:de,plansLoading:pe,setPaymentDetailHandler:le,openPaymentPopup:F,yearlyDiscount:null===E||void 0===E?void 0:E.yearlyDiscount,invoiceId:re,goBack:function(){return te.goBack()},monthsLeft:W,isExtraInvoice:ne}}(),t=e.plan,n=e.method,a=e.planClickHandler,s=e.methodClickHandler,l=e.price,i=e.memberCount,o=e.decrementMemberCount,d=e.incrementMemberCount,p=e.setCounterHandler,h=e.staffCountLoading,v=e.plansLoading,y=e.setPaymentDetailHandler,k=e.openPaymentPopup,N=e.yearlyDiscount,P=e.invoiceId,D=e.goBack,L=e.monthsLeft,B=e.isExtraInvoice,F=function(){return y(!0)};return(0,c.jsx)(g.d,{children:(0,c.jsxs)("div",{className:"checkout mx-auto lg:w-[700px] lg:py-14 font-poppins",children:[(0,c.jsx)("div",{className:"checkout__business-logo table mx-auto mb-6",children:(0,c.jsx)("img",{src:"".concat(E,"/img-kennekt-logo-checkout.svg"),alt:""})}),(0,c.jsxs)("div",{className:"checkout__main bg-white dark:bg-kdark-dark333 border-t-4 rounded-lg border-primary-dark relative",children:[(h||v)&&(0,c.jsx)(H.aN,{tiled:!0,withOverlay:!0}),(0,c.jsxs)("div",{className:"checkout__body flex",children:[(0,c.jsxs)("div",{className:"checkout__left p:2 lg:p-7 w-[428px] flex-shrink-0",children:[(0,c.jsx)(x,{invoiceId:P}),(0,c.jsxs)("div",{className:"checkout__content py-5",children:[(0,c.jsx)("h3",{className:"text-xs text-kgrey-menuText mb-3",children:"Billing Plan"}),(0,c.jsx)(f,{plan:t,planClickHandler:a,price:l,yearlyDiscount:N||0}),(0,c.jsx)(b,{method:n,methodClickHandler:s}),Boolean(n)&&(0,c.jsx)("div",{className:"checkout__method-details pt-5",children:"card"===n?(0,c.jsx)(_,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{className:"text-10px text-kgrey-menuText mb-3",children:"You will be taken to PayPal to authorize a billing agreement."}),(0,c.jsx)("p",{className:"text-10px text-kgrey-menuText",children:"Please make sure pop-ups aren't blocked."})]})})]})]}),(0,c.jsx)("div",{className:"checkout__right p-4 border-l border-kgrey-light-grey-6 px-3 py-7 w-full",children:!!l&&(0,c.jsx)(j,{price:l[t],memberCount:i,decrementMemberCount:o,incrementMemberCount:d,plan:t,setCounterHandler:p,monthsLeft:L,isExtraInvoice:B})})]}),(0,c.jsxs)("div",{className:"checkout__footer border-t border-kgrey-light-grey-6 py-5 px-5 flex-center-end",children:[(0,c.jsx)(m.R9,{className:"mr-5",shape:"square",type:"button",onClick:D,children:"Back"}),(0,c.jsx)(m.R9,{color:"primary",shape:"square",type:"submit",onClick:function(){return y()},children:"Continue"}),(0,c.jsx)(m.Cx,{handleModalOpen:F,open:!!k,children:(0,c.jsx)(T,{details:k,onSuccess:F})})]})]})]})})}},93851:function(e,t,n){n.d(t,{P:function(){return a}});var r=n(42982);function a(e){var t=function(e){return e>50};return e.sort((function(e,t){return e.staffs_count_from-t.staffs_count_from})).reduce((function(e,n){return[].concat((0,r.Z)(e),[{id:n.id,name:n.title,members:"".concat(n.staffs_count_from).concat(t(n.staffs_count_to)?"":"-").concat(t(n.staffs_count_to)?"<":n.staffs_count_to),memberFrom:n.staffs_count_from,memberTo:n.staffs_count_to,price:{month:parseFloat(n.monthly_price),year:parseFloat(n.yearly_price)},yearlyDiscount:parseInt(n.yearly_discount),type:n.type}])}),[])}}}]);