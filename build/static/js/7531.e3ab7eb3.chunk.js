"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[7531],{79773:function(e,t,n){n.d(t,{Z:function(){return g}});var a=n(15861),s=n(70885),r=n(64687),l=n.n(r),i=n(47313),c=n(77344),o=n(95762),u=n(94435),d=n(51328),m=n(79447),f=n(3925),h=n(54070),x=n(57864),p=n(94024),b=n(46417);function g(e){var t=e.setFieldValue,n=e.setChooseIcon,r=e.closeModal,g=e.setIcon,v=(0,c.m)().companyId,j=(0,i.useState)(!1),y=(0,s.Z)(j,2),k=y[0],N=y[1],S=(0,m.h0)("iconPage"),_=S.page,w=S.handlePage,C=S.removePage,Z=(0,i.useState)(""),E=(0,s.Z)(Z,2),T=E[0],q=E[1],F=(0,p.Z)(T,500),I=(0,s.Z)(F,1)[0];(0,i.useEffect)((function(){return function(){return C()}}),[]);var A=(0,m.bK)({url:"",dynamicUrl:!0,method:"put",cb:{success:function(){var e=(0,a.Z)(l().mark((function e(a,s){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t("icon",a),N(!1),g(a),n(!1);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),error:function(e,t){console.log(e)}}}),V=A.fetchData;return(0,b.jsxs)("div",{className:"w-[500px] px-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h4",{children:"Choose from library"}),(0,b.jsx)(h.Z,{onClick:r,children:(0,b.jsx)(x.oHP,{color:"#979797",size:"18px"})})]}),(0,b.jsxs)("div",{className:"group-sidebar__search relative w-[460px] mb-5 mx-auto",children:[(0,b.jsx)("input",{type:"search",value:T,className:"group-sidebar__search-input w-full outline-none border-b border-kgrey-border-solid focus:border-primary transition pl-7 placeholder-[rgba(45, 45, 45, 0.3)] pt-2 pb-2 dark:bg-kdark",placeholder:"Search",onChange:function(e){return q(e.target.value)}}),(0,b.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-1",children:(0,b.jsx)("div",{className:"text-kgrey",children:(0,b.jsx)(f.lnn,{})})})]}),v&&!k?(0,b.jsx)(o.Z.All,{entity:"iconsDepartment",name:"iconsDepartment-".concat(v),url:"/".concat(v,"/icons/"),params:{limit:12,extra:{search:I},page:_},children:function(e){var t=e.items,n=e.isFetched,a=e.meta,s=t.map((function(e){return e}));return(0,b.jsx)(b.Fragment,{children:n?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-6 flex flex-wrap justify-around",children:s.map((function(e){var t=e.id,n=e.icon,a=e.name;return(0,b.jsxs)("div",{onClick:function(){return function(e){N(!0),V({url:"".concat(v,"/icons/").concat(e,"/documentize/")})}(t)},className:"flex flex-col items-center mx-2 px-2 py-2 rounded-md mb-4 w-24 cursor-pointer hover:shadow-md",children:[(0,b.jsx)("img",{className:"inline-block w-8 h-8 mb-3",src:n}),(0,b.jsx)("p",{className:"text-10px text-kgrey dark:text-white",children:a})]},t)}))}),(0,b.jsx)("div",{className:"news__pagination my-4",children:t.length?(0,b.jsx)(u.tl,{count:null===a||void 0===a?void 0:a.last_page,page:_?+_:1,defaultPage:6,siblingCount:1,color:"primary",onChange:w}):null})]}):(0,b.jsx)("div",{className:"flex justify-center mb-4",children:(0,b.jsx)(d.aN,{})})})}}):(0,b.jsx)("div",{className:"flex justify-center mb-4",children:(0,b.jsx)(d.aN,{})})]})}},8279:function(e,t,n){n.d(t,{Z:function(){return w}});var a=n(70885),s=n(47313),r=n(94715),l=n(17480),i=n(51328),c=n(94435),o=n(68323),u=n(54070),d=n(57864),m=n(38251),f=n(46225),h=n(77344),x=n(69706),p=n.n(x),b=n(32335),g=n(79773),v=n(15103),j=n(52654),y=n(79447),k=n(61818),N=n(46417),S="".concat(b.Z.PUBLIC_ASSETS,"img"),_=[{label:"minutes",value:"MINUTES"},{label:"hours",value:"HOURS"},{label:"days",value:"DAYS"}];function w(e){var t=e.values,n=e.setFieldValue,x=e.setFieldError,b=e.isSubmitting,w=(e.errors,e.closeModal),C=e.resetForm,Z=e.isCreate,E=e.id,T=e.departmentId,q=e.formValuesSetter,F=void 0===q?function(){return null}:q,I=(0,h.m)().companyId,A=(0,y.h9)({assignRequired:!Z&&(null===t||void 0===t?void 0:t.assign_required)}),V=A.checked,M=A.handleChange,D=(0,s.useState)(null!==t&&void 0!==t&&t.link?"link":"caseChat"),P=(0,a.Z)(D,2),U=P[0],K=P[1],Q=(0,s.useState)(!1),R=(0,a.Z)(Q,2),O=R[0],H=R[1],Y=(0,v.tT)(),B=Y.isStaff,z=Y.setIsStaff,G=(0,s.useState)("true"===B?"staff":"client"),J=(0,a.Z)(G,2),W=J[0],L=J[1];(0,s.useEffect)((function(){n("is_staff","staff"===W),z("staff"===W?"true":"false")}),[W]);var $=(0,s.useState)(null),X=(0,a.Z)($,2),ee=X[0],te=X[1],ne=(0,s.useState)(!1),ae=(0,a.Z)(ne,2),se=ae[0],re=ae[1],le=(0,s.useState)(Z?null===t||void 0===t?void 0:t.icon:null),ie=(0,a.Z)(le,2),ce=ie[0],oe=ie[1];(0,s.useEffect)((function(){ce&&n("icon",ce)}),[ce]),(0,s.useEffect)((function(){"link"===U&&x("link","Required")}),[U]),(0,s.useEffect)((function(){E&&n("department",{id:E})}),[]),(0,s.useEffect)((function(){if(Z){var e=["name","link","phone","case_escalation_time","initial_response_time"],n=Object.keys(t).filter((function(n){if((Array.isArray(t[n])?t[n].length:t[n])&&e.includes(n))return t[n]}));F(n)}}),[t]),(0,s.useEffect)((function(){n("assign_required",V.assignRequired)}),[V.assignRequired]);return(0,N.jsxs)("div",{id:"department-form",children:[(0,N.jsxs)("div",{className:"branch-form__header border-b border-kgrey-dark-1/30 px-6 py-4 -mt-5 flex-center-between",children:[(0,N.jsx)("div",{className:"branch-form__heading font-base font-medium",children:"".concat(Z?"Create new":"Update"," department")}),Z?(0,N.jsx)("div",{className:"branch-form__reset text-kgrey text-sm cursor-pointer hover:text-kdark transition",onClick:C,children:"Clear"}):null]}),(0,N.jsxs)("div",{className:" w-100 p-6",children:[(0,N.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Icon"}),(0,N.jsxs)("div",{className:"flex items-center mb-5",children:[(0,N.jsxs)("div",{className:"user-avatar-box__display relative  w-20 h-20 rounded-full overflow-hidden flex-centered dark:bg-kdark",children:[(0,N.jsx)("img",{src:Z?p()(ce,"thumbnail")||"".concat(S,"/chat-placeholder.png"):p()(null===t||void 0===t?void 0:t.icon,"thumbnail")||"".concat(S,"/chat-placeholder.png"),alt:"",className:"object-fit"}),null!==ee&&(0,N.jsxs)("div",{className:"absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 w-10 h-10 z-10",children:[(0,N.jsx)("div",{className:"upload-media-spinner",children:(0,N.jsx)(i.aN,{variant:"determinate",value:ee})}),(0,N.jsx)("div",{onClick:function(){re(!0),te(null)},className:"absolute w-8 h-8 z-20 top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 text-3xl text-primary-dark hover:text-primary transition cursor-pointer",children:(0,N.jsx)(d.SV5,{})})]})]}),(0,N.jsx)("div",{className:"ml-5",children:(0,N.jsx)(i.bA,{uploadMeta:ee,setUploadMeta:te,cancelSending:se,setCancelSending:re,setFile:oe})})]}),(0,N.jsx)("div",{onClick:function(){H(!0)},className:"cursor-pointer inline-block mb-4 rounded-tl-10 rounded-tr-10 rounded-br-10 border-dashed border p-3.5 bg-kgrey-bg dark:bg-primary-300 darl:text-white",children:"Choose from icon library"}),(0,N.jsx)(r.gN,{label:"Title",name:"name",component:l.Mg,placeholder:"Enter title"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Function"}),(0,N.jsxs)(c.Ee,{value:U,onChange:function(e){var t=e.target.value;K(t),"caseChat"===t&&n("link",null)},"aria-label":"Function",className:"!flex-row font-base text-kgrey",children:[(0,N.jsx)(c.D8,{value:"caseChat",control:(0,N.jsx)(c.Y8,{color:"primary"}),label:"Case Chat"}),(0,N.jsx)(c.D8,{value:"link",control:(0,N.jsx)(c.Y8,{color:"primary"}),label:"Hyperlink"})]}),"link"===U?(0,N.jsx)(r.gN,{label:"Hyperlink",name:"link",component:l.Mg,placeholder:"Hyperlink"}):null]}),Z?(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Type"}),(0,N.jsxs)(c.Ee,{value:W,onChange:function(e){L(e.target.value)},"aria-label":"Type",name:"is_staff",className:"!flex-row font-base text-kgrey",children:[(0,N.jsx)(c.D8,{value:"staff",control:(0,N.jsx)(c.Y8,{color:"primary"}),label:"Staff"}),(0,N.jsx)(c.D8,{value:"client",control:(0,N.jsx)(c.Y8,{color:"primary"}),label:"Client"})]})]}):null,(0,N.jsx)(r.gN,{label:"Phone number",name:"phone",component:l.UO,placeholder:"Enter company mobile phone number",enableSearch:!0,onChangeHandler:n}),(0,N.jsxs)("div",{className:"mb-3.5",children:[(0,N.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Initial required response time"}),(0,N.jsxs)("div",{className:"flex items-center mb-3.5",children:[(0,N.jsx)(o.ZP,{title:"By defining this time, the system will alert the admins of this department when managers do not respond to a staff escalation within the timeframe designated for a specific case, when the case is initially created",placement:"top",children:(0,N.jsx)(u.Z,{className:"p-0 mr-20",children:(0,N.jsx)(d.kA6,{})})}),(0,N.jsx)(r.gN,{name:"case_escalation_time",component:l.Mg,type:"number",placeholder:"time",classNames:"!mb-0",labelClasses:"hidden"}),(0,N.jsx)("div",{className:"flex-grow ml-4",children:(0,N.jsx)(r.gN,{className:"flex-1",component:l.mg,styles:m.gb,name:"case_escalation_time_unit",defaultValue:_[0],options:_,isSearchable:!f.tq})})]}),(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(o.ZP,{title:"By defining this time, the system will alert the admins of this department when managers do not respond to a staff escalation within the timeframe designated for a specific case, when the case is initially created",placement:"top",children:(0,N.jsx)(u.Z,{className:"p-0 mr-20",children:(0,N.jsx)(d.kA6,{})})}),(0,N.jsx)(r.gN,{name:"initial_response_time",component:l.Mg,type:"number",placeholder:"time",classNames:"!mb-0",labelClasses:"hidden"}),(0,N.jsx)("div",{className:"flex-grow ml-4",children:(0,N.jsx)(r.gN,{component:l.mg,styles:m.gb,name:"initial_response_time_unit",defaultValue:_[0],options:_,isSearchable:!f.tq,className:"flex-1"})})]})]}),(0,N.jsx)("div",{className:"ml-1",children:(0,N.jsx)(c.D8,{control:(0,N.jsx)(j.k,{checked:V.assignRequired,onChange:M,name:"assignRequired"}),label:"Assign Required (available in edit mode)",className:"mb-4",disabled:Z,classes:{label:"!text-xs font-light text-kgrey-welcome"}})}),V.assignRequired?(0,N.jsxs)("div",{className:"mb-3.5 react-select-dropdown",children:[(0,N.jsx)("div",{className:"text-sm font-light mb-2 text-kgrey-menuText ml-2",children:"Default assignees"}),(0,N.jsx)(r.gN,{component:k.Z,customStylesProps:m.gb,name:"default_assignees",placeholder:"Select default assignees",optionLabel:function(e){return"".concat(p()(e,"user.first_name","")," ").concat(p()(e,"user.last_name",""))},loadOptionsUrl:"/".concat(I,"/departments/").concat(T,"/users/"),loadOptionsParams:function(e){return{extra:{search:e}}},isSearchable:!0,maxMenuHeight:220,defaultValue:null===t||void 0===t?void 0:t.default_assignees,isClearable:!0,isMulti:!0,loadOptionsKey:"results",isCached:!0,onChange:function(e){}})]}):null]}),(0,N.jsxs)("div",{className:"branch-form__footer px-6 pt-4 pb-9 flex justify-end",children:[(0,N.jsx)(i.Ik,{className:"text-kgrey border-kgrey border mr-5",color:"default",onClick:w,children:"Cancel"}),(0,N.jsx)(i.Ik,{className:"dark:hover:bg-primary-300 dark:focus:ring-primary-300 dark:text-white",type:"submit",isSubmitting:b,color:"primary",children:Z?"Create":"Update"})]}),(0,N.jsx)(c.Cx,{handleModalOpen:function(){return H((function(e){return!e}))},open:Boolean(O),scrollable:!0,noPadding:!0,children:(0,N.jsx)(g.Z,{setIcon:oe,setFieldValue:n,setChooseIcon:H,closeModal:function(){return H(!1)}})}),b?(0,N.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-70",children:(0,N.jsx)(i.aN,{})}):null]})}w.defaultProps={isCreate:!0,department:null,resetForm:function(){}}},15103:function(e,t,n){n.d(t,{$i:function(){return o},tT:function(){return u}});var a=n(70885),s=n(1413),r=n(47313),l=n(46417),i=(0,r.createContext)(null),c=function(e,t){switch(t.type){case"SET_SEARCH_QUERY":return(0,s.Z)((0,s.Z)({},e),{},{searchQuery:t.payload});case"SET_IS_STAFF":return(0,s.Z)((0,s.Z)({},e),{},{isStaff:t.payload});default:return e}};function o(e){var t=e.children,n=(0,r.useReducer)(c,{searchQuery:"",isStaff:"true"}),s=(0,a.Z)(n,2),o=s[0],u=s[1],d=(0,r.useCallback)((function(e){u({type:"SET_SEARCH_QUERY",payload:e})}),[]),m=(0,r.useCallback)((function(e){u({type:"SET_IS_STAFF",payload:e})}),[]),f={searchQuery:o.searchQuery,isStaff:o.isStaff,setSearchQuery:d,setIsStaff:m};return(0,l.jsx)(i.Provider,{value:f,children:t})}var u=function(){var e=(0,r.useContext)(i);if(!e)throw new Error("useBusinessContext must be used within the BusinessContextProvider");return e}},17531:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var a=n(1413),s=n(70885),r=n(47313),l=n(51328),i=n(90182),c=n(79447),o=n(3925),u=n(94024),d=n(15103),m=n(46417);function f(){var e=(0,d.tT)(),t=e.searchQuery,n=e.setSearchQuery,a=(0,u.Z)(t,500),r=(0,s.Z)(a,1)[0];return(0,m.jsxs)("div",{className:"group-sidebar__search relative",children:[(0,m.jsx)("input",{type:"search",value:r,className:"group-sidebar__search-input w-full md:w-36 outline-none border-b border-kgrey-border-solid dark:border-white dark:text-white focus:border-primary transition pl-7 placeholder-[rgba(45, 45, 45, 0.3)] pt-2 pb-2 dark:bg-kdark dark:focus:border-primary",placeholder:"Search",onChange:function(e){return n(e.target.value)}}),(0,m.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0",children:(0,m.jsx)("div",{className:"text-kgrey",children:(0,m.jsx)(o.lnn,{})})})]})}var h=n(28303),x=n(63830),p=n(94435),b=n(84365),g=n(77344),v=n(8279);function j(e){var t=e.handleModalOpen,n=e.page,a=e.searchQuery,s=e.isStaff,l=e.hasToShowGuard,i=e.formValuesSetter,o=(0,g.m)().companyId,u=(0,r.useCallback)((function(){return t(null)}),[]),d=(0,c.eC)().showNotification,f=(0,c.Zp)().reloadEntityAll;return(0,m.jsx)("div",{children:o?(0,m.jsx)(b.Z.Main,{entity:"departments",name:"AllDepartments-".concat(o),url:"".concat(o,"/departments/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},appendData:!0,fields:[{name:"icon",required:!1,value:null,onSubmitKey:"",type:"object",onSubmitValue:function(e){return e||null}},{name:"name",required:!0,value:"",onSubmitKey:""},{name:"link",required:!1,value:null,onSubmitKey:"",onSubmitValue:function(e){return e||null}},{name:"phone",required:!1,value:null,onSubmitKey:""},{name:"is_staff",required:!1,value:"staff",onSubmitKey:""},{name:"case_escalation_time",required:!1,value:null,onSubmitKey:"",onSubmitValue:function(e){return e?parseInt(e):null}},{name:"case_escalation_time_unit",required:!1,value:{label:"minutes",value:"MINUTES"},onSubmitKey:"",onSubmitValue:function(e){return e.value},type:"object"},{name:"initial_response_time",required:!1,value:null,onSubmitKey:""},{name:"initial_response_time_unit",required:!1,value:{label:"minutes",value:"MINUTES"},onSubmitKey:"",onSubmitValue:function(e){return e.value},type:"object"}],onSuccess:function(e,t){d({message:"Success! "}),t(),f({entity:"departments",name:"AllDepartments-".concat(o),url:"/".concat(o,"/departments/"),params:{page:n,limit:10,extra:{is_staff:s,search:a}}}),u()},onError:function(e,t){d({message:"Already exist",variant:"error"}),t()},children:function(e){var t=e.isSubmitting,n=e.values,a=e.setFieldValue,s=e.errors,r=e.setFieldError,c=e.resetForm;return(0,m.jsx)(v.Z,{values:n,setFieldValue:a,setFieldError:r,isSubmitting:t,errors:s,resetForm:c,formValuesSetter:i,closeModal:l})}}):null})}l.Dy.defaultProps={onSuccess:function(){}};var y=(0,r.lazy)((function(){return n.e(4760).then(n.bind(n,54760))}));function k(e){return{id:"simple-tabpanel-".concat(e),"aria-controls":"simple-tab-".concat(e)}}function N(e){var t=e.match,n=(0,g.m)(),o=n.isPermitted,u=n.isAdmin,b=r.useState(0),v=(0,s.Z)(b,2),N=v[0],S=v[1],_=t.url,w=t.path,C=(0,c.gQ)("Departments"),Z=C.unreadCasesQuantity,E=C.isHidden,T=(0,d.tT)(),q=T.setIsStaff,F=T.isStaff,I=T.searchQuery,A=(0,x.k6)(),V=(0,r.useState)(!1),M=(0,s.Z)(V,2),D=M[0],P=M[1],U=(0,c.h0)().page,K=(0,c.Tn)(),Q=K.formValues,R=K.guardOpen,O=K.setGuardOpen,H=K.formValuesSetter,Y=function(){return P((function(e){return!e}))},B=(0,r.useCallback)((function(){O((function(e){return!e}))}),[]),z=(0,r.useCallback)((function(){O(!1),H([]),Y()}),[D]),G=(0,r.useCallback)((function(){Q.length?O(!0):Y()}),[Q]);return(0,r.useEffect)((function(){0===N&&A.push("".concat(_,"?is-staff=true"))}),[A]),(0,r.useEffect)((function(){S("true"===F?0:1),A.push("".concat(_,"?is-staff=").concat(F))}),[F]),(0,m.jsxs)("div",{className:"p-4 max-w-full flex flex-col min-h-full flex-grow relative",children:[(!E||0===Z)&&(0,m.jsx)(i.q,{children:(0,m.jsx)("title",{children:"KENNEKT | Departments "})}),(0,m.jsxs)("div",{className:"mb-5",children:[(0,m.jsx)("div",{className:" w-full bg-kred-pink-200 absolute top-0 left-0",children:u?null:(0,m.jsx)("p",{className:"text-kred-pink text-center text-xs my-1",children:"You do not have permission to perform some actions, please check with admin"})}),(0,m.jsxs)("div",{className:"flex items-center justify-between flex-wrap w-full mt-5",children:[(0,m.jsx)("h2",{className:"text-xl md:text-3xl font-bold dark:text-white py-4 mr-5",children:"Departments"}),(0,m.jsxs)("div",{className:"flex items-center w-full md:w-auto",children:[(0,m.jsx)(f,{}),(0,m.jsx)("button",{disabled:!o,className:"bg-kgrey-bg rounded-xl ml-2 sm:ml-5 text-sm md:text-base font-poppins text-center px-4 py-2 hover:bg-primary-200 transition dark:bg-primary-300 dark:text-white disabled:opacity-60",onClick:Y,children:"New department"})]})]})]}),(0,m.jsx)("div",{className:"prime-tabs",children:(0,m.jsxs)(l.sJ.Tabs,{roundedTop:!0,value:N,onChange:function(e,t){switch(t){case 0:q("true");break;case 1:q("false");break;default:return null}S(t)},"aria-label":"simple tabs",children:[(0,m.jsx)(l.sJ.Tab,(0,a.Z)({label:"Staff departments",component:h.rU,to:"".concat(_,"?is-staff=true")},k(0))),(0,m.jsx)(l.sJ.Tab,(0,a.Z)({label:"Client departments",component:h.rU,to:"".concat(_,"?is-staff=false")},k(1)))]})}),(0,m.jsx)("div",{className:"max-w-full flex-grow flex flex-col relative",children:(0,m.jsx)("div",{className:"relative flex-grow",children:(0,m.jsx)(r.Suspense,{fallback:(0,m.jsx)(l.aN,{tiled:!0}),children:(0,m.jsx)(x.rs,{children:(0,m.jsx)(x.AW,{exact:!0,path:w,component:y})})})})}),(0,m.jsx)(p.Cx,{maxWidth:466,minWidth:466,handleModalOpen:function(){Q.length?O(!0):Y()},open:Boolean(D),scrollable:!0,noPadding:!0,children:(0,m.jsx)(j,{page:U,searchQuery:I,isStaff:F,hasToShowGuard:G,formValuesSetter:H,handleModalOpen:Y})}),(0,m.jsx)(l.sm,{featureHandler:z,isOpen:R,toggleHandler:B,title:"You have unsaved changes, Are you sure to cancel?"})]})}var S=function(e){return(0,m.jsx)(l.SV,{children:(0,m.jsx)(d.$i,{children:(0,m.jsx)(N,(0,a.Z)({},e))})})}}}]);