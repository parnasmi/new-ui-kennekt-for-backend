!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l=(new Error).stack;l&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[l]="be1115c6-5212-4637-bde9-ce1cf066cf0e",e._sentryDebugIdIdentifier="sentry-dbid-be1115c6-5212-4637-bde9-ce1cf066cf0e")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"92c588a922034147d52c8df4651841419a0c4114"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[6006],{6006:function(e,l,t){t.r(l),t.d(l,{default:function(){return A}});var n=t(29439),r=t(76188),i=t(17173),a=t(84200),d=t(72791),o=t(70629),s=t(37099),u=t(80266),c=t(40084),m=t(26181),f=t.n(m),p=t(52033),b=t(80184);function h(e){var l,t=e.setFieldValue,n=e.values,m=e.departmentRef,h=(0,c.m)().companyId,v=(0,d.useRef)([]),_=(0,i.$G)().t,x=!1;return(0,b.jsxs)("div",{className:"feedback-field__left flex w-[45%] flex-col justify-items-center gap-y-2.5",children:[(0,b.jsx)("h3",{className:"text-lg dark:text-kgrey",children:_("your_form")}),(0,b.jsx)("div",{className:"feedback-field__wrapper react-select-dropdown ",children:(0,b.jsx)(r.gN,{required:!0,label:_("select_department"),labelClasses:"text-sm text-kgrey font-light",component:s.Z,customStylesProps:u.gb,name:"department",placeholder:_("select_department"),optionLabel:"name",optionValue:"id",isSearchable:!o.tq,isClearable:!0,isCached:!0,isDisabled:x,openMenuOnFocus:!0,loadOptionsKey:"results",loadOptionsUrl:"/".concat(h,"/departments/"),loadOptionsParams:function(e){return{extra:{search:e,is_staff:"true"}}},onChange:function(e){(0,a.W1)({departmentRef:m,option:e,setFieldValue:t})}})}),f()(n,"department")&&f()(n,"department.sub_departments_count")>0&&(0,b.jsx)(b.Fragment,{children:Object.keys(null!==(l=null==n?void 0:n.sub_department)&&void 0!==l?l:{}).map((function(e){return(0,b.jsx)("div",{className:"feedback-field__wrapper",children:(0,b.jsx)(p.P,{label:_("select_sub_department"),labelClasses:"text-sm text-kgrey font-light",subdep:e,companyId:h,values:n,setFieldValue:t,subDepIdsRef:v,isDisabled:x})},e)}))}),(0,b.jsx)("div",{className:"feedback-field__wrapper react-select-dropdown",children:(0,b.jsx)(r.gN,{required:!0,label:_("select_status"),labelClasses:"text-sm text-kgrey font-light",component:s.Z,customStylesProps:u.gb,name:"status",optionLabel:"title",optionValue:"id",isSearchable:!0,isCached:!0,isDisabled:x,placeholder:_("select_status"),reverse:!0,loadOptionsUrl:"/".concat(h,"/my/company/case_statuses/"),loadOptionsParams:function(e){return{extra:{search:e,is_staff:"true"}}},loadOptionsKey:""})}),(0,b.jsx)("div",{className:"feedback-field__wrapper react-select-dropdown",children:(0,b.jsx)(r.gN,{required:!0,label:_("select_priority"),labelClasses:"text-sm text-kgrey font-light",component:s.Z,customStylesProps:u.gb,name:"priority",placeholder:_("select_priority"),optionLabel:"name",optionValue:"code",isSearchable:!0,isCached:!0,isDisabled:x,loadOptionsUrl:"/".concat(h,"/cases/as_business/priorities/"),loadOptionsParams:function(e){return{extra:{search:e}}},loadOptionsKey:"choices"})})]})}var v=t(93433),_=t(1413),x=t(15861),g=t(64687),y=t.n(g),k=t(16178),j=t(16856),F=t(53527),N=t(80301),Z=t(94389);function q(e){var l=e.required,t=void 0!==l&&l,n=e.label,i=e.name,a=e.placeholder,d=e.onEdit,o=e.onDelete,s=e.disabled,u=e.isDeletable,c=void 0!==u&&u,m=e.draggable,f=void 0!==m&&m;return(0,b.jsx)("div",{className:"custom-field__wrapper",children:(0,b.jsxs)("div",{className:"custom-field__item flex items-center gap-x-2.5",children:[f&&(0,b.jsx)(j.iVq,{className:"mt-2 dark:text-kgrey"}),(0,b.jsx)(r.gN,{required:t,component:Z.Mg,classNames:"w-[75%]",name:i,label:n,placeholder:a,disabled:s,inputClassNames:"border-kgrey-light-grey-4"}),(0,b.jsxs)("div",{className:"item__icons flex flex-1 gap-x-1.5 pt-2.5",children:[(0,b.jsx)(N.w,{className:"!bg-kgrey-light-grey-2 dark:!bg-kdark-dark333",clickHandler:d}),c&&"function"==typeof o?(0,b.jsx)(F.m,{className:"!bg-kgrey-light-grey-2 dark:!bg-kdark-dark333",clickHandler:o}):null]})]})})}var C=t(53148),w=t(86053),S=t(81724);function I(e){var l,t,n,a=e.closeFieldsForm,o=e.setCustomFields,s=e.openFieldsForm,u=e.customFields,c=null!=s&&s.customFieldEntity?{placeholder:null==s||null===(l=s.customFieldEntity)||void 0===l?void 0:l.placeholder,name:null==s||null===(t=s.customFieldEntity)||void 0===t?void 0:t.name,required:null==s||null===(n=s.customFieldEntity)||void 0===n?void 0:n.required}:{placeholder:"",name:"",required:!1},m=(0,i.$G)().t,f=(0,k.eC)().showNotification,p=(0,k.h9)({required:c.required}),h=p.checked,x=p.handleChange,g=(0,d.useMemo)((function(){return S.Ry().shape({name:S.Z_().required(m("required"))})}),[m]),y=(0,d.useCallback)((function(e,l){l.validateForm().then((function(l){if(0===Object.keys(l).length){if(u.some((function(l){var t;return("add_field"===(null==s?void 0:s.formType)||(null==l?void 0:l.temp_id)!==(null==s||null===(t=s.customFieldEntity)||void 0===t?void 0:t.temp_id))&&l.name===e.name})))return f({message:m("field_title_exist"),variant:"error"});"add_field"===(null==s?void 0:s.formType)?o((function(l){return[].concat((0,v.Z)(l),[(0,_.Z)({},e)]).map((function(e,l){return e.order?e:(0,_.Z)((0,_.Z)({},e),{},{order:l+1,temp_id:l+1})}))})):o((function(l){return l.map((function(l){var t;return(null==l?void 0:l.temp_id)===(null==s||null===(t=s.customFieldEntity)||void 0===t?void 0:t.temp_id)?(0,_.Z)((0,_.Z)({},l),e):l}))})),a()}}))}),[s]);return(0,b.jsx)(r.J9,{enableReinitialize:!0,validationSchema:g,onSubmit:y,initialValues:c,children:function(e){var l,t=e.handleSubmit,n=e.submitForm,i=e.setFieldValue;return(0,b.jsxs)("form",{onSubmit:t,children:[(0,b.jsx)("h3",{className:"my-3 text-lg",children:m("add_field")}),(0,b.jsx)(r.gN,{component:Z.Mg,name:"name",placeholder:m("enter_field_label"),required:!0,onBlur:function(e){i(e.target.name,e.target.value.trim())}}),(0,b.jsx)(r.gN,{component:Z.Mg,name:"placeholder",placeholder:m("enter_placeholder")}),null!=s&&null!==(l=s.customFieldEntity)&&void 0!==l&&l.default?null:(0,b.jsx)(C.D8,{labelPlacement:"start",className:"!ml-1 !flex justify-between",name:"required",checked:h.required,control:(0,b.jsx)(w.k,{size:"medium",checked:h.required,onChange:function(e){i("required",e.target.checked),x(e)}}),label:m("is_this_required_field")}),(0,b.jsxs)("div",{className:"mt-3 flex justify-end gap-x-2.5",children:[(0,b.jsx)(C.Ik,{onClick:a,children:m("cancel")}),(0,b.jsx)(C.Ik,{color:"primary",onClick:n,children:m("save")})]})]})}})}var E=t(62055),R=t(7692),D=t(13889),V=t(90790);function O(e){var l,t=e.customFields,a=e.setCustomFields,o=e.setFieldValue,s=(0,k.dF)().WhiteModal,u=(0,i.$G)().t,m=(0,c.m)().companyId,f=(0,k.iR)(),p=f.visible,h=f.showVisible,g=f.closePopup,j=(0,d.useCallback)((function(e,l){return function(){h({formType:e,customFieldEntity:l})}}),[h]),F=(0,d.useCallback)((function(){g()}),[]),N=(0,d.useCallback)((function(e){return function(){t.some((function(l){return l.name===e}))&&a((function(l){return l.filter((function(l){return l.name!==e}))}))}}),[t]),C="AllForms-".concat(m),w=(0,d.useCallback)(function(){var e=(0,x.Z)(y().mark((function e(l){var t,r,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.destination,r=l.source,t){e.next=4;break}return e.abrupt("return");case 4:if(t.droppableId!==r.droppableId||t.index!==r.index){e.next=6;break}return e.abrupt("return");case 6:i=function(e,l,t){var r=Array.from(e),i=r.splice(l,1),a=(0,n.Z)(i,1)[0];return r.splice(t,0,a),r.map((function(e,l){return(0,_.Z)((0,_.Z)({},e),{},{order:l+2})}))},a((function(e){return[].concat((0,v.Z)(e.filter((function(e){return e.default}))),(0,v.Z)(i(e.filter((function(e){return!(null!=e&&e.default)})),r.index,t.index)))}));case 8:case"end":return e.stop()}}),e)})));return function(l){return e.apply(this,arguments)}}(),[]),S=null!==(l=t.find((function(e){return 1===e.order&&e.default})))&&void 0!==l?l:t[0];return(0,b.jsxs)("div",{className:"feedback-field__right justify-content-center flex w-1/2 flex-1 flex-col gap-y-2.5",children:[(0,b.jsx)("h3",{className:"text-lg dark:text-kgrey",children:u("add_custom_fields")}),(0,b.jsx)(r.gN,{required:!0,label:u("form_title"),name:"title",classNames:"w-4/5",placeholder:u("form_title_placeholder"),inputElementClassNames:"!bg-white dark:!bg-kdark border-kgrey-light-grey-4 dark:text-white",component:Z.Mg,onBlur:function(e){o(e.target.name,e.target.value.trim())}}),(0,b.jsx)(q,{required:!0,name:null==S?void 0:S.name,label:null==S?void 0:S.name,placeholder:null==S?void 0:S.placeholder,isDeletable:!1,onEdit:j("edit_field",S),disabled:!0}),(0,b.jsx)(V.Z5,{onDragEnd:w,children:(0,b.jsx)(V.bK,{droppableId:C,children:function(e){return(0,b.jsxs)("div",(0,_.Z)((0,_.Z)({className:"relative h-full"},e.droppableProps),{},{ref:e.innerRef,children:[(0,b.jsx)(D.ZP,{style:{height:t.length>2?250:100},children:t.filter((function(e){return!(1===(null==e?void 0:e.order)&&null!=e&&e.default)})).sort((function(e,l){return e.order-l.order})).map((function(e,l){return(0,b.jsx)(V._l,{draggableId:String(null==e?void 0:e.temp_id),index:l,children:function(l){return(0,b.jsx)("div",(0,_.Z)((0,_.Z)((0,_.Z)({},l.draggableProps),l.dragHandleProps),{},{ref:l.innerRef,children:(0,b.jsx)(q,{draggable:!0,name:e.name,label:e.name,placeholder:e.placeholder,isDeletable:!e.default,onDelete:N(e.name),onEdit:j("edit_field",e),disabled:!0},e.name)}))}},null==e?void 0:e.temp_id)}))}),e.placeholder]}))}})}),(0,b.jsx)("div",{className:"mr-5 flex justify-end",children:(0,b.jsx)(E.Ik,{onClick:j("add_field"),iconComponent:(0,b.jsx)(R.poH,{}),color:"default",className:"mt-3",children:u("add_field")})}),(0,b.jsx)(s,{open:Boolean(p),handleModalOpen:F,children:(0,b.jsx)(I,{openFieldsForm:p,setCustomFields:a,closeFieldsForm:g,customFields:t})})]})}var P=t(4942),M=t(64880),K=t(87818),L=t(32380).Z.entity.formRequest;var T=t(90218),U=t(91523);function A(e){var l=e.match,t=(0,i.$G)(),o=(0,n.Z)(t,1)[0],s=((0,T.K)().isRTL,function(e){var l,t=e.match,r=(0,i.$G)(),o=r.t,s=r.i18n,m=(0,d.useMemo)((function(){return S.Ry().shape({department:S.Ry().nullable().required(o("required")),status:S.Ry().nullable().required(o("required")),priority:S.Ry().nullable().required(o("required")),title:S.Z_().required(o("required"))})}),[s.language]),p=(0,d.useState)({department:null,sub_department:null,status:null,priority:null,title:""}),b=(0,n.Z)(p,2),h=b[0],v=b[1],x=(0,d.useState)([{name:"Your name",placeholder:"Enter Name",order:1,required:!0,default:!0,id:1,temp_id:1}]),g=(0,n.Z)(x,2),y=g[0],j=g[1],F=(0,M.k6)(),N=(0,K.I0)(),Z=(0,d.useRef)(null),q=(0,k.Kx)().query,C=(0,c.m)().companyId,w=(0,k.eC)().showNotification,I="edit"===(null==t||null===(l=t.params)||void 0===l?void 0:l.formType),E=(0,k.bK)({url:"",dynamicUrl:!0,initialLoad:!1,cb:{success:function(e){var l,t,n,r,i={name:(0,u.fm)(null!=e&&null!==(l=e.form_meta_info)&&void 0!==l&&l.priority?null==e||null===(t=e.form_meta_info)||void 0===t||null===(n=t.priority)||void 0===n?void 0:n.toLowerCase():""),code:null==e||null===(r=e.form_meta_info)||void 0===r?void 0:r.priority};v((function(l){var t,n,r;return(0,_.Z)((0,_.Z)((0,_.Z)({},l),e.form_meta_info),{},{title:null==e?void 0:e.title,priority:i,sub_department:null!=e&&null!==(t=e.form_meta_info)&&void 0!==t&&t.sub_department?(0,P.Z)({},null===(n=e.form_meta_info)||void 0===n||null===(r=n.sub_department)||void 0===r?void 0:r.id,e.form_meta_info.sub_department):{}})})),j((function(l){return null==e?void 0:e.fields.map((function(e){return l.find((function(l){return 1===e.order&&l.default}))?(0,_.Z)((0,_.Z)({},e),{},{default:!0}):(0,_.Z)((0,_.Z)({},e),{},{temp_id:null==e?void 0:e.id})}))}))},error:function(e){console.log(e,"form error")}}}).fetchData;return(0,d.useEffect)((function(){I&&C&&E({url:"".concat(C,"/feedback_link/").concat(null==q?void 0:q.formId,"/")})}),[C]),{onFormSubmit:(0,d.useCallback)((function(e,l){var t={};l.validateForm().then((function(n){var r,i,d;0===Object.keys(n).length&&(t.form_meta_info={department:null===(r=(0,a.fI)(e))||void 0===r?void 0:r.id,sub_department:null!==(i=null===(d=(0,a.B2)({values:e,departmentRef:Z}))||void 0===d?void 0:d.id)&&void 0!==i?i:null,status:f()(e,"status.id",null),priority:f()(e,"priority.code",null)},t.title=f()(e,"title",""),t.fields=null==y?void 0:y.map((function(e){return(0,_.Z)({name:null==e?void 0:e.name,placeholder:null==e?void 0:e.placeholder,required:null==e?void 0:e.required,order:null==e?void 0:e.order},I?{id:null==e?void 0:e.id}:{})})),I&&(t.form_id=Number(null==q?void 0:q.formId)),N(L({entity:"AllForms",name:"All-feedback-configuration-".concat(C),url:"/".concat(C,"/feedback_link/"),method:I?"patch":"post",params:{},appendData:!I,updateData:I,values:t,cb:{success:function(e){F.push("/business-profile/forms"),w({message:o(I?"successfully_updated":"successfully_created")}),j([{name:"Your name",placeholder:"Enter Name",order:1,required:!0,default:!0,id:1,temp_id:1}])},error:function(e){console.log("error",e)},finally:function(){l.setSubmitting(!1)}}})))}))}),[y]),initialValues:h,setInitialValues:v,customFields:y,setCustomFields:j,configFormSchema:m,departmentRef:Z,isEditForm:I,history:F}}({match:l})),m=s.configFormSchema,p=s.initialValues,v=s.onFormSubmit,x=s.departmentRef,g=s.customFields,y=s.setCustomFields,j=s.isEditForm;return(0,b.jsx)(r.J9,{validationSchema:m,initialValues:p,enableReinitialize:!0,onSubmit:v,children:function(e){var t=e.handleSubmit,n=e.values,r=e.setFieldValue,i=e.submitForm,a=e.isSubmitting;return(0,b.jsxs)("form",{className:"feedback-field mt-3 mb-6 flex flex-col justify-items-center gap-y-2.5",onSubmit:t,children:[(0,b.jsxs)(C.bu,{maxItems:4,"aria-label":"breadcrumb",separator:">",className:"!pb-4",children:[(0,b.jsx)(U.rU,{className:"hover:underline",to:"/business-profile/forms",children:o("feedback_configuration")}),(0,b.jsx)(U.rU,{className:"font-medium text-primary hover:underline",to:null==l?void 0:l.url,children:o(j?"edit_form":"create_form")})]}),(0,b.jsxs)("section",{className:"flex gap-x-4",children:[(0,b.jsx)(h,{departmentRef:x,values:n,setFieldValue:r}),(0,b.jsx)(O,{setFieldValue:r,customFields:g,setCustomFields:y})]}),(0,b.jsx)("div",{className:"flex items-center justify-center",children:(0,b.jsx)(E.Ik,{isDisabled:a,onClick:i,className:"w-2/5",color:"primary",children:a?"...":o(j?"save_changes":"create_form")})})]})}})}}}]);
//# sourceMappingURL=6006.99c88e76.chunk.js.map