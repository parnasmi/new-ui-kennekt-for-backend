!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e2d7c47a-d61a-4173-bd7f-6c37ac666efc",e._sentryDebugIdIdentifier="sentry-dbid-e2d7c47a-d61a-4173-bd7f-6c37ac666efc")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"2d91d0cb0833c8f8db3c1dd482d6954c4680f762"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[4601],{52006:function(e,n,t){t.d(n,{Z:function(){return d}});var a=t(93433),r=(t(72791),t(27945)),l=t(40084),i=t(36261),s=t(40133),o=t(17173),c=t(80184);function u(e,n){switch(e){case"member":return{label:n("member"),value:"member"};case"admin":return{label:n("admin"),value:"admin"};case"manager":return{label:n("manager"),value:"manager"};default:return null}}function d(e){var n=e.entity,t=e.onSuccess,d=(0,o.$G)().t,m=(0,l.m)().companyId,f=(0,i.r1)().updateEntities,p=(0,i.eC)().showNotification;return n?(0,c.jsx)("div",{children:m?(0,c.jsx)(r.Z.Main,{entity:"staffEmployee",name:"staffEmployee-".concat(m),url:"".concat(m,"/employee/").concat(n.id,"/"),method:"patch",id:n.id,primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},updateData:!0,fields:[{name:"avatar",required:!1,value:null==n?void 0:n.avatar,onSubmitKey:"",type:"object",onSubmitValue:function(e){return e||null}},{name:"first_name",required:!0,value:null==n?void 0:n.first_name,onSubmitKey:""},{name:"username",required:!0,value:null==n?void 0:n.username,onSubmitKey:""},{name:"last_name",required:!0,value:null==n?void 0:n.last_name,onSubmitKey:""},{name:"mobile",required:!0,value:null==n?void 0:n.mobile,onSubmitKey:""},{name:"roles",required:!0,value:u(null==n?void 0:n.roles[0],d),type:"object",onSubmitKey:"",onSubmitValue:function(e){return[e.value]}},{name:"departments",onSubmitValue:function(e){return e.reduce((function(e,n){return[].concat((0,a.Z)(e),[{id:n.value}])}),[])},required:!0,type:"array",onSubmitKey:""},{name:"can_send_news",required:!1,value:!0,onSubmitKey:""}],onSuccess:function(e,a){p({message:"Success! "}),f({entity:"staffEmployee",entityId:null==n?void 0:n.id,updatingData:{departments:null==e?void 0:e.departments}}),a(),t()},onError:function(e,n){var t,a,r;p({message:null!==(t=null==e||null===(a=e.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)&&void 0!==t?t:"Something went wrong",variant:"error"}),n()},children:function(e){var a=e.isSubmitting,r=e.values,l=e.setFieldValue,i=e.errors,o=e.setFieldError,u=e.resetForm;return(0,c.jsx)(s.Z,{values:r,setFieldValue:l,setFieldError:o,isSubmitting:a,errors:i,closeModal:t,resetForm:u,departments:null==n?void 0:n.departments,isCreate:!1,isBeingEditedUserOwner:n.is_business_owner})}}):null}):null}d.defaultProps={onSuccess:function(){}}},40133:function(e,n,t){t.d(n,{Z:function(){return C}});var a=t(1413),r=t(93433),l=t(29439),i=t(72791),s=t(76188),o=t(94389),c=t(18381),u=t(80266),d=t(70629),m=t(40084),f=t(12714),p=t(26181),h=t.n(p),v=t(78820),b=t(9478),g=t(35741),y=t(98741),x=t(36261),_=t(97689),w=t(28182),j=t(17173),k=t(80184),S="".concat(b.Z.PUBLIC_ASSETS,"img");function C(e){var n,t,p,b=e.values,C=e.setFieldValue,N=(e.setFieldError,e.isSubmitting),Z=e.errors,D=e.closeModal,E=e.resetForm,A=e.isCreate,P=e.departments,V=e.formValuesSetter,F=void 0===V?function(){}:V,T=e.isBeingEditedUserOwner,M=void 0!==T&&T,K=(0,j.$G)().t,R=(0,m.m)(),I=R.companyId,q=R.isDarkMode,L=(0,_.a)(),U=L.company,B=L.userData,O=(0,x.h9)({canSend:!A&&b.can_send_news}),z=O.checked,H=(O.handleChange,(0,i.useState)(null)),X=(0,l.Z)(H,2),Y=X[0],G=X[1],W=(0,i.useState)(!1),$=(0,l.Z)(W,2),J=$[0],Q=$[1],ee=(0,i.useState)(A?null==b?void 0:b.avatar:null),ne=(0,l.Z)(ee,2),te=ne[0],ae=ne[1],re=B.id===(null==U||null===(n=U.company)||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.id),le=(0,i.useMemo)((function(){return[{label:K("admin"),value:"admin"},{label:K("manager"),value:"manager"},{label:K("member"),value:"member"}].concat((0,r.Z)(re?[{label:K("owner"),value:"owner"}]:[{}]))}),[K,re]),ie=(0,i.useState)({clientDeps:P?P.reduce((function(e,n){return n.is_staff?(0,r.Z)(e):[].concat((0,r.Z)(e),[{value:n.id,label:n.name}])}),[]):[],staffDeps:P?P.reduce((function(e,n){return n.is_staff?[].concat((0,r.Z)(e),[{value:n.id,label:n.name}]):(0,r.Z)(e)}),[]):[]}),se=(0,l.Z)(ie,2),oe=se[0],ce=se[1],ue=[],de=[];(0,i.useEffect)((function(){te&&C("avatar",te)}),[te]);var me=oe.clientDeps,fe=oe.staffDeps;return(0,i.useEffect)((function(){C("departments",[].concat((0,r.Z)(me),(0,r.Z)(fe)))}),[oe]),(0,i.useEffect)((function(){if(A){var e=["first_name","username","last_name","mobile","departments"],n=Object.keys(b).filter((function(n){if((Array.isArray(b[n])?b[n].length:b[n])&&e.includes(n))return b[n]}));F(n)}}),[b]),(0,i.useEffect)((function(){C("can_send_news",z.canSend)}),[z.canSend]),console.log(le[2]),(0,k.jsxs)("div",{id:"department-form",children:[(0,k.jsxs)("div",{className:"branch-form__header flex-center-between -mt-5 border-b border-kgrey-dark-1/30 px-6 py-4",children:[(0,k.jsx)("div",{className:"branch-form__heading font-base font-medium",children:K(A?"create_staff":"edit_staff")}),A?(0,k.jsx)("div",{className:"branch-form__reset cursor-pointer text-sm text-kgrey transition hover:text-kdark",onClick:E,children:K("clear")}):null]}),(0,k.jsxs)("div",{className:" w-100 p-6",children:[(0,k.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:K("profile_photo")}),(0,k.jsxs)("div",{className:"mb-5 flex items-center",children:[(0,k.jsxs)("div",{className:"user-avatar-box__display flex-centered relative  h-20 w-20 overflow-hidden rounded-full dark:bg-kdark-lighter",children:[(0,k.jsx)("img",{src:A?h()(te,"thumbnail_150")||"".concat(S,"/chat-placeholder.png"):h()(null==b?void 0:b.avatar,"thumbnail_150")||"".concat(S,"/chat-placeholder.png"),alt:"",className:"object-fit"}),null!==Y&&(0,k.jsxs)("div",{className:"absolute top-1/2 left-1/2 z-10 h-10 w-10 -translate-y-1/2 -translate-x-1/2",children:[(0,k.jsx)("div",{className:"upload-media-spinner",children:(0,k.jsx)(c.aN,{variant:"determinate",value:Y})}),(0,k.jsx)("div",{onClick:function(){Q(!0),G(null)},className:"absolute top-1/2 left-1/2 z-20 h-8 w-8 -translate-y-1/2 -translate-x-1/2 cursor-pointer text-3xl text-primary-dark transition hover:text-primary",children:(0,k.jsx)(v.SV5,{})})]})]}),(0,k.jsx)("div",{className:"ml-5",children:(0,k.jsx)(c.bA,{uploadMeta:Y,setUploadMeta:G,cancelSending:J,setCancelSending:Q,setFile:ae})})]}),(0,k.jsx)(s.gN,{label:K("first_name"),name:"first_name",component:o.Mg,placeholder:K("enter_firstname")}),(0,k.jsx)(s.gN,{label:K("last_name"),name:"last_name",component:o.Mg,placeholder:K("enter_lastname")}),(0,k.jsx)(s.gN,{type:"email",label:K("email"),name:"username",component:o.Mg,placeholder:K("enter_email")}),(0,k.jsx)(s.gN,{label:K("phone_number"),name:"mobile",component:o.UO,placeholder:K("enter_phone"),enableSearch:!0,onChangeHandler:C}),(0,k.jsxs)("div",{className:"row align-user-start remove-inner-label mb-3.5",children:[(0,k.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:K("staff_departments")}),(0,k.jsx)(g.Z.All,{entity:"tree",name:"AllTreeDepartments-Staff-".concat(I),url:"/".concat(I,"/departments/tree/"),params:{limit:100,extra:{is_staff:"True"}},children:function(e){var n=e.items,t=e.isFetched;return ue=t&&(0,y.w)(n),(0,k.jsx)(k.Fragment,{children:t?(0,k.jsx)("div",{children:(0,k.jsx)(f.ZP,(0,a.Z)({getPopupContainer:function(e){return e.parentNode},className:(0,w.Z)("w-full",{"tree-select-dark-mode":q}),transitionName:"rc-tree-select-dropdown-slide-up",choiceTransitionName:"rc-tree-select-selection__choice-zoom",dropdownStyle:{overflow:"auto"},dropdownPopupAlign:{overflow:{adjustY:0,adjustX:0},offset:[0,2]},placeholder:(0,k.jsx)("i",{children:K("select_staff_departments")}),searchPlaceholder:"please search",treeLine:!0,maxTagTextLength:10,multiple:!0,allowClear:!0,autoClearSearchValue:!0,treeData:ue,treeNodeFilterProp:"title",treeCheckable:!0,treeCheckStrictly:!0,treeDefaultExpandAll:!A,showCheckedStrategy:f.hT,onChange:function(e){ce((function(n){return(0,a.Z)((0,a.Z)({},n),{},{staffDeps:e})}))}},A?null:{value:(0,r.Z)(fe)}))}):(0,k.jsx)("div",{className:"flex justify-center",children:(0,k.jsx)(c.aN,{})})})}})]}),(0,k.jsxs)("div",{className:"mb-3.5",children:[(0,k.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:K("client_departments")}),(0,k.jsx)(g.Z.All,{entity:"tree",name:"AllTreeDepartments-Client-".concat(I),url:"/".concat(I,"/departments/tree/"),params:{limit:100,extra:{is_staff:"False"}},children:function(e){var n=e.items,t=e.isFetched;return de=t&&(0,y.w)(n),(0,k.jsx)(k.Fragment,{children:t?(0,k.jsx)("div",{children:(0,k.jsx)(f.ZP,(0,a.Z)({getPopupContainer:function(e){return e.parentNode},className:(0,w.Z)("w-full",{"tree-select-dark-mode":q}),transitionName:"rc-tree-select-dropdown-slide-up",choiceTransitionName:"rc-tree-select-selection__choice-zoom",dropdownStyle:{overflow:"auto"},dropdownPopupAlign:{overflow:{adjustY:0,adjustX:0},offset:[0,2]},placeholder:(0,k.jsx)("i",{children:K("select_client_departments")}),searchPlaceholder:"please search",treeLine:!0,maxTagTextLength:10,multiple:!0,allowClear:!0,autoClearSearchValue:!0,treeData:de,treeNodeFilterProp:"title",treeCheckable:!0,treeCheckStrictly:!0,treeDefaultExpandAll:!A,showCheckedStrategy:f.hT,onChange:function(e){ce((function(n){return(0,a.Z)((0,a.Z)({},n),{},{clientDeps:e})}))}},A?null:{value:(0,r.Z)(me)}))}):(0,k.jsx)("div",{className:"flex justify-center",children:(0,k.jsx)(c.aN,{})})})}})]}),(0,k.jsxs)("div",{className:"mb-3.5",children:[(0,k.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:K("roles")}),(0,k.jsx)(s.gN,{component:o.mg,styles:u.gb,name:"roles",defaultValue:(0,a.Z)((0,a.Z)({},le[2]),{},{label:K(null===(p=le[2])||void 0===p?void 0:p.value)}),options:le,isSearchable:!d.tq,isDisabled:M})]})]}),(0,k.jsxs)("div",{className:"branch-form__footer flex justify-end px-6 pt-4 pb-9",children:[(0,k.jsx)(c.Ik,{className:"mr-5 border border-kgrey text-kgrey",color:"default",onClick:D,children:K("cancel")}),(0,k.jsx)(c.Ik,{className:"dark:text-white dark:hover:bg-primary-300 dark:focus:ring-primary-300",type:"submit",isSubmitting:N,color:"primary",isDisabled:Boolean(null==Z?void 0:Z.departments),children:K(A?"create":"update")})]}),N?(0,k.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-70",children:(0,k.jsx)(c.aN,{})}):null]})}C.defaultProps={isCreate:!0,department:null,resetForm:function(){}}},58237:function(e,n,t){t.d(n,{O:function(){return f}});var a=t(15861),r=t(29439),l=t(64687),i=t.n(l),s=t(36261),o=t(40084),c=t(49935),u=t(87818),d=t(72791),m=t(97689);function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=(0,o.m)().companyId,t=(0,m.a)().companies,l=(0,u.I0)(),f=(0,s.eC)().showNotification,p=(0,s.r1)().updateEntities,h=(0,s.Kx)(),v=h.changeUrlParams,b=h.removeMultipleParams,g=(0,d.useState)("re_assign"),y=(0,r.Z)(g,2),x=y[0],_=y[1],w=(0,s.e)({pageKey:"page",entity:"staffEmployee",entityName:"staffEmployee-".concat(n)}).forwardToPreviousPage,j=(0,d.useState)(0),k=(0,r.Z)(j,2),S=k[0],C=k[1],N=(0,s.iR)(),Z=N.visible,D=N.showVisible,E=N.loading,A=N.toggleLoading,P=N.closePopup,V=(0,s.iR)(),F=V.visible,T=V.showVisible,M=V.closePopup,K=(0,s.iR)(),R=K.visible,I=K.showVisible,q=K.closePopup,L=(0,s.iR)(),U=L.visible,B=L.showVisible,O=L.closePopup,z=(0,s.iR)(),H=z.visible,X=z.showVisible,Y=z.closePopup,G=function(t){return function(){!function(t){A(),l((0,c.Bi)({entity:"staffEmployee",name:"staffEmployee-".concat(n),method:"delete",url:"/".concat(n,"/employee/").concat(t.id,"/"),deleteData:!0,id:t.id,cb:{success:function(){f({message:"Successfully deleted",variant:"success"}),l((0,c.KX)("staffEmployee","staffEmployee-".concat(n))),ie(),e(),w()},error:function(e){var n,t;f({message:null==e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message,variant:"error"})},finally:function(){A(),P()}},params:{},primaryKey:"id",values:{}}))}(t)}},W=(0,d.useCallback)((function(){_("delete"),re(U),O()}),[U,O,x,R]),$=(0,d.useCallback)((function(){G(H)(),Y()}),[H]),J=(0,d.useCallback)((function(e){return function(){_("re_assign"),re(e)}}),[x]),Q=(0,d.useMemo)((function(){return"/".concat(n,"/companies/staffs_count/")}),[n]),ee=(0,s.bK)({url:Q}),ne=ee.fetchData,te=ee.response,ae=ee.loading;(0,d.useEffect)((function(){n&&(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:case"end":return e.stop()}}),e)})))()}),[n]),(0,d.useEffect)((function(){if(n&&t.length){var e=t.find((function(e){return e.company.id===n})),a=null==e?void 0:e.company.comp_subscription;a&&C(a.paid_staffs_count)}}),[t,n]);var re=(0,d.useCallback)((function(e){v({reAssign:"true"}),I(e)}),[]),le=(0,d.useCallback)((function(){b(["reAssign"]),q()}),[]),ie=function(){p({entity:"staffEmployee",entityId:null==Z?void 0:Z.id,updatingData:{roles:[]}})};var se=(0,s.bK)({url:"",dynamicUrl:!0,cb:{success:function(e,n){var t=(null==n?void 0:n[0]).onAfterCasesCountSuccess;null==t||t(e)},error:function(e){console.log(e,"requestUserAssignedCasesCount")}}}),oe=se.fetchData,ce=(se.loading,(0,d.useCallback)((function(e){return(0,a.Z)(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,oe({url:"/".concat(n,"/employee/").concat(null==e?void 0:e.id,"/check-assigned-cases/"),onAfterCasesCountSuccess:function(n){n.has_assigned_cases?B(e):D(e)}});case 2:case"end":return t.stop()}}),t)})))}),[]));return{deleteLoading:E,closeDeletePopup:P,deleteVisible:Z,editVisible:F,showEditVisible:T,closeEditPopup:M,staffCountLoading:ae,staffCountResponse:te,paidMemberCount:S,fetchStaffCount:ne,reAssignModalVisible:R,closeReAssignModalHandler:le,reAssignmentActionType:x,reAssignRequiredWarningVisible:U,closeReAssignRequiredWarningVisible:O,clickDeleteButtonHandler:ce,clickReAssignmentHandler:J,deleteClientHandler:G,handleOpenDeleteConfirmation:X,handleConfirmReAssignRequiredModal:W,handleDeletePermanentlyConfirmClicked:$,closeDeleteConfirmation:Y,openDeleteConfirmation:H}}},98741:function(e,n,t){t.d(n,{w:function(){return r}});var a=t(93433),r=function e(n){return n.reduce((function(n,t){if(!(t.sub_departments.length>0))return[].concat((0,a.Z)(n),[{title:t.name,key:t.id,value:t.id}]);for(;t.sub_departments.length>0;)return[].concat((0,a.Z)(n),[{title:t.name,key:t.id,value:t.id,children:e(t.sub_departments)}])}),[])}}}]);
//# sourceMappingURL=4601.10ea14dc.chunk.js.map