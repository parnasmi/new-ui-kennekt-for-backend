{"version":3,"file":"static/js/3814.b6f318b3.chunk.js","mappings":"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","sources":["pages/GroupChat/components/GroupFormElements.tsx","pages/GroupChat/components/CreateGroupForm.tsx","pages/GroupChat/components/GroupSidebarSearch.tsx","pages/GroupChat/hooks/useChatMenu.tsx","pages/GroupChat/components/ChatItemMarkup.tsx","pages/GroupChat/components/ChatItem.tsx","pages/GroupChat/components/GroupList.tsx","pages/GroupChat/chat-components/GroupMessagesList.tsx","pages/GroupChat/chat-components/GroupChatInputControls.tsx","pages/GroupChat/components/PermissionItem.tsx","pages/GroupChat/components/ChatPermissionMenuItem.tsx","pages/GroupChat/components/EditGroupForm.tsx","pages/GroupChat/components/Permissions.tsx","pages/GroupChat/hooks/useGroupRequest.ts","pages/GroupChat/chat-components/GroupChatMembers.tsx","pages/GroupChat/hooks/useGroupMessageSearch.ts","pages/GroupChat/chat-components/Members/ChatMember.tsx","pages/GroupChat/chat-components/Members/ChatSettingItem.tsx","pages/GroupChat/chat-components/Members/MemberChatSettings.tsx","pages/GroupChat/chat-components/Members/ChatMembersList.tsx","pages/GroupChat/chat-components/Members/MembersFilter.tsx","pages/GroupChat/chat-components/Members/AddChatMembers.tsx","pages/GroupChat/chat-components/Members/ChatMembers.tsx","pages/GroupChat/chat-components/GroupChatHeader.tsx","pages/GroupChat/chat-components/GroupChat.tsx","pages/GroupChat/chat-components/SearchMessageItem.tsx","pages/GroupChat/components/GroupMessageSearch.tsx","pages/GroupChat/Groups.tsx","pages/GroupChat/hooks/useGroupInitialSettings.ts","shared/components/Elements/Fields/InputText.tsx","shared/components/Elements/Fields/InputTextIcon.tsx","shared/components/Elements/Fields/index.ts"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { KntInputField } from '../../../shared/components/Fields';\nimport { Field } from 'formik';\nimport { Button, FileUploader, KntButton, Loader } from '../../../shared/components';\nimport get from 'lodash/get';\nimport { AiOutlineCloseCircle } from 'react-icons/ai';\nimport config from 'config';\nconst imgPath = `${config.PUBLIC_ASSETS}img`;\n\ntype Props = {\n\tonSuccess: () => void;\n\tsetFieldValue: any;\n\tisSubmitting: boolean;\n\tvalues: any;\n\tisEditing?: any;\n};\n\nexport function GroupFormElements({\n\tonSuccess,\n\tsetFieldValue,\n\tisSubmitting,\n\tvalues,\n\tisEditing = false\n}: Props) {\n\tconst [uploadMeta, setUploadMeta] = useState<any>(null);\n\tconst [cancelSending, setCancelSending] = useState<any>(false);\n\tconst [file, setFile] = useState(isEditing ? values.image : null);\n\n\tuseEffect(() => {\n\t\tif (file) setFieldValue('image', file);\n\t}, [file]);\n\n\treturn (\n\t\t<div>\n\t\t\t<h2 className=\"mb-4 text-xl font-bold\">{`${isEditing ? 'Edit' : 'Create'} Group Chat`}</h2>\n\n\t\t\t<Field\n\t\t\t\tlabel=\"Group chat title\"\n\t\t\t\tlabelClasses=\"ml-6 text-xs font-light text-kgrey-welcome mb-2 block\"\n\t\t\t\tname=\"title\"\n\t\t\t\tcomponent={KntInputField}\n\t\t\t\tplaceholder=\"Group chat title\"\n\t\t\t\trequired\n\t\t\t\tautoComplete=\"off\"\n\t\t\t\tmaxLength={100}\n\t\t\t\t// onChangeHandler={(e: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\t\t// \ttitleRef.current = e.target.value;\n\t\t\t\t// }}\n\t\t\t/>\n\n\t\t\t<Field\n\t\t\t\tlabel=\"Group description\"\n\t\t\t\tlabelClasses=\"ml-6 text-xs font-light text-kgrey-welcome mb-2 block\"\n\t\t\t\tplaceholder=\"Type Group Description\"\n\t\t\t\tname=\"description\"\n\t\t\t\tcomponent={KntInputField}\n\t\t\t\ttype=\"textarea\"\n\t\t\t\tautoComplete=\"off\"\n\t\t\t\tmaxLength={250}\n\t\t\t/>\n\t\t\t<div className=\"mb-4 flex items-center\">\n\t\t\t\t<div className=\"mr-4\">\n\t\t\t\t\t<FileUploader\n\t\t\t\t\t\tuploadMeta={uploadMeta}\n\t\t\t\t\t\tsetUploadMeta={setUploadMeta}\n\t\t\t\t\t\tcancelSending={cancelSending}\n\t\t\t\t\t\tsetCancelSending={setCancelSending}\n\t\t\t\t\t\tsetFile={setFile}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"user-avatar-box__display relative h-20 w-20 overflow-hidden rounded-full\">\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc={get(file, 'thumbnail_150') || `${imgPath}/chat-placeholder.svg`}\n\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\tclassName={'h-full object-cover'}\n\t\t\t\t\t/>\n\t\t\t\t\t{uploadMeta !== null && (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t'absolute top-1/2 left-1/2 z-10 h-10 w-10 -translate-y-1/2 -translate-x-1/2'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"upload-media-spinner\">\n\t\t\t\t\t\t\t\t<Loader variant=\"determinate\" value={uploadMeta} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tsetCancelSending(true);\n\t\t\t\t\t\t\t\t\tsetUploadMeta(null);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t'absolute top-[21px] left-[25px] z-20 h-8 w-8 -translate-y-1/2 -translate-x-1/2 ' +\n\t\t\t\t\t\t\t\t\t'cursor-pointer text-3xl text-primary-dark transition hover:text-primary'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<AiOutlineCloseCircle />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"btn-row mt-6 flex justify-end\">\n\t\t\t\t{isSubmitting && <Loader tiled withOverlay />}\n\t\t\t\t<Button\n\t\t\t\t\tclassName={'mr-5 border border-kgrey text-kgrey'}\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonClickHandler={onSuccess}\n\t\t\t\t>\n\t\t\t\t\tCancel\n\t\t\t\t</Button>\n\t\t\t\t<KntButton\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tclassName={'ml-4 dark:text-white dark:hover:bg-primary-300 dark:focus:ring-primary-300'}\n\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\tisDisabled={isSubmitting || !!uploadMeta}\n\t\t\t\t>\n\t\t\t\t\t{isEditing ? 'Edit Group Chat' : 'Create Group Chat'}\n\t\t\t\t</KntButton>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React from 'react';\nimport EntityForm from 'modules/entity/forms';\nimport { useAppState } from '../../../shared/state';\nimport { GroupFormElements } from './GroupFormElements';\nimport { useQueryParams } from '../../../shared/hooks';\n\ntype Props = {\n\tonSuccess: () => void;\n};\n\nexport function CreateGroupForm({ onSuccess }: Props) {\n\tconst { companyId, groupSearchQuery } = useAppState();\n\tconst { changeUrlParams } = useQueryParams<{ chat: number }>();\n\n\treturn (\n\t\t<EntityForm.Main\n\t\t\tentity={'ims-chats'}\n\t\t\tname={`AllImsChats-${companyId}-${groupSearchQuery}`}\n\t\t\turl={`/${companyId}/ims/groups/`}\n\t\t\tmethod=\"post\"\n\t\t\tprimaryKey=\"id\"\n\t\t\tsendAsFormData={false}\n\t\t\tnormalizeData={(data: any) => data}\n\t\t\tprependData\n\t\t\tfields={[\n\t\t\t\t{\n\t\t\t\t\tname: 'title',\n\t\t\t\t\trequired: true,\n\t\t\t\t\tvalue: '',\n\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'description',\n\t\t\t\t\tvalue: '',\n\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'image',\n\t\t\t\t\tonSubmitKey: '',\n\t\t\t\t\ttype: 'object'\n\t\t\t\t}\n\t\t\t]}\n\t\t\tonSuccess={(response, resetForm): any => {\n\t\t\t\tchangeUrlParams({ chat: response.id });\n\t\t\t\tonSuccess();\n\t\t\t\tresetForm();\n\t\t\t}}\n\t\t\tonError={(error, resetForm): any => {\n\t\t\t\tconsole.log(error);\n\t\t\t}}\n\t\t>\n\t\t\t{({ isSubmitting, values, setFieldValue }) => {\n\t\t\t\tif (process.env.NODE_ENV === 'development') {\n\t\t\t\t\tconsole.log('group create values', values);\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<GroupFormElements\n\t\t\t\t\t\tonSuccess={onSuccess}\n\t\t\t\t\t\tisSubmitting={isSubmitting}\n\t\t\t\t\t\tsetFieldValue={setFieldValue}\n\t\t\t\t\t\tvalues={values}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t}}\n\t\t</EntityForm.Main>\n\t);\n}\n","import React, { useEffect, useState } from 'react';\nimport { CgSearch } from 'react-icons/cg';\nimport { useDebounce } from 'use-debounce';\nimport { useAppState } from '../../../shared/state';\nimport { useWhiteModal } from '../../../shared/hooks';\nimport { CreateGroupForm } from './CreateGroupForm';\nimport { Fab } from '@material-ui/core';\nimport { IoMdAdd } from 'react-icons/io';\nimport { BsFillBellFill } from 'react-icons/bs';\nimport { AiOutlineMenuUnfold } from 'react-icons/ai';\n\ntype Props = {\n\ttoggleIsUnreadFilter: any;\n\tisUnreadFilter: boolean;\n};\n\nexport function GroupSidebarSearch({ toggleIsUnreadFilter, isUnreadFilter }: Props) {\n\tconst [query, setQuery] = useState('');\n\tconst [searchQuery] = useDebounce(query, 500);\n\tconst { setGroupSearchQuery, groupsUnreadCountData } = useAppState();\n\tconst { open, modalHandler, WhiteModal } = useWhiteModal();\n\tconst totalGroupUnreadCount = Object.values(groupsUnreadCountData)?.filter(\n\t\t(count) => count > 0\n\t).length;\n\n\tuseEffect(() => {\n\t\tsetGroupSearchQuery(searchQuery);\n\t}, [searchQuery]);\n\n\treturn (\n\t\t<div className=\"mb-4 flex\">\n\t\t\t{totalGroupUnreadCount ? (\n\t\t\t\t<div\n\t\t\t\t\tonClick={() => toggleIsUnreadFilter()}\n\t\t\t\t\tclassName=\"relative mr-3 mt-1.5 cursor-pointer rounded-10 bg-kgrey-dark-2 p-2\">\n\t\t\t\t\t{!isUnreadFilter ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<span className=\"absolute -top-1 left-1.5 right-1.5 rounded-md bg-kred-pink text-center text-10px text-white\">\n\t\t\t\t\t\t\t\t{totalGroupUnreadCount}\n\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t<BsFillBellFill />\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<AiOutlineMenuUnfold />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t) : null}\n\n\t\t\t<div className=\"group-sidebar__search relative flex-grow  pr-2\">\n\t\t\t\t<input\n\t\t\t\t\ttype=\"search\"\n\t\t\t\t\tvalue={query}\n\t\t\t\t\tclassName={\n\t\t\t\t\t\t'group-sidebar__search-input w-full border-b outline-none ' +\n\t\t\t\t\t\t'border-kgrey-border-solid' +\n\t\t\t\t\t\t' pl-7 transition focus:border-primary' +\n\t\t\t\t\t\t' placeholder-[rgba(45, 45, 45, 0.3)] py-2 dark:bg-kdark dark:text-white'\n\t\t\t\t\t}\n\t\t\t\t\tplaceholder={'Search for chats'}\n\t\t\t\t\tonChange={(e) => setQuery(e.target.value)}\n\t\t\t\t/>\n\t\t\t\t<div className=\"absolute top-1/2 left-0 -translate-y-1/2\">\n\t\t\t\t\t<div className=\"text-kgrey\">\n\t\t\t\t\t\t<CgSearch />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Fab color=\"primary\" size=\"small\" onClick={modalHandler}>\n\t\t\t\t<IoMdAdd className=\"text-2xl text-white\" />\n\t\t\t</Fab>\n\t\t\t<WhiteModal handleModalOpen={modalHandler} open={open}>\n\t\t\t\t<CreateGroupForm onSuccess={modalHandler} />\n\t\t\t</WhiteModal>\n\t\t</div>\n\t);\n}\n","import React, { useState } from 'react';\nimport { useAxios } from 'shared/hooks';\nimport { useAppState } from 'shared/state';\nimport Actions from 'store/actions';\nimport { useDispatch } from 'react-redux';\nconst UpdateEntities = Actions.entities.updateEntitiesSuccess;\n\ntype Pin = null | string | number;\n\nexport function useChatMenu(pin_time: Pin, chatId: number, isFromChat = false) {\n\tconst [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\n\tconst [managerRequested, setManagerRequested] = useState<boolean>(false);\n\tconst { companyId, toggleChatPanel } = useAppState();\n\tconst open = Boolean(anchorEl);\n\tconst dispatch = useDispatch();\n\n\tconst handleClick = (event: React.MouseEvent<HTMLElement>) => {\n\t\tsetAnchorEl(event.currentTarget);\n\t};\n\n\t//pin and unpin handler\n\tconst { fetchData: pinCase } = useAxios({\n\t\turl: `/${companyId}/ims/groups/${chatId}/pin/`,\n\t\tmethod: `${pin_time ? 'delete' : 'put'}`,\n\t\tcb: {\n\t\t\tsuccess: (data, args) => {\n\t\t\t\tconst [isPinning] = args;\n\t\t\t\tdispatch(\n\t\t\t\t\tUpdateEntities({\n\t\t\t\t\t\tentity: 'ims-chats',\n\t\t\t\t\t\tentityId: String(chatId),\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tpin_time: isPinning ? Date.now() : null\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tif (isFromChat) {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tUpdateEntities({\n\t\t\t\t\t\t\tentity: 'ims-chats',\n\t\t\t\t\t\t\tentityId: String(chatId),\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tpin_time: isPinning ? Date.now() : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: (error) => {}\n\t\t}\n\t});\n\n\tconst handleNotificationClose = (event?: React.SyntheticEvent, reason?: string) => {\n\t\tif (reason === 'clickaway') {\n\t\t\treturn;\n\t\t}\n\n\t\tsetManagerRequested(false);\n\t};\n\n\tconst handleMenuItemClick = (menuType: string) => {\n\t\tswitch (menuType) {\n\t\t\tcase 'pin': {\n\t\t\t\tpinCase(true);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'unpin': {\n\t\t\t\tpinCase(false);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t};\n\n\tconst handleCloseMenu = () => {\n\t\tsetAnchorEl(null);\n\t};\n\n\treturn {\n\t\topen,\n\t\thandleClick,\n\t\tanchorEl,\n\t\tmanagerRequested,\n\t\thandleNotificationClose,\n\t\thandleMenuItemClick,\n\t\thandleCloseMenu\n\t};\n}\n","/**@jsxImportSource @emotion/react */\nimport React from 'react';\nimport clsx from 'clsx';\nimport { css } from '@emotion/react';\nimport { nanoid } from 'nanoid';\nimport { LastMessageView } from 'shared/components/LastMessageView';\nimport { time } from 'shared/services';\nimport { IconVertical } from 'shared/icons/IconVertical';\nimport { Menu } from 'shared/components/Elements';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { IconGroupChatMuted, IconPin } from 'shared/icons';\nimport { useQueryParams } from 'shared/hooks';\nimport { useAppState } from 'shared/state';\nimport config from 'config';\nimport { useChatMenu } from '../hooks/useChatMenu';\nimport { ChatItemProps } from '../types';\nconst imgPath = `${config.PUBLIC_ASSETS}img/`;\n\nexport function ChatItemMarkup({\n\tchatId,\n\timage,\n\ttitle,\n\tlast_message_author,\n\tlast_message_type,\n\tlast_message_text,\n\tlast_message_time,\n\tpin_time,\n\tdraftMessage,\n\tisMuted = false,\n\tlastReadMessage = null\n}: ChatItemProps) {\n\tconst { groupsUnreadCountData, setActiveDraft } = useAppState();\n\tconst { changeUrlParams, query } = useQueryParams<{ chat: number; searchedMessageId?: number }>();\n\n\tconst { open, handleClick, anchorEl, handleMenuItemClick, handleCloseMenu } = useChatMenu(\n\t\tpin_time,\n\t\tchatId\n\t);\n\n\tconst { setChatUuid } = useAppState();\n\n\tconst isActive = query && Number(query.chat) === chatId;\n\tconst chatAvatar = image || `${imgPath}chat-placeholder.png`;\n\tconst hasUnread = groupsUnreadCountData?.[chatId];\n\n\tconst chatItemClickHandler = () => {\n\t\tchangeUrlParams({\n\t\t\tchat: chatId,\n\t\t\t...{\n\t\t\t\t...(lastReadMessage && hasUnread\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tunread: lastReadMessage,\n\t\t\t\t\t\t\thasUnreadMessage: true,\n\t\t\t\t\t\t\tlastReadMessage\n\t\t\t\t\t  }\n\t\t\t\t\t: {})\n\t\t\t}\n\t\t});\n\t\tsetChatUuid(nanoid());\n\t\tsetActiveDraft(draftMessage);\n\t};\n\n\treturn (\n\t\t<div\n\t\t\tclassName={clsx('chat-item mb-3 cursor-pointer rounded-lg p-2 transition hover:opacity-80 ', {\n\t\t\t\t'bg-primary-300 dark:bg-primary-300': isActive,\n\t\t\t\t'dark:bg-white/10': !isActive\n\t\t\t})}\n\t\t>\n\t\t\t<div className=\"chat-item__inner flex w-full items-center justify-between\">\n\t\t\t\t<div className=\"chat-item__img h-14 w-14 flex-shrink-0 overflow-hidden rounded-full\">\n\t\t\t\t\t<img src={chatAvatar} alt=\"\" className=\"h-full object-cover\" />\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"chat-item__body flex flex-grow items-center justify-between pl-2\"\n\t\t\t\t\tcss={css`\n\t\t\t\t\t\twidth: 275px;\n\t\t\t\t\t`}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"chat-item__content w-9/12 overflow-hidden pr-2\"\n\t\t\t\t\t\tonClick={chatItemClickHandler}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"chat-item__title flex-center-y truncate text-sm font-semibold dark:text-white\">\n\t\t\t\t\t\t\t<span>{title}</span>\n\t\t\t\t\t\t\t{isMuted && (\n\t\t\t\t\t\t\t\t<span className=\"ml-1 block h-4 w-4 text-kgrey\">\n\t\t\t\t\t\t\t\t\t<IconGroupChatMuted />\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"chat-item__muted\">\n\t\t\t\t\t\t\t{last_message_author ? (\n\t\t\t\t\t\t\t\t<LastMessageView\n\t\t\t\t\t\t\t\t\tlast_message_type={last_message_type}\n\t\t\t\t\t\t\t\t\tlast_message_text={last_message_text || ''}\n\t\t\t\t\t\t\t\t\tlast_message_author={last_message_author}\n\t\t\t\t\t\t\t\t\tdraftMessage={draftMessage}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"chat-item__info  flex w-3/12 flex-shrink-0 flex-col  items-end\">\n\t\t\t\t\t\t<div className=\"chat-item___actions mb-2.5 flex items-center justify-between\">\n\t\t\t\t\t\t\t<div className=\"chat-item__date text-[10px] font-bold text-kgrey-chatGrey/30 dark:text-white\">\n\t\t\t\t\t\t\t\t{time.toLastTime(last_message_time)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"chat-item__dots\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"more-btn w-4 cursor-pointer text-right text-kgrey-menuText transition-colors hover:text-primary dark:text-white dark:hover:text-primary\"\n\t\t\t\t\t\t\t\t\tonClick={handleClick}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<IconVertical className={'inline'} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Menu\n\t\t\t\t\t\t\t\t\tid=\"long-menu\"\n\t\t\t\t\t\t\t\t\tanchorEl={anchorEl}\n\t\t\t\t\t\t\t\t\tkeepMounted\n\t\t\t\t\t\t\t\t\topen={open}\n\t\t\t\t\t\t\t\t\tonClose={handleCloseMenu}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\thandleCloseMenu();\n\t\t\t\t\t\t\t\t\t\t\thandleMenuItemClick(pin_time ? 'unpin' : 'pin');\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{`${pin_time ? 'Unpin' : 'Pin'} Chat`}\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t</Menu>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"chat-item___pin mt-auto flex items-center justify-end leading-none\">\n\t\t\t\t\t\t\t{pin_time ? <IconPin className={'text-kgrey-menuText'} /> : null}\n\t\t\t\t\t\t\t{hasUnread ? (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t'ml-2 h-6 w-6  rounded-full text-center text-sm font-semibold leading-6 text-white',\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t'bg-primary': !isMuted,\n\t\t\t\t\t\t\t\t\t\t\t'bg-kgrey': isMuted\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{hasUnread}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React from 'react';\nimport { ChatItemMarkup } from './ChatItemMarkup';\nimport { ChatItemProps } from '../types';\nimport { ErrorBoundary } from 'shared/components';\n\nfunction ChatItemInner(props: ChatItemProps) {\n\tconst {\n\t\tchatId,\n\t\timage,\n\t\tpin_time,\n\t\tlast_message_type,\n\t\tlast_message_text,\n\t\ttitle,\n\t\tlast_message_author,\n\t\tlast_message_time,\n\t\tisMuted,\n\t\tdraftMessage,\n\t\tlastReadMessage\n\t} = props;\n\n\treturn (\n\t\t<ChatItemMarkup\n\t\t\tchatId={chatId}\n\t\t\ttitle={title}\n\t\t\timage={image}\n\t\t\tlast_message_author={last_message_author}\n\t\t\tlast_message_type={last_message_type}\n\t\t\tlast_message_text={last_message_text}\n\t\t\tlast_message_time={last_message_time}\n\t\t\tpin_time={pin_time}\n\t\t\tisMuted={isMuted}\n\t\t\tdraftMessage={draftMessage}\n\t\t\tlastReadMessage={lastReadMessage}\n\t\t/>\n\t);\n}\n\nexport function ChatItem(props: ChatItemProps) {\n\treturn (\n\t\t<ErrorBoundary isCompact>\n\t\t\t<ChatItemInner {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import React, { useState, useEffect } from 'react';\nimport ContentLoader from 'react-content-loader';\nimport { ChatItem } from './ChatItem';\nimport EntityContainer from 'modules/entity/containers';\nimport { useAppState } from 'shared/state';\nimport { ErrorBoundary, LoadMoreVisible } from 'shared/components';\nimport { GroupMember, IGroupChat } from 'shared/interfaces';\nimport { useAuth } from 'modules/auth/hooks/useAuth';\nimport { useQueryParams } from 'shared/hooks';\nimport { sortChatList } from 'shared/services';\nimport { buildGroupParams, CHATS_MESSAGES_LIMIT } from 'shared/consts/groupChat.const';\n\ntype Props = {\n\tisUnreadFilter: boolean;\n};\n\nfunction GroupListInner({ isUnreadFilter }: Props) {\n\tconst [page, setPage] = useState(1);\n\tconst [searchPage, setSearchPage] = useState(1);\n\tconst { companyId, groupSearchQuery, groupsUnreadCountData } = useAppState();\n\tconst { userData } = useAuth();\n\tconst { query } = useQueryParams();\n\tconst isActiveChat = query.chat;\n\n\tuseEffect(() => {\n\t\tsetSearchPage(1);\n\t\tsetPage(1);\n\t}, [groupSearchQuery]);\n\n\treturn (\n\t\t<div className=\"group-sidebar__chats flex-grow overflow-y-auto pt-2\">\n\t\t\t{companyId ? (\n\t\t\t\t<EntityContainer.All\n\t\t\t\t\tentity={'ims-chats'}\n\t\t\t\t\tname={`AllImsChats-${companyId}-${groupSearchQuery}`}\n\t\t\t\t\turl={`/${companyId}/ims/groups/`}\n\t\t\t\t\tparams={{\n\t\t\t\t\t\textra: buildGroupParams(groupSearchQuery, isUnreadFilter),\n\t\t\t\t\t\tlimit: CHATS_MESSAGES_LIMIT,\n\t\t\t\t\t\tpage: groupSearchQuery.length ? searchPage : page\n\t\t\t\t\t}}\n\t\t\t\t\t// primaryKey={groupSearchQuery.length ? 'message_id' : 'id'}\n\t\t\t\t\tappendData\n\t\t\t\t\t// replaceIds\n\t\t\t\t\tisCancellable={!!groupSearchQuery.length}\n\t\t\t\t\tcancelField=\"groupChat\"\n\t\t\t\t>\n\t\t\t\t\t{({ items, isFetched, meta }) => {\n\t\t\t\t\t\t//3192's fix: remove unmatched groups on real-time when unread filter is active\n\t\t\t\t\t\tconst mappedAndFilteredChatItems = (items as IGroupChat[]).filter((item) =>\n\t\t\t\t\t\t\tisUnreadFilter\n\t\t\t\t\t\t\t\t? groupsUnreadCountData[item.id] > 0 || item.id.toString() === isActiveChat\n\t\t\t\t\t\t\t\t: item\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst sortedChatItems = sortChatList<IGroupChat>(mappedAndFilteredChatItems);\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{sortedChatItems.map((item) => {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<React.Fragment key={item.id}>\n\t\t\t\t\t\t\t\t\t\t\t<ChatItem\n\t\t\t\t\t\t\t\t\t\t\t\tchatId={item.id}\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={item.title}\n\t\t\t\t\t\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\t\t\t\t\t\tpin_time={item.pin_time}\n\t\t\t\t\t\t\t\t\t\t\t\tlast_message_type={item.last_message_type}\n\t\t\t\t\t\t\t\t\t\t\t\tlast_message_author={item.last_message_author}\n\t\t\t\t\t\t\t\t\t\t\t\tlast_message_text={item.last_message_text}\n\t\t\t\t\t\t\t\t\t\t\t\tlast_message_time={item.last_message_time}\n\t\t\t\t\t\t\t\t\t\t\t\timage={item.image?.thumbnail_150 || null}\n\t\t\t\t\t\t\t\t\t\t\t\tisMuted={\n\t\t\t\t\t\t\t\t\t\t\t\t\titem?.members?.find(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(member: GroupMember) => member.user.id === userData.id\n\t\t\t\t\t\t\t\t\t\t\t\t\t)?.is_mute\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tdraftMessage={item.draft_message}\n\t\t\t\t\t\t\t\t\t\t\t\tlastReadMessage={item.last_read_message}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{!isFetched ? (\n\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t{[...Array(10)].map((_: any, key) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={'mb4'} key={key}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChatListLoader />\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{isFetched &&\n\t\t\t\t\t\t\t\t\tmeta?.current_page &&\n\t\t\t\t\t\t\t\t\tmeta?.last_page &&\n\t\t\t\t\t\t\t\t\tmeta?.current_page < meta?.last_page ? (\n\t\t\t\t\t\t\t\t\t\t<LoadMoreVisible\n\t\t\t\t\t\t\t\t\t\t\tsetPage={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (meta.current_page !== page) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetPage(meta.current_page as number);\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tgroupSearchQuery.length\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? setSearchPage(searchPage + 1)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: setPage(page + 1);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t</EntityContainer.All>\n\t\t\t) : null}\n\t\t</div>\n\t);\n}\n\nexport function GroupList(props: Props) {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<GroupListInner {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n\nfunction ChatListLoader() {\n\treturn (\n\t\t<ContentLoader\n\t\t\tspeed={2}\n\t\t\twidth={362}\n\t\t\theight={72}\n\t\t\tviewBox=\"0 0 362 72\"\n\t\t\tbackgroundColor=\"#f3f3f3\"\n\t\t\tforegroundColor=\"#ecebeb\"\n\t\t>\n\t\t\t<circle cx=\"48\" cy=\"33\" r=\"24\" />\n\t\t\t<rect x=\"79\" y=\"14\" rx=\"7\" ry=\"7\" width=\"217\" height=\"18\" />\n\t\t\t<rect x=\"80\" y=\"42\" rx=\"5\" ry=\"5\" width=\"155\" height=\"11\" />\n\t\t\t<rect x=\"351\" y=\"12\" rx=\"4\" ry=\"4\" width=\"12\" height=\"32\" />\n\t\t\t<rect x=\"313\" y=\"13\" rx=\"5\" ry=\"5\" width=\"30\" height=\"11\" />\n\t\t</ContentLoader>\n\t);\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useCallback, useMemo, useRef } from 'react';\nimport { css } from '@emotion/react';\nimport EntityContainer from 'modules/entity/containers';\nimport { IMessage } from 'shared/interfaces';\nimport useDimensions from 'react-use-dimensions';\nimport { isSafari } from 'react-device-detect';\nimport clsx from 'clsx';\nimport { useChatContext } from 'shared/contexts/ChatContext';\nimport { ErrorBoundary } from 'shared/components';\nimport {\n\tChatMessage,\n\tVirtuosoCustomItem,\n\tVirtuosoFooter,\n\tVirtuosoScrollWrapper\n} from 'shared/components/Chat/components';\nimport { useOnInit, useGetEntityOne, useQueryParams } from 'shared/hooks';\nimport { useAppState } from 'shared/state';\nimport { useChatInputContext } from 'shared/contexts';\nimport { useChatMessagesList } from 'shared/hooks/chat-hooks/useChatMessagesList';\nimport { ChatMessagesLoader } from 'shared/components/Chat/components';\nimport VizSensor from 'react-visibility-sensor';\nimport { checkMsgAuthor } from 'shared/components/Chat/utils';\nimport { Virtuoso } from 'react-virtuoso';\n\ntype Props = {\n\tchatId: number;\n};\n\nconst SHOW_LOGS = true;\n\nfunction GroupMessagesListInner({ chatId }: Props) {\n\tconst [chatBodyRef, { height: chatBodyHeight }] = useDimensions();\n\tconst { setIsDelayedMessage, isDelayedMessage } = useChatInputContext();\n\tconst { afterMessagesFetchService } = useOnInit();\n\tconst { entityPage, groupsUnreadCountData } = useAppState();\n\tconst { query } = useQueryParams();\n\tconst lastReadMsgIdFromQuery = (query.unread && Number(query.unread)) || null;\n\tconst hasUnread = !!groupsUnreadCountData?.[chatId];\n\tconst hasUnreadCached = useMemo(() => !!groupsUnreadCountData?.[chatId], [chatId]);\n\tconst firstUnread = useRef<number | null | undefined>(null);\n\n\tconst {\n\t\tentityId,\n\t\tisSetSearchReply,\n\t\tallowToLoad,\n\t\tsetAllowToLoad,\n\t\tdirection,\n\t\tmessagesLimit,\n\t\treplyLoading,\n\t\tscrollToMsgId,\n\t\tstate,\n\t\tsetScrollPosition,\n\t\tisMsgHasBeenIndicated,\n\t\tvirtuosoRef\n\t} = useChatContext();\n\n\tconst chatEntity = useGetEntityOne({\n\t\tentity: 'ims-chats',\n\t\tentityId,\n\t\tentityName: `GroupChat-${entityId}One`\n\t});\n\n\tconst {\n\t\tcursorTop,\n\t\tcursorBot,\n\t\thandlePageLoading,\n\t\tlocalEntityId,\n\t\tscrollIntoElement,\n\t\tisLoadedRepliedMessage,\n\t\tmessageVisibleHandler,\n\t\tsetUpdateEntityPage,\n\t\tsearchedMessageId,\n\t\tpaginationDepsRef,\n\t\tcursor,\n\t\tisLastPageFetched,\n\t\tsetIsLastPageFetched,\n\t\tisFirstPageFetched,\n\t\tsetIsFirstPageFetched,\n\t\ttotalMessagesCount,\n\t\tremoveUnreadCountFromCaseList\n\t} = useChatMessagesList();\n\n\tif (process.env.NODE_ENV === 'development' && SHOW_LOGS) {\n\t\tconsole.log('GroupMessagesList', {\n\t\t\tentityPage,\n\t\t\tallowToLoad,\n\t\t\tdirection,\n\t\t\tstate,\n\t\t\tcursorBot,\n\t\t\tcursorTop,\n\t\t\tisLoadedRepliedMessage,\n\t\t\tscrollToMsgId,\n\t\t\tisSetSearchReply,\n\t\t\treplyLoading,\n\t\t\tsearchedMessageId,\n\t\t\tcursor,\n\t\t\tisLastPageFetched,\n\t\t\tisFirstPageFetched,\n\t\t\tpaginationDepsRef,\n\t\t\ttotalMessagesCount\n\t\t});\n\t}\n\n\tconst shouldStartFromFirstUnread = lastReadMsgIdFromQuery && direction === null;\n\n\treturn (\n\t\t<EntityContainer.All\n\t\t\tentity=\"imsMessages\"\n\t\t\tname={`AllImsMessages-${localEntityId}`}\n\t\t\turl={`/messages/massive-load/cursor-based/`}\n\t\t\tprimaryKey={'custom_uuid' || 'id'}\n\t\t\tprependData={(direction === 'next' || direction === null) && !isSetSearchReply}\n\t\t\tappendData={direction === 'previous' && !isSetSearchReply}\n\t\t\tisUniq\n\t\t\tcursorBased\n\t\t\tdirection={\n\t\t\t\tlastReadMsgIdFromQuery && direction === null\n\t\t\t\t\t? '1'\n\t\t\t\t\t: cursor === Number(scrollToMsgId)\n\t\t\t\t\t? '0'\n\t\t\t\t\t: direction === 'next' || direction === null\n\t\t\t\t\t? '-1'\n\t\t\t\t\t: '1'\n\t\t\t}\n\t\t\treplaceIds={\n\t\t\t\t(isLoadedRepliedMessage && cursor === scrollToMsgId && direction === null) ||\n\t\t\t\t//Fix prepended messages issues which had to be appended on case open. This is happened when reopened already opened and closes case which had new unread messages(2158, 2170)\n\t\t\t\t(cursor === null && (direction === 'next' || direction === null)) ||\n\t\t\t\t//TODO:MIGHT BE BREAKING CHANGE\n\t\t\t\t(hasUnread && !!lastReadMsgIdFromQuery)\n\t\t\t}\n\t\t\tparams={{\n\t\t\t\tlimit: messagesLimit,\n\t\t\t\textra: {\n\t\t\t\t\tentity_id: localEntityId,\n\t\t\t\t\tcursor\n\t\t\t\t}\n\t\t\t}}\n\t\t\tonInit={(data) => {\n\t\t\t\tafterMessagesFetchService({\n\t\t\t\t\tdata,\n\t\t\t\t\tisDelayedMessage,\n\t\t\t\t\tsetIsDelayedMessage,\n\t\t\t\t\tsetAllowToLoad,\n\t\t\t\t\tdirection,\n\t\t\t\t\tscrollToMsgId,\n\t\t\t\t\tisMsgHasBeenIndicated,\n\t\t\t\t\tcursorTop,\n\t\t\t\t\tcursorBot,\n\t\t\t\t\tscrollIntoElement,\n\t\t\t\t\tsetUpdateEntityPage,\n\t\t\t\t\tsearchedMessageId,\n\t\t\t\t\tpaginationDepsRef,\n\t\t\t\t\tcursor,\n\t\t\t\t\tsetIsLastPageFetched,\n\t\t\t\t\tmessagesLimit,\n\t\t\t\t\tsetIsFirstPageFetched,\n\t\t\t\t\ttotalMessagesCount,\n\t\t\t\t\tisLoadedRepliedMessage,\n\t\t\t\t\tvirtuosoRef\n\t\t\t\t});\n\t\t\t}}\n\t\t>\n\t\t\t{({ items, isFetched, meta }) => {\n\t\t\t\tconst messagesList = (items as IMessage[]) ?? [];\n\t\t\t\tconst anywayAllowToLoadIfNotInScrollAndIndicateMode = allowToLoad || !isSetSearchReply;\n\t\t\t\t// @ts-ignore\n\t\t\t\treturn (\n\t\t\t\t\t<div ref={chatBodyRef} id={'chat-body'} className={clsx(`chat__body flex-grow`)}>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={clsx('h-full w-full px-5', {\n\t\t\t\t\t\t\t\t// 'pb-8': process.env.NODE_ENV !== 'production',\n\t\t\t\t\t\t\t\t'pt-11': chatEntity.item?.pinned_message\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\tcss={css`\n\t\t\t\t\t\t\t\theight: ${isSafari && `${chatBodyHeight}px`};\n\t\t\t\t\t\t\t`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{/*Messages start*/}\n\n\t\t\t\t\t\t\t{meta ? (\n\t\t\t\t\t\t\t\t<Virtuoso\n\t\t\t\t\t\t\t\t\tcontext={{\n\t\t\t\t\t\t\t\t\t\tisFetched,\n\t\t\t\t\t\t\t\t\t\titems,\n\t\t\t\t\t\t\t\t\t\tisSetSearchReply,\n\t\t\t\t\t\t\t\t\t\tdirection,\n\t\t\t\t\t\t\t\t\t\treplyLoading,\n\t\t\t\t\t\t\t\t\t\tisConfirmationRequired: false\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tref={virtuosoRef}\n\t\t\t\t\t\t\t\t\tfirstItemIndex={meta?.firstItemIndex}\n\t\t\t\t\t\t\t\t\toverscan={{ reverse: 200, main: 100 }}\n\t\t\t\t\t\t\t\t\tinitialTopMostItemIndex={{\n\t\t\t\t\t\t\t\t\t\tindex: shouldStartFromFirstUnread ? 0 : 'LAST',\n\t\t\t\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\t\t\t\tbehavior: 'auto'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tatTopStateChange={(atTop) => {\n\t\t\t\t\t\t\t\t\t\tif (atTop) {\n\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\tanywayAllowToLoadIfNotInScrollAndIndicateMode &&\n\t\t\t\t\t\t\t\t\t\t\t\tisFetched &&\n\t\t\t\t\t\t\t\t\t\t\t\t!isFirstPageFetched\n\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\thandlePageLoading(true, 'next', entityId);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tatBottomStateChange={(atBottom) => {\n\t\t\t\t\t\t\t\t\t\tif (atBottom) {\n\t\t\t\t\t\t\t\t\t\t\t//todo: refactor this\n\n\t\t\t\t\t\t\t\t\t\t\t// if (isLastPageFetched) {\n\t\t\t\t\t\t\t\t\t\t\tsetScrollPosition(true);\n\t\t\t\t\t\t\t\t\t\t\t// }\n\n\t\t\t\t\t\t\t\t\t\t\t//remove unread count if we react the end of chat and there is still unread count left\n\t\t\t\t\t\t\t\t\t\t\tif (isLastPageFetched && !!groupsUnreadCountData?.[chatId]) {\n\t\t\t\t\t\t\t\t\t\t\t\tremoveUnreadCountFromCaseList();\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif (allowToLoad && isFetched && !isLastPageFetched) {\n\t\t\t\t\t\t\t\t\t\t\t\thandlePageLoading(true, 'previous', entityId);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (!atBottom) {\n\t\t\t\t\t\t\t\t\t\t\tsetScrollPosition(false);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tdata={messagesList}\n\t\t\t\t\t\t\t\t\titemContent={(_, item) => {\n\t\t\t\t\t\t\t\t\t\tconst tempMessage = {\n\t\t\t\t\t\t\t\t\t\t\tid: 100000000,\n\t\t\t\t\t\t\t\t\t\t\tname: 'Error message',\n\t\t\t\t\t\t\t\t\t\t\ttext: 'Error occured. This message is not valid',\n\t\t\t\t\t\t\t\t\t\t\ttype: 'ERROR',\n\t\t\t\t\t\t\t\t\t\t\tfrom_user: {}\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tconst idx = messagesList.findIndex((message) => message.id === item.id);\n\n\t\t\t\t\t\t\t\t\t\t//Set isFirstUnread to true if case has unread, not searched case\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\tNumber(query?.lastReadMessage) === item.id &&\n\t\t\t\t\t\t\t\t\t\t\thasUnreadCached &&\n\t\t\t\t\t\t\t\t\t\t\t!searchedMessageId\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tfirstUnread.current = messagesList[idx + 1]?.id;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tconst isFirstUnread =\n\t\t\t\t\t\t\t\t\t\t\tfirstUnread.current && item.id && firstUnread.current === item.id;\n\n\t\t\t\t\t\t\t\t\t\tconst mapKey = item ? item?.custom_uuid || item.id : tempMessage.id;\n\n\t\t\t\t\t\t\t\t\t\tconst { isSameFromUserWithPrev, isSameFromUserWithNext } = checkMsgAuthor({\n\t\t\t\t\t\t\t\t\t\t\tcurrentMsgAuthorId: item.from_user.id,\n\t\t\t\t\t\t\t\t\t\t\tprevMsgAuthorId: messagesList[idx - 1]?.from_user.id,\n\t\t\t\t\t\t\t\t\t\t\tnextMsgAuthorId: messagesList[idx + 1]?.from_user.id,\n\t\t\t\t\t\t\t\t\t\t\tprevMsgType: messagesList[idx - 1]?.type,\n\t\t\t\t\t\t\t\t\t\t\tnextMsgType: messagesList[idx + 1]?.type\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\tconst content = (\n\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t{isFirstUnread && messagesList?.length > 1 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"my-2 mx-0 w-full bg-kgrey-inputBg text-center text-kdark-424242 dark:bg-kdark-dark333 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tUnread messages\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t\t\t\t<ChatMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={mapKey}\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage={item || tempMessage}\n\t\t\t\t\t\t\t\t\t\t\t\t\tisSameFromUserWithPrev={isSameFromUserWithPrev}\n\t\t\t\t\t\t\t\t\t\t\t\t\tisSameFromUserWithNext={isSameFromUserWithNext}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<VizSensor\n\t\t\t\t\t\t\t\t\t\t\t\tkey={mapKey}\n\t\t\t\t\t\t\t\t\t\t\t\toffset={{ bottom: 50 }}\n\t\t\t\t\t\t\t\t\t\t\t\tscrollDelay={50}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(isVisible) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessageVisibleHandler(isVisible, item);\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<div>{content}</div>\n\t\t\t\t\t\t\t\t\t\t\t</VizSensor>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tcomponents={{\n\t\t\t\t\t\t\t\t\t\tScroller: VirtuosoScrollWrapper,\n\t\t\t\t\t\t\t\t\t\tItem: VirtuosoCustomItem,\n\t\t\t\t\t\t\t\t\t\tFooter: !isLastPageFetched ? VirtuosoFooter : undefined\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<ChatMessagesLoader />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{/*Messages end*/}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t}}\n\t\t</EntityContainer.All>\n\t);\n}\n\nexport function GroupMessagesList(props: Props) {\n\tconst resetKeys = useMemo(() => props.chatId, [props.chatId]);\n\n\tconst resetHandler = useCallback(() => {\n\t\twindow.location.reload();\n\t}, []);\n\n\treturn (\n\t\t<ErrorBoundary resetKeys={resetKeys as unknown as unknown[]} onResetHandler={resetHandler}>\n\t\t\t<GroupMessagesListInner {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import React, { useEffect, useState } from 'react';\nimport { ChatInputLayout } from 'shared/components/Chat/components';\nimport { useChatInputContext } from 'shared/contexts/ChatInputContext';\nimport { useChatMessage, useDraftMessage, useUpdateEntities } from 'shared/hooks';\nimport { useChatSocket } from 'shared/contexts/ChatSocketContext';\nimport { useChatContext } from 'shared/contexts/ChatContext';\nimport { nanoid } from 'nanoid';\n\nimport { useSelector } from 'react-redux';\nimport Selectors from 'modules/entity/selectors';\nimport { useAppState } from 'shared/state';\nimport { ErrorBoundary } from 'shared/components';\n\nconst getOne = Selectors.getOne();\n\ntype Props = {\n\tisAllowedSendMsg: boolean | undefined;\n};\n\nexport function GroupChatInputControlsInner({ isAllowedSendMsg }: Props) {\n\tconst {\n\t\tsetMessage,\n\t\treply,\n\t\tsetReply,\n\t\teditingMessage,\n\t\tisDelayedMessage,\n\t\tsetIsDelayedMessage,\n\t\tmessage\n\t} = useChatInputContext();\n\tconst { entityId, entityType, isLastPageFetched } = useChatContext();\n\tconst { sendJsonMessage } = useChatSocket();\n\tconst { sendChatMessage } = useChatMessage({\n\t\tsendJsonMessage,\n\t\tentityId,\n\t\tentityType\n\t});\n\tconst { updateEntities } = useUpdateEntities();\n\tconst { setActiveDraft, activeDraft } = useAppState();\n\tconst { removeLS, updateEntityDraft, getLS } = useDraftMessage();\n\tconst [tempMessageEvent, setTempMessageEvent] = useState<\n\t\tReact.FormEvent<HTMLFormElement> | React.KeyboardEvent<HTMLTextAreaElement> | null\n\t>(null);\n\tconst draftObject = getLS();\n\n\tconst caseChatEntity = useSelector((state) =>\n\t\tgetOne(state, {\n\t\t\tid: entityId,\n\t\t\tentity: entityType === 'case' ? 'cases' : 'ims-chats',\n\t\t\tname: `${entityType === 'case' ? 'CaseChat' : 'GroupChat'}-${entityId}One`\n\t\t})\n\t);\n\n\tconst onSubmit = (\n\t\te: React.FormEvent<HTMLFormElement> | React.KeyboardEvent<HTMLTextAreaElement>\n\t) => {\n\t\te?.preventDefault();\n\t\tif (tempMessageEvent) setTempMessageEvent(null);\n\t\t// if (!!caseChatEntity.item?.draft_message || entityId in draftObject) {\n\t\tif (activeDraft || entityId in draftObject) {\n\t\t\tupdateEntityDraft('reset');\n\t\t\tsetActiveDraft(null);\n\t\t\tremoveLS(entityId);\n\t\t}\n\t\t//Update pinned message if we edit pinned message\n\t\tif (editingMessage && editingMessage?.id === caseChatEntity?.item.pinned_message?.id) {\n\t\t\tupdateEntities({\n\t\t\t\tentity: 'ims-chats',\n\t\t\t\tentityId: entityId,\n\t\t\t\tupdatingData: {\n\t\t\t\t\tpinned_message: { ...caseChatEntity?.item?.pinned_message, text: message }\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tsendChatMessage({\n\t\t\ttype: 'text',\n\t\t\treplied_to_id: reply ? reply.id : null,\n\t\t\treplied_to: null,\n\t\t\tmsgSendingChatId: entityId,\n\t\t\tuuid: nanoid(),\n\t\t\tedited: !!editingMessage,\n\t\t\tis_draft: !!caseChatEntity.item?.draft_message\n\t\t});\n\t\tsetMessage('');\n\n\t\tif (reply) setReply(null);\n\t};\n\n\t//Sending message when not all initial pages have been loaded\n\tuseEffect(() => {\n\t\tif (!isDelayedMessage && tempMessageEvent) {\n\t\t\t//send delayed message when page 1 messages has been loaded\n\t\t\tonSubmit(tempMessageEvent);\n\t\t}\n\t}, [isDelayedMessage]);\n\n\tconst handleSubmit = (\n\t\te: React.FormEvent<HTMLFormElement> | React.KeyboardEvent<HTMLTextAreaElement>\n\t) => {\n\t\tif (!isLastPageFetched && !editingMessage) {\n\t\t\t//if we are  in the above through scrolling to upper\n\t\t\t// pages, we must load page 1 message before sending message\n\t\t\tsetIsDelayedMessage(true);\n\t\t\tsetTempMessageEvent(e);\n\t\t\treturn;\n\t\t}\n\t\tonSubmit(e);\n\t};\n\n\treturn (\n\t\t<ChatInputLayout\n\t\t\tonFormSubmit={handleSubmit}\n\t\t\tisAllowedSendMsg={isAllowedSendMsg}\n\t\t\tisGroup={true}\n\t\t/>\n\t);\n}\n\nexport function GroupChatInputControls(props: Props) {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<GroupChatInputControlsInner {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import React from 'react';\nimport { SwitchComp } from '../../../shared/components/Elements/Fields';\n\ntype Props = {\n\ttext: string;\n\tComponent: any;\n\ticonProp: any;\n\tfield_name: string;\n\thandleChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\n\tproperty: any;\n};\n\nexport function PermissionItem({\n\ttext,\n\tComponent,\n\ticonProp,\n\tfield_name,\n\thandleChange,\n\tproperty\n}: Props) {\n\treturn (\n\t\t<div className=\"permissions__item mb-4 \">\n\t\t\t<div className=\"permission flex items-center rounded-xl bg-white p-3 shadow-lg dark:bg-kdark-dark333\">\n\t\t\t\t<div className=\"icon flex-centered h-10 w-10 rounded-lg bg-primary\">\n\t\t\t\t\t<div className=\"text-white\">{<Component {...iconProp} />}</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"ml-4 text-sm\">{text}</div>\n\t\t\t\t<div className={'ml-auto'}>\n\t\t\t\t\t<SwitchComp\n\t\t\t\t\t\thandleChange={(e) => handleChange(e)}\n\t\t\t\t\t\tdisabled={false}\n\t\t\t\t\t\tname={field_name}\n\t\t\t\t\t\tchecked={property[field_name]}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React from 'react';\n\ntype Props = {\n\thandler: () => void;\n\tIcon: React.ElementType;\n\ttext: string;\n};\n\nexport function ChatPermissionMenuItem({ handler, Icon, text }: Props) {\n\treturn (\n\t\t<div\n\t\t\tclassName=\"permissions__leave flex cursor-pointer items-center pl-2 font-semibold transition hover:text-primary\"\n\t\t\tonClick={handler}\n\t\t>\n\t\t\t<div className=\"icon flex-centered h-10  w-10\">\n\t\t\t\t<Icon />\n\t\t\t</div>\n\t\t\t<div className=\"ml-2 text-sm\">{text}</div>\n\t\t</div>\n\t);\n}\n","import React from 'react';\nimport { GroupImage } from '../../../shared/interfaces';\nimport { GroupFormElements } from './GroupFormElements';\nimport EntityForm from '../../../modules/entity/forms';\nimport { useAppState } from '../../../shared/state';\n\ntype Props = {\n\tonSuccess: () => void;\n\ttitle: string;\n\tdescription: string;\n\timage: null | GroupImage;\n\tid: number;\n};\n\nexport function EditGroupForm({ onSuccess, title, description, image, id }: Props) {\n\tconst { groupSearchQuery, companyId } = useAppState();\n\n\treturn (\n\t\t<>\n\t\t\t<EntityForm.Main\n\t\t\t\tentity={'ims-chats'}\n\t\t\t\tname={`AllImsChats-${companyId}-${groupSearchQuery}`}\n\t\t\t\turl={`/${companyId}/ims/groups/${id}/`}\n\t\t\t\tid={id}\n\t\t\t\tmethod=\"put\"\n\t\t\t\tprimaryKey=\"id\"\n\t\t\t\tsendAsFormData={false}\n\t\t\t\tnormalizeData={(data: any) => data}\n\t\t\t\tprependData\n\t\t\t\tfields={[\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'title',\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tvalue: title,\n\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'description',\n\t\t\t\t\t\tvalue: description,\n\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'image',\n\t\t\t\t\t\tonSubmitKey: '',\n\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\tvalue: image\n\t\t\t\t\t}\n\t\t\t\t]}\n\t\t\t\tonSuccess={(response, resetForm): any => {\n\t\t\t\t\tonSuccess();\n\t\t\t\t\tresetForm();\n\t\t\t\t}}\n\t\t\t\tonError={(error, resetForm): any => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{({ isSubmitting, values, setFieldValue }) => {\n\t\t\t\t\tif (process.env.NODE_ENV === 'development') {\n\t\t\t\t\t\tconsole.log('group edit values', values);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<GroupFormElements\n\t\t\t\t\t\t\tonSuccess={onSuccess}\n\t\t\t\t\t\t\tisSubmitting={isSubmitting}\n\t\t\t\t\t\t\tsetFieldValue={setFieldValue}\n\t\t\t\t\t\t\tvalues={values}\n\t\t\t\t\t\t\tisEditing\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t</EntityForm.Main>\n\t\t</>\n\t);\n}\n","import React from 'react';\nimport { GroupImage } from 'shared/interfaces';\nimport { useGroupRequest } from '../hooks/useGroupRequest';\nimport { ConfirmModal, ErrorBoundary } from 'shared/components';\nimport { GoMute, GoUnmute } from 'react-icons/go';\nimport { IoExitOutline } from 'react-icons/io5';\nimport { PermissionItem } from './PermissionItem';\nimport { ChatPermissionMenuItem } from './ChatPermissionMenuItem';\nimport { MdOutlineDelete } from 'react-icons/md';\nimport { FiEdit } from 'react-icons/fi';\nimport { useWhiteModal } from '../../../shared/hooks';\nimport { EditGroupForm } from './EditGroupForm';\nimport { useAppState } from '../../../shared/state';\n\ntype Props = {\n\ttitle: string;\n\timage: null | GroupImage;\n\tmembersCount: number;\n\tisMuted: boolean | undefined;\n\tchatId: number;\n\t// handleMute: (chatId: number, changingData: { [key: string]: any }) => void;\n\tmemberId: number | undefined;\n\tisOwner: boolean;\n};\n\nfunction PermissionsInner({\n\ttitle,\n\timage,\n\tmembersCount,\n\tisMuted,\n\tchatId,\n\tmemberId,\n\tisOwner\n}: Props) {\n\tconst {\n\t\tleaveGroupChat,\n\t\tpermissions,\n\t\thandlePropertyChange,\n\t\tproperty,\n\t\thandlerSwitchMute,\n\t\tcanLeaveChat,\n\t\tcanDeleteChat,\n\t\tdeleteVisible,\n\t\tdeleteLoading,\n\t\ttoggleDeleteVisible,\n\t\tdeleteGroupChat,\n\t\texitLoading,\n\t\topen,\n\t\tsetExitOpen,\n\t\timsData,\n\t\tcurrentUserProperty\n\t} = useGroupRequest({\n\t\tchatId,\n\t\tisMuted,\n\t\tmemberId\n\t});\n\n\tconst { isAdmin } = useAppState();\n\n\tconst { open: openEditModal, modalHandler, WhiteModal } = useWhiteModal();\n\treturn (\n\t\t<div className=\"w-72 \">\n\t\t\t<div className=\"permissions font-poppins\">\n\t\t\t\t<div className=\"permissions__top\">\n\t\t\t\t\t<div className=\"permission__header flex rounded-lg bg-primary p-2 text-white  shadow-lg\">\n\t\t\t\t\t\t<div className=\"permissions__img flex-centered mr-2 h-14 w-14 flex-shrink-0 overflow-hidden rounded-md bg-white text-primary-dark\">\n\t\t\t\t\t\t\t{image ? <img src={image.thumbnail_150} alt={title} /> : title?.[0].toUpperCase()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"permissions__header-text flex-grow \">\n\t\t\t\t\t\t\t<div className=\"flex-center-between text-base\">\n\t\t\t\t\t\t\t\t<span>{title}</span>\n\t\t\t\t\t\t\t\t{isAdmin || isOwner || currentUserProperty?.is_allowed_edit_info ? (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName=\"cursor-pointer transition hover:text-primary-dark\"\n\t\t\t\t\t\t\t\t\t\tonClick={modalHandler}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<FiEdit />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t) : null}\n\n\t\t\t\t\t\t\t\t<WhiteModal handleModalOpen={modalHandler} open={openEditModal}>\n\t\t\t\t\t\t\t\t\t<EditGroupForm\n\t\t\t\t\t\t\t\t\t\tonSuccess={modalHandler}\n\t\t\t\t\t\t\t\t\t\ttitle={imsData.title}\n\t\t\t\t\t\t\t\t\t\tdescription={imsData.description}\n\t\t\t\t\t\t\t\t\t\timage={imsData.image}\n\t\t\t\t\t\t\t\t\t\tid={imsData.id}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</WhiteModal>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"text-sm\">{`${membersCount} members`}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"permissions__content mt-4\">\n\t\t\t\t\t{/*Permission with Switch component*/}\n\t\t\t\t\t{permissions.map((permission) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<React.Fragment key={permission.text}>\n\t\t\t\t\t\t\t\t{permission.show ? (\n\t\t\t\t\t\t\t\t\t<PermissionItem\n\t\t\t\t\t\t\t\t\t\tkey={permission.text}\n\t\t\t\t\t\t\t\t\t\ttext={permission.text}\n\t\t\t\t\t\t\t\t\t\tComponent={permission.Component}\n\t\t\t\t\t\t\t\t\t\ticonProp={permission.iconProp}\n\t\t\t\t\t\t\t\t\t\tfield_name={permission.field_name}\n\t\t\t\t\t\t\t\t\t\thandleChange={handlePropertyChange}\n\t\t\t\t\t\t\t\t\t\tproperty={property}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\n\t\t\t\t\t{/*Mute Notifications*/}\n\t\t\t\t\t<ChatPermissionMenuItem\n\t\t\t\t\t\ttext={isMuted ? 'Unmute notifications' : 'Mute notifications'}\n\t\t\t\t\t\thandler={() => handlerSwitchMute(isMuted as boolean)}\n\t\t\t\t\t\tIcon={isMuted ? GoMute : GoUnmute}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{/*Delete Chat Notifications*/}\n\t\t\t\t\t{canDeleteChat ? (\n\t\t\t\t\t\t<ChatPermissionMenuItem\n\t\t\t\t\t\t\ttext=\"Delete Group\"\n\t\t\t\t\t\t\thandler={toggleDeleteVisible}\n\t\t\t\t\t\t\tIcon={MdOutlineDelete}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : null}\n\n\t\t\t\t\t{/*Exit Group Chat*/}\n\t\t\t\t\t{canLeaveChat ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<ChatPermissionMenuItem\n\t\t\t\t\t\t\t\ttext=\"Leave group\"\n\t\t\t\t\t\t\t\thandler={() => setExitOpen(true)}\n\t\t\t\t\t\t\t\tIcon={IoExitOutline}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : null}\n\t\t\t\t\t<ConfirmModal\n\t\t\t\t\t\tfeatureHandler={leaveGroupChat}\n\t\t\t\t\t\tisOpen={Boolean(open)}\n\t\t\t\t\t\ttoggleHandler={() => setExitOpen((prev) => !prev)}\n\t\t\t\t\t\ttitle={`Are you sure to exit ${title} group`}\n\t\t\t\t\t\thasLoader\n\t\t\t\t\t\tisLoading={exitLoading}\n\t\t\t\t\t/>\n\t\t\t\t\t<ConfirmModal\n\t\t\t\t\t\tfeatureHandler={deleteGroupChat}\n\t\t\t\t\t\tisOpen={Boolean(deleteVisible)}\n\t\t\t\t\t\ttoggleHandler={toggleDeleteVisible}\n\t\t\t\t\t\ttitle={`Are you sure to delete  ${title} group`}\n\t\t\t\t\t\thasLoader\n\t\t\t\t\t\tisLoading={deleteLoading}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport function Permissions(props: Props) {\n\treturn (\n\t\t<ErrorBoundary isCompact>\n\t\t\t<PermissionsInner {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import { useAxios, useGetEntityOne, useQueryParams, useUpdateEntities } from 'shared/hooks';\nimport { useAppState } from 'shared/state';\nimport { useEntityForm } from 'modules/entity/hooks/useEntityForm';\nimport { Dispatch, SetStateAction, useCallback, useEffect, useRef, useState } from 'react';\nimport { BiMessageSquareDetail } from 'react-icons/bi';\nimport { CgAdd } from 'react-icons/cg';\nimport { MdOutlineRemoveCircleOutline } from 'react-icons/md';\nimport { AiOutlineEdit, AiOutlinePushpin } from 'react-icons/ai';\nimport { IoExitOutline } from 'react-icons/io5';\nimport get from 'lodash/get';\nimport { ChatMember } from '../types';\nimport { useAuth } from '../../../modules/auth/hooks/useAuth';\nimport { GroupMember, IGroupChat } from '../../../shared/interfaces';\n\ntype GroupRequests = {\n\tchatId: number;\n\tisMuted?: boolean | undefined;\n\tmemberId?: number | undefined;\n\tmutingCallback?: (chatId: number, data: { [key: string]: any }) => void;\n\tsetExitLoading?: Dispatch<SetStateAction<boolean>>;\n\tsetExitOpen?: Dispatch<SetStateAction<boolean>>;\n};\n\nexport function useGroupRequest({ chatId, isMuted, memberId }: GroupRequests) {\n\tconst { companyId, groupSearchQuery, isAdmin } = useAppState();\n\tconst { userData } = useAuth();\n\tconst { removeQueryParams, query } = useQueryParams();\n\n\tconst [exitLoading, setExitLoading] = useState(false);\n\tconst [open, setExitOpen] = useState(false);\n\n\tconst [deleteVisible, setDeleteVisible] = useState(false);\n\tconst [deleteLoading, setDeleteLoading] = useState(false);\n\n\tconst toggleDeleteVisible = () => setDeleteVisible((prev) => !prev);\n\tconst toggleDeleteLoading = () => setDeleteLoading((prev) => !prev);\n\n\tconst propertyRef = useRef<null | IGroupChat>(null);\n\n\tconst { updateEntities } = useUpdateEntities();\n\n\tconst entityId = query?.searchedMessageId ? query?.searchedMessageId : chatId;\n\n\tconst chatEntity = useGetEntityOne({\n\t\tentity: 'ims-chats',\n\t\tentityId: chatId,\n\t\tentityName: `GroupChat-${entityId}One`\n\t});\n\n\tuseEffect(() => {\n\t\tpropertyRef.current = chatEntity.item.property;\n\t}, [chatEntity.item.property]);\n\n\tconst owner = (get(chatEntity, 'item.members', []) as ChatMember[]).find(\n\t\t(member) => member.role === 'OWNER'\n\t);\n\tconst currentMember = (get(chatEntity, 'item.members', []) as ChatMember[]).find(\n\t\t(member) => member.user.id === userData.id\n\t);\n\t// const isAllowedExitGroup = currentMember?.is_allowed_exit_group;\n\tconst isOwner = owner?.user.id === userData.id;\n\n\tlet canLeaveChat = true;\n\tif (isOwner || isAdmin || !currentMember?.is_allowed_exit_group) canLeaveChat = false;\n\n\tlet canDeleteChat = false;\n\tif (isAdmin || isOwner || currentMember?.is_allowed_delete_group) canDeleteChat = true;\n\n\t//Update Permission accept muted and delete chat\n\tconst { fetchData: updatePermission } = useAxios({\n\t\turl: `/${companyId}/ims/groups/${chatId}/`,\n\t\tdynamicValues: true,\n\t\tmethod: 'put',\n\t\tcb: {\n\t\t\tsuccess: (data, args) => {},\n\t\t\terror: (error, args) => {\n\t\t\t\tsetPropertyHandler(args[0]?.fieldName, !args[0]?.checked);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst handleMute = useCallback(\n\t\t(chatId, changingData) => {\n\t\t\tupdateEntities({\n\t\t\t\tentity: 'ims-chats',\n\t\t\t\tentityId: chatId,\n\t\t\t\tupdatingData: {\n\t\t\t\t\tmembers: [\n\t\t\t\t\t\t...chatEntity?.item?.members.filter(\n\t\t\t\t\t\t\t(member: GroupMember) => member.user.id !== userData.id\n\t\t\t\t\t\t),\n\t\t\t\t\t\t{ ...currentMember, ...changingData }\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t[chatEntity?.item]\n\t);\n\n\tconst setPropertyHandler = (fieldName: string, checked: boolean) => {\n\t\tconst chatProperty = { ...propertyRef.current } || {};\n\n\t\tupdateEntities({\n\t\t\tentity: 'ims-chats',\n\t\t\tentityId: chatId,\n\t\t\tupdatingData: {\n\t\t\t\tproperty: {\n\t\t\t\t\t...chatProperty,\n\t\t\t\t\t[fieldName]: checked\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\tconst handlePropertyChange = useCallback(\n\t\tasync (event: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tconst name = event.target.name;\n\t\t\tconst checked = event.target.checked;\n\n\t\t\tsetPropertyHandler(name, checked);\n\n\t\t\t//Send api request to change Permission\n\t\t\tawait updatePermission({ values: { [name]: checked }, fieldName: name, checked });\n\t\t},\n\t\t[chatEntity.item.property]\n\t);\n\n\t//mute/unmute notifications\n\tconst { fetchData: handleChatMute } = useAxios({\n\t\turl: `/${companyId}/ims/groups/${chatId}/`,\n\t\tmethod: 'put',\n\t\tvalues: {\n\t\t\tis_mute: !isMuted\n\t\t},\n\t\tcb: {\n\t\t\tsuccess: (data, args) => {},\n\t\t\terror: (error, args) => {\n\t\t\t\thandleMute?.(chatId, { is_mute: isMuted });\n\t\t\t}\n\t\t}\n\t});\n\n\tconst { handleLocalDelete } = useEntityForm({\n\t\tentity: 'ims-chats',\n\t\tname: `AllImsChats-${companyId}-`,\n\t\tdeleteData: true,\n\t\tid: chatId,\n\t\turl: '',\n\t\tmethod: 'delete',\n\t\tcb: {\n\t\t\tsuccess: (data) => {},\n\t\t\terror: (errors) => {},\n\t\t\tfinally: () => {}\n\t\t}\n\t});\n\n\tconst { handleRequest: handleExitRequest } = useEntityForm({\n\t\tentity: 'ims-chats',\n\t\tname: `AllImsChats-${companyId}-${groupSearchQuery}`,\n\t\tmethod: open ? 'patch' : 'delete',\n\t\turl: open\n\t\t\t? `/${companyId}/ims/groups/${chatId}/members/${memberId}/leave/`\n\t\t\t: `/${companyId}/ims/groups/${chatId}/`,\n\t\tdeleteData: true,\n\t\tid: Number(entityId) as string | number | undefined,\n\t\tcb: {\n\t\t\tsuccess: (data) => {\n\t\t\t\tsetExitLoading?.(false); //stop loading spinner\n\t\t\t\tsetExitOpen?.(false); // close modal\n\n\t\t\t\tdeleteLoading && toggleDeleteLoading();\n\t\t\t\tdeleteVisible && toggleDeleteVisible();\n\n\t\t\t\tremoveQueryParams(); // close open chat\n\n\t\t\t\tif (groupSearchQuery) {\n\t\t\t\t\t//Because search mode has different entity name in\n\t\t\t\t\t// redux state we must remove chat from not search mode entity too.\n\t\t\t\t\t//Or it will remain in chat list when we clear search query from input\n\t\t\t\t\thandleLocalDelete();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: (error) => {\n\t\t\t\tsetExitLoading?.(false);\n\t\t\t\ttoggleDeleteLoading();\n\t\t\t},\n\t\t\tfinally: () => {}\n\t\t}\n\t});\n\n\tconst deleteGroupChat = () => {\n\t\ttoggleDeleteLoading();\n\t\thandleExitRequest();\n\t};\n\n\tconst leaveGroupChat = () => {\n\t\tsetExitLoading?.(true);\n\t\thandleExitRequest();\n\t};\n\n\tconst localDelete = () => {\n\t\thandleLocalDelete();\n\t\tsetExitOpen?.(false);\n\t\tremoveQueryParams();\n\t};\n\n\tconst handlerSwitchMute = (isMuting: boolean) => {\n\t\t//Optimistic update of state\n\t\thandleMute(chatId, { is_mute: !isMuting });\n\n\t\t//CallAsync request\n\t\thandleChatMute(isMuting);\n\t};\n\n\tconst permissions = [\n\t\t{\n\t\t\tComponent: BiMessageSquareDetail,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Send Messages',\n\t\t\tfield_name: 'is_allowed_send_msg',\n\t\t\tshow: isAdmin || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: CgAdd,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Add Users',\n\t\t\tfield_name: 'is_allowed_add_user',\n\t\t\tshow: isAdmin || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: MdOutlineRemoveCircleOutline,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Remove users',\n\t\t\tfield_name: 'is_allowed_remove_user',\n\t\t\tshow: isAdmin || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: AiOutlinePushpin,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Pin Messages',\n\t\t\tfield_name: 'is_allowed_pin_msg',\n\t\t\tshow: isAdmin || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: AiOutlineEdit,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: { width: 11, height: 11 },\n\t\t\ttext: 'Edit Group Info',\n\t\t\tfield_name: 'is_allowed_edit_info',\n\t\t\tshow: isAdmin || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: IoExitOutline,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: { className: 'chat-icon-exit' },\n\t\t\ttext: 'Exit From Group',\n\t\t\tfield_name: 'is_allowed_exit_group',\n\t\t\tshow: isAdmin || isOwner\n\t\t}\n\t];\n\n\treturn {\n\t\tleaveGroupChat,\n\t\tlocalDelete,\n\t\tpermissions,\n\t\thandlePropertyChange,\n\t\tcurrentUserProperty:\n\t\t\tchatEntity?.item?.members.find((member: GroupMember) => member?.id === memberId) ?? {},\n\t\tproperty: chatEntity?.item?.property ?? {},\n\t\thandlerSwitchMute,\n\t\tcanLeaveChat,\n\t\tcanDeleteChat,\n\t\tdeleteVisible,\n\t\tdeleteLoading,\n\t\ttoggleDeleteVisible,\n\t\tdeleteGroupChat,\n\t\texitLoading,\n\t\topen,\n\t\tsetExitOpen,\n\t\timsData: chatEntity?.item\n\t};\n}\n","import React, { useState } from 'react';\nimport { Scrollbars } from 'react-custom-scrollbars-2';\nimport { useDebounce } from 'use-debounce';\nimport EntityContainer from 'modules/entity/containers';\nimport { useChatContext } from 'shared/contexts';\nimport { useAppState } from 'shared/state';\nimport { GroupMember } from 'shared/interfaces';\nimport { AvatarSized } from 'shared/components/Elements';\nimport { ErrorBoundary, LoadMoreVisible } from 'shared/components';\nimport ContentLoader from 'react-content-loader';\n\nexport function GroupChatMembersInner() {\n\tconst [query, setQuery] = useState('');\n\tconst [page, setPage] = useState(1);\n\tconst [searchQuery] = useDebounce(query, 300);\n\tconst { entityId } = useChatContext();\n\tconst { companyId } = useAppState();\n\treturn (\n\t\t<div className={'group-members'}>\n\t\t\t<h2 className={'mb-4 text-xl font-bold'}>Group chat members</h2>\n\t\t\t<div className=\"mb-4\">\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclassName={\n\t\t\t\t\t\t'inline-block w-full rounded-xl border p-2 outline-none hover:border-primary focus:border-primary dark:bg-kdark-lighter dark:text-white'\n\t\t\t\t\t}\n\t\t\t\t\tvalue={query}\n\t\t\t\t\tonChange={(e) => setQuery(e.target.value)}\n\t\t\t\t\tplaceholder={'Search members'}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"group-members__content h-48\">\n\t\t\t\t<Scrollbars autoHide style={{ height: '100%' }}>\n\t\t\t\t\t<EntityContainer.All\n\t\t\t\t\t\tentity={`group-members`}\n\t\t\t\t\t\tname={`GroupMembers-${entityId}`}\n\t\t\t\t\t\turl={`/${companyId}/ims/${entityId}/members_list/`}\n\t\t\t\t\t\tparams={{\n\t\t\t\t\t\t\textra: {\n\t\t\t\t\t\t\t\tsearch: searchQuery\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tpage,\n\t\t\t\t\t\t\tlimit: 10\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tappendData\n\t\t\t\t\t>\n\t\t\t\t\t\t{({ items, isFetched, meta }) => {\n\t\t\t\t\t\t\tconst members = [...items] as GroupMember[];\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{members.map((item) => {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"msg-info__content-user mb-3 flex items-center\" key={item.id}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"avatar mr-3 flex-shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<AvatarSized\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize={36}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsmallSize={36}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={''}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletter={`${item.user.first_name[0]}${item.user.last_name[0]}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={`${item.user.first_name} ${item.user.last_name}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titem.user.avatar?.thumbnail_150 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titem.user.avatar?.thumbnail ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titem.user.avatar?.url\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// color={item.user.color}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"msg-info__user-content\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"msg-info__user-name mb-1 text-sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{`${item.user.first_name} ${item.user.last_name}`}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{item.role === 'OWNER' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"italic text-kgrey\"> Group owner</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t{!isFetched\n\t\t\t\t\t\t\t\t\t\t? [...Array(6)].map((item, index) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={'mb-2'} key={index}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<MembersSkeleton />\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t  ))\n\t\t\t\t\t\t\t\t\t\t: null}\n\t\t\t\t\t\t\t\t\t{isFetched &&\n\t\t\t\t\t\t\t\t\tmeta?.current_page &&\n\t\t\t\t\t\t\t\t\tmeta?.last_page &&\n\t\t\t\t\t\t\t\t\tmeta?.current_page < meta?.last_page ? (\n\t\t\t\t\t\t\t\t\t\t<LoadMoreVisible setPage={() => setPage((prev) => prev + 1)} />\n\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t\t</EntityContainer.All>\n\t\t\t\t</Scrollbars>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport function GroupChatMembers() {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<GroupChatMembersInner />\n\t\t</ErrorBoundary>\n\t);\n}\n\nfunction MembersSkeleton() {\n\treturn (\n\t\t<ContentLoader\n\t\t\tspeed={2}\n\t\t\twidth={369}\n\t\t\theight={40}\n\t\t\tviewBox=\"0 0 369 40\"\n\t\t\tbackgroundColor=\"#f3f3f3\"\n\t\t\tforegroundColor=\"#ecebeb\"\n\t\t>\n\t\t\t<circle cx=\"75\" cy=\"125\" r=\"27\" />\n\t\t\t<circle cx=\"30\" cy=\"20\" r=\"20\" />\n\t\t\t<rect x=\"55\" y=\"10\" rx=\"4\" ry=\"4\" width=\"69\" height=\"18\" />\n\t\t\t<rect x=\"131\" y=\"10\" rx=\"4\" ry=\"4\" width=\"151\" height=\"18\" />\n\t\t</ContentLoader>\n\t);\n}\n","import { useAppState } from '../../../shared/state';\n\nexport function useGroupMessageSearch() {\n\tconst { setGroupSearchOpen, groupSearchOpen } = useAppState();\n\tconst handleSearchBtnClick = () => {\n\t\tconsole.log('clicked');\n\t};\n\n\tconst toggleSearchSidebar = () => setGroupSearchOpen(!groupSearchOpen);\n\n\treturn { handleSearchBtnClick, toggleSearchSidebar };\n}\n","import React from 'react';\nimport Avatar from '@material-ui/core/Avatar';\nimport { deepPurple } from '@material-ui/core/colors';\nimport { makeStyles } from '@material-ui/core/styles';\nimport get from 'lodash/get';\nimport classnames from 'classnames';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport IconButton from '@material-ui/core/IconButton';\nimport CheckCircleOutlineIcon from '@material-ui/icons/CheckCircleOutline';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport EditIcon from '@material-ui/icons/Edit';\n\nconst useStyles = makeStyles((theme) => ({\n\troot: {\n\t\tdisplay: 'flex',\n\t\t'& > *': {\n\t\t\tmargin: theme.spacing(1)\n\t\t}\n\t},\n\tpurple: {\n\t\tcolor: theme.palette.getContrastText(deepPurple[500]),\n\t\tbackgroundColor: deepPurple[500]\n\t}\n}));\n\ntype Props = {\n\tmember: any;\n\tareAddedMembers?: boolean;\n\tonClickHandler?: (id: any, member: any) => void;\n\tselectedMembers?: any;\n\tisAddingMember?: boolean;\n\tisOwner?: boolean;\n\tisAdminManager?: boolean;\n\tshowChatEditSettingModal?: (member: any) => void;\n\tsetOpen?: any;\n\tcurrentMember?: any;\n};\n\nconst ChatMember = ({\n\tmember,\n\tareAddedMembers,\n\tonClickHandler = () => {},\n\tselectedMembers = [],\n\tisAddingMember = false,\n\tisOwner = false,\n\tisAdminManager,\n\tshowChatEditSettingModal = () => {},\n\tsetOpen,\n\tcurrentMember\n}: Props) => {\n\tconst classes = useStyles();\n\tconst firstName = isAddingMember ? member.first_name : get(member, 'user.first_name');\n\tconst lastName = isAddingMember ? member.last_name : get(member, 'user.last_name');\n\tconst companyName = get(member, 'company.name');\n\tconst isIndividualClient = isAddingMember\n\t\t? companyName === member?.username\n\t\t: companyName === get(member, 'user.username');\n\tconst avatarSrc = isAddingMember\n\t\t? get(member, 'avatar.thumbnail_150')\n\t\t: get(member, 'user.avatar.thumbnail_150');\n\tconst FN = firstName[0]?.toUpperCase();\n\tconst LN = lastName[0]?.toUpperCase();\n\tconst name = `${firstName} ${lastName}`;\n\tconst userId = isAddingMember ? member.id : get(member, 'user.id');\n\tconst role = !isAddingMember ? member.role : null;\n\tconst isBusinessAdmin = !isAddingMember ? member?.is_admin : null;\n\tconst isStaff = member?.is_staff;\n\n\tconst isCurrentChatOwner = member.role === 'OWNER';\n\tconst isMemberSelected = selectedMembers.find(\n\t\t(selectedMember: any) =>\n\t\t\tselectedMember.id === userId && selectedMember.companyId === member?.company?.id\n\t);\n\tconst renderMemberType = () => {\n\t\tif (isStaff && isCurrentChatOwner) {\n\t\t\treturn '';\n\t\t} else {\n\t\t\treturn `${isStaff ? 'Staff' : 'Client'} | ${isIndividualClient ? 'Individual' : companyName}`;\n\t\t}\n\t};\n\n\treturn (\n\t\t<ListItem\n\t\t\t// @ts-ignore\n\t\t\tbutton={!areAddedMembers}\n\t\t\tonClick={() => onClickHandler(userId, member)}\n\t\t\tclassName={classnames('member-list-item', {\n\t\t\t\t'item-active': selectedMembers.includes(userId)\n\t\t\t})}\n\t\t>\n\t\t\t<ListItemAvatar>\n\t\t\t\t<Avatar alt={FN} src={avatarSrc} className={classes.purple}>\n\t\t\t\t\t{`${FN} ${LN}`}\n\t\t\t\t</Avatar>\n\t\t\t</ListItemAvatar>\n\t\t\t{\n\t\t\t\t<ListItemText\n\t\t\t\t\tprimary={name}\n\t\t\t\t\tsecondary={`${isCurrentChatOwner ? 'GROUP OWNER' : ''} ${renderMemberType()}`}\n\t\t\t\t/>\n\t\t\t}\n\t\t\t{isMemberSelected && (\n\t\t\t\t<>\n\t\t\t\t\t<ListItemSecondaryAction>\n\t\t\t\t\t\t<IconButton edge=\"end\" aria-label=\"checked\">\n\t\t\t\t\t\t\t<CheckCircleOutlineIcon />\n\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t</ListItemSecondaryAction>\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{areAddedMembers && (isAdminManager || isOwner || currentMember.is_allowed_remove_user) && (\n\t\t\t\t<ListItemSecondaryAction>\n\t\t\t\t\t{(isAdminManager || isOwner) && (\n\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\tedge=\"end\"\n\t\t\t\t\t\t\taria-label=\"checked\"\n\t\t\t\t\t\t\tdisabled={role === 'OWNER' || isBusinessAdmin}\n\t\t\t\t\t\t\tonClick={() => showChatEditSettingModal(member)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<EditIcon />\n\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tedge=\"end\"\n\t\t\t\t\t\taria-label=\"checked\"\n\t\t\t\t\t\tdisabled={role === 'OWNER' /*|| isBusinessAdmin*/}\n\t\t\t\t\t\tonClick={() => setOpen(member)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DeleteIcon />\n\t\t\t\t\t</IconButton>\n\t\t\t\t</ListItemSecondaryAction>\n\t\t\t)}\n\t\t</ListItem>\n\t);\n};\n\nexport default ChatMember;\n","import React from 'react';\nimport Switch from '@material-ui/core/Switch';\n\ntype Props = {\n\tclassName: string;\n\thandler: any;\n\ttext: string;\n\tComponent: any;\n\ticonProp: any;\n\thasSwitch: boolean;\n\tfield_name: string;\n\thandleChange: any;\n\tproperty: any;\n\tisMuteSetting?: any;\n\tisMute?: boolean;\n};\n\nfunction ChatSettingItem({\n\tclassName,\n\thandler,\n\ttext,\n\tComponent,\n\ticonProp,\n\thasSwitch,\n\tfield_name,\n\thandleChange,\n\tproperty,\n\tisMuteSetting,\n\tisMute\n}: Props) {\n\tconst clickHandler = () => () =>\n\t\tisMuteSetting ? handleChange({ target: { checked: !isMute } }) : handler(true);\n\treturn (\n\t\t<div\n\t\t\tclassName={`chat-sett-toggler flex items-center dark:!bg-kdark-dark333 ${className}`}\n\t\t\tonClick={clickHandler()}\n\t\t>\n\t\t\t<div className=\"chat-sett-toggler__icon flex items-center justify-center text-white\">\n\t\t\t\t{<Component {...iconProp} />}\n\t\t\t</div>\n\t\t\t<div className=\"chat-sett-toggler__name\">{text}</div>\n\t\t\t{hasSwitch && !isMuteSetting && (\n\t\t\t\t<div className=\"chat-sett-toggler__switch\">\n\t\t\t\t\t<Switch\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\tedge=\"end\"\n\t\t\t\t\t\tname={field_name}\n\t\t\t\t\t\tchecked={property[field_name]}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\tinputProps={{ 'aria-labelledby': 'switch-list-label-group-admin' }}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\nexport default ChatSettingItem;\n","import React, { useState } from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { IconAdd, IconEdit, IconExit, IconMessage, IconRemove, IconPin } from 'shared/icons';\nimport ChatSettingItem from './ChatSettingItem';\nimport Actions from 'store/actions';\nimport { useLoadAll } from '../../../../shared/hooks';\nconst FormRequest = Actions.entity.formRequest;\n\ntype Props = {\n\tcompanyId: number | undefined;\n\tchatId: number;\n\tmember: any;\n\tisOwner: boolean;\n\tstaffMembersLength: number;\n\tisAdminManager: boolean;\n};\n\nconst MemberChatSettings = ({\n\tcompanyId,\n\tmember,\n\tchatId,\n\tisOwner,\n\tstaffMembersLength,\n\tisAdminManager\n}: Props) => {\n\tconst {\n\t\tis_allowed_send_msg,\n\t\tis_allowed_add_user,\n\t\tis_allowed_remove_user,\n\t\tis_allowed_pin_msg,\n\t\tis_allowed_edit_info,\n\t\tis_allowed_delete_group,\n\t\tis_allowed_exit_group,\n\t\tis_mute\n\t} = member && member;\n\tconst [property, setProperty] = useState({\n\t\tis_allowed_send_msg,\n\t\tis_allowed_add_user,\n\t\tis_allowed_remove_user,\n\t\tis_allowed_pin_msg,\n\t\tis_allowed_edit_info,\n\t\tis_allowed_delete_group,\n\t\tis_allowed_exit_group,\n\t\tis_mute\n\t});\n\n\tconst { id: memberId } = member;\n\tconst { reloadEntityAll } = useLoadAll();\n\n\tconst dispatch = useDispatch();\n\n\tconst handlePropertyChange = (event: any) => {\n\t\tconst name = event.target.name;\n\t\tconst checked = event.target.checked;\n\t\tconst prevProperty = { ...property };\n\t\tsetProperty((prev) => ({ ...prev, [name]: checked }));\n\t\tconst payload = { [name]: checked };\n\t\tdispatch(\n\t\t\tFormRequest({\n\t\t\t\tid: member?.id,\n\t\t\t\tentity: 'chatmembers',\n\t\t\t\tname: `Allchatmembers-${chatId}-${staffMembersLength}`,\n\t\t\t\turl: `/${companyId}/ims/groups/${chatId}/members/${memberId}/`,\n\t\t\t\tmethod: 'patch',\n\t\t\t\tparams: {},\n\t\t\t\tupdateData: true,\n\t\t\t\tvalues: payload,\n\t\t\t\tnormalizeData: (data: any) => data,\n\t\t\t\tcb: {\n\t\t\t\t\tsuccess: (data: any) => {\n\t\t\t\t\t\treloadEntityAll({\n\t\t\t\t\t\t\turl: `/${companyId}/ims/${chatId}/members_list/`,\n\t\t\t\t\t\t\tentity: 'userCompanies',\n\t\t\t\t\t\t\tname: `Allchatmembers-${chatId}-${staffMembersLength}`,\n\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\tpage: 1,\n\t\t\t\t\t\t\t\tlimit: 10\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\terror: (error: Error) => {\n\t\t\t\t\t\tsetProperty(prevProperty);\n\t\t\t\t\t},\n\t\t\t\t\tfinally: () => {}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t};\n\n\tconst permissions = [\n\t\t{\n\t\t\tComponent: IconMessage,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Send Messages',\n\t\t\tfield_name: 'is_allowed_send_msg',\n\t\t\tclassName: '',\n\t\t\thandler: () => {},\n\t\t\thasSwitch: true,\n\t\t\tshow: isAdminManager || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: IconAdd,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Add Users',\n\t\t\tfield_name: 'is_allowed_add_user',\n\t\t\tclassName: '',\n\t\t\thandler: () => {},\n\t\t\thasSwitch: true,\n\t\t\tshow: isAdminManager || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: IconRemove,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Remove users',\n\t\t\tfield_name: 'is_allowed_remove_user',\n\t\t\tclassName: '',\n\t\t\thandler: () => {},\n\t\t\thasSwitch: true,\n\t\t\tshow: isAdminManager || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: IconPin,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: {},\n\t\t\ttext: 'Pin Messages',\n\t\t\tfield_name: 'is_allowed_pin_msg',\n\t\t\tclassName: '',\n\t\t\thandler: () => {},\n\t\t\thasSwitch: true,\n\t\t\tshow: isAdminManager || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: IconEdit,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: { width: 11, height: 11 },\n\t\t\ttext: 'Edit Group Info',\n\t\t\tfield_name: 'is_allowed_edit_info',\n\t\t\tclassName: '',\n\t\t\thandler: () => {},\n\t\t\thasSwitch: true,\n\t\t\tshow: isAdminManager || isOwner\n\t\t},\n\t\t{\n\t\t\tComponent: IconExit,\n\t\t\thandleChange: handlePropertyChange,\n\t\t\ticonProp: { className: 'chat-icon-exit' },\n\t\t\ttext: 'Exit From Group',\n\t\t\tfield_name: 'is_allowed_exit_group',\n\t\t\tclassName: 'white-icon',\n\t\t\thandler: () => {},\n\t\t\thasSwitch: true,\n\t\t\tshow: isAdminManager || isOwner\n\t\t}\n\t];\n\n\treturn (\n\t\t<div className=\"chat-settings__inner\">\n\t\t\t<div className=\"chat-settings__content\">\n\t\t\t\t<div className=\"chat-settings__title mb-4 font-bold\">Individual Permissions</div>\n\t\t\t\t<div className=\"chat-settings__l\">\n\t\t\t\t\t{permissions.map((setting) => {\n\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t\thandler,\n\t\t\t\t\t\t\ttext,\n\t\t\t\t\t\t\thasSwitch,\n\t\t\t\t\t\t\tfield_name,\n\t\t\t\t\t\t\tComponent,\n\t\t\t\t\t\t\ticonProp,\n\t\t\t\t\t\t\tshow,\n\t\t\t\t\t\t\thandleChange\n\t\t\t\t\t\t} = setting;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tshow && (\n\t\t\t\t\t\t\t\t<div className=\"chat-settings__i\" key={field_name}>\n\t\t\t\t\t\t\t\t\t<ChatSettingItem\n\t\t\t\t\t\t\t\t\t\tclassName={className}\n\t\t\t\t\t\t\t\t\t\thandler={handler}\n\t\t\t\t\t\t\t\t\t\ttext={text}\n\t\t\t\t\t\t\t\t\t\tComponent={Component}\n\t\t\t\t\t\t\t\t\t\ticonProp={iconProp}\n\t\t\t\t\t\t\t\t\t\thasSwitch={hasSwitch}\n\t\t\t\t\t\t\t\t\t\tfield_name={field_name}\n\t\t\t\t\t\t\t\t\t\thandleChange={handleChange}\n\t\t\t\t\t\t\t\t\t\tproperty={property}\n\t\t\t\t\t\t\t\t\t\tisMuteSetting={false}\n\t\t\t\t\t\t\t\t\t\tisMute={false}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default MemberChatSettings;\n","import React, { useState } from 'react';\nimport EntityContainer from 'modules/entity/containers';\nimport { Scrollbars } from 'react-custom-scrollbars-2';\nimport { ConfirmModal, LoadMoreVisible } from 'shared/components';\nimport { ErrorBoundary, Loader } from 'shared/components';\nimport ChatMember from './ChatMember';\nimport List from '@material-ui/core/List';\nimport TextField from '@material-ui/core/TextField';\nimport { useDebounce } from 'use-debounce';\nimport MemberChatSettings from './MemberChatSettings';\nimport { useDispatch } from 'react-redux';\nimport { useAppState } from '../../../../shared/state';\nimport Actions from 'store/actions';\nimport { useChatContext } from '../../../../shared/contexts';\nimport { WhiteModal } from '../../../../shared/components/Elements';\nimport { useNotistack } from '../../../../shared/hooks';\nimport { loadOneRequest } from '../../../../modules/entity/actions';\nconst { formRequest } = Actions.entity;\n\nconst MembersList = (props: any) => {\n\tconst [page, setPage] = useState(1);\n\tconst [query, setQuery] = useState('');\n\tconst [searchQuery] = useDebounce(query, 300);\n\tconst [open, setOpen] = useState(false);\n\tconst [chatEditSettingModal, showChatEditSettingModal] = useState(false);\n\tconst [loading, setLoading] = useState(false);\n\tconst { companyId } = useAppState();\n\tconst { entityId } = useChatContext();\n\tconst dispatch = useDispatch();\n\tconst { showNotification } = useNotistack();\n\n\tconst {\n\t\tisAdminManager,\n\t\tisOwner,\n\t\tcurrentMember,\n\t\tstaffMembersLength\n\t\t// chatId,\n\t} = props;\n\n\tconst removeMember = (member: any) => {\n\t\tsetLoading(true);\n\t\tdispatch(\n\t\t\tformRequest({\n\t\t\t\tentity: 'chatmembers',\n\t\t\t\tname: `Allchatmembers-${entityId}-${staffMembersLength}`,\n\t\t\t\tmethod: 'delete',\n\t\t\t\turl: `/${companyId}/ims/groups/${entityId}/members/${member.id}/`,\n\t\t\t\tdeleteData: true,\n\t\t\t\tid: member.id,\n\t\t\t\tcb: {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t//We must refetch ims object because of members count which is changed.\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\tloadOneRequest({\n\t\t\t\t\t\t\t\tid: entityId,\n\t\t\t\t\t\t\t\tentity: 'ims-chats',\n\t\t\t\t\t\t\t\tname: `GroupChat-${entityId}`,\n\t\t\t\t\t\t\t\turl: `/${companyId}/ims/groups/${entityId}/`,\n\t\t\t\t\t\t\t\tparams: {},\n\t\t\t\t\t\t\t\tprimaryKey: 'id',\n\t\t\t\t\t\t\t\trelations: ''\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t\tshowNotification({ message: 'Successfully deleted', variant: 'success' });\n\t\t\t\t\t},\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\t\t\t\terror: (err) => {\n\t\t\t\t\t\t// NotificationManager.error(err.code);\n\t\t\t\t\t\tshowNotification({ message: 'Something went wrong', variant: 'error' });\n\t\t\t\t\t},\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\t\t\t\tfinally: () => {\n\t\t\t\t\t\tsetOpen(false);\n\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tparams: {},\n\t\t\t\tprimaryKey: 'id',\n\t\t\t\tvalues: {}\n\t\t\t})\n\t\t);\n\t};\n\n\tconst closeRemoveMemberHandler = () => setOpen(false);\n\n\treturn (\n\t\t<div className=\"members-list\">\n\t\t\t<EntityContainer.All\n\t\t\t\tentity=\"chatmembers\"\n\t\t\t\tname={`Allchatmembers-${entityId}-${staffMembersLength}`}\n\t\t\t\turl={`/${companyId}/ims/${entityId}/members_list/`}\n\t\t\t\tappendData\n\t\t\t\tparams={{\n\t\t\t\t\tpage,\n\t\t\t\t\tlimit: 20,\n\t\t\t\t\textra: {\n\t\t\t\t\t\tsearch: searchQuery\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\t\tonInit={(data) => {\n\t\t\t\t\t// console.log(\"data\", data);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{({ items, isFetched, meta }) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div className=\"members-list__search p-4\">\n\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\t// type=\"search\"\n\t\t\t\t\t\t\t\t\tlabel=\"Search members\"\n\t\t\t\t\t\t\t\t\tvalue={query}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setQuery(e.target.value)}\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Scrollbars\n\t\t\t\t\t\t\t\tclassName=\"rct-scroll\"\n\t\t\t\t\t\t\t\tautoHide\n\t\t\t\t\t\t\t\t/*style={{ height: getChatBoxHeight() }}*/ style={{ height: '300px' }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div className=\"members-list__list\">\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<List dense>\n\t\t\t\t\t\t\t\t\t\t\t{(items as any).map((member: any) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<ChatMember\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={member.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\tmember={member}\n\t\t\t\t\t\t\t\t\t\t\t\t\tisAdminManager={isAdminManager}\n\t\t\t\t\t\t\t\t\t\t\t\t\tisOwner={isOwner}\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowChatEditSettingModal={showChatEditSettingModal}\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetOpen={setOpen}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcurrentMember={currentMember}\n\t\t\t\t\t\t\t\t\t\t\t\t\tareAddedMembers\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t\t\t{isFetched &&\n\t\t\t\t\t\t\t\t\t\t\tmeta?.current_page &&\n\t\t\t\t\t\t\t\t\t\t\tmeta?.last_page &&\n\t\t\t\t\t\t\t\t\t\t\tmeta?.current_page < meta?.last_page && (\n\t\t\t\t\t\t\t\t\t\t\t\t<LoadMoreVisible setPage={() => setPage((prev) => prev + 1)} />\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t{!isFetched ? (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"case-chat-loader flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t\t<ConfirmModal\n\t\t\t\t\t\t\t\t\t\t\tfeatureHandler={() => removeMember(open)}\n\t\t\t\t\t\t\t\t\t\t\tisOpen={Boolean(open)}\n\t\t\t\t\t\t\t\t\t\t\ttoggleHandler={closeRemoveMemberHandler}\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Are you sure to remove the member from group chat?\"\n\t\t\t\t\t\t\t\t\t\t\thasLoader\n\t\t\t\t\t\t\t\t\t\t\tisLoading={loading}\n\t\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t\t<WhiteModal\n\t\t\t\t\t\t\t\t\t\t\thandleModalOpen={() => showChatEditSettingModal(false)}\n\t\t\t\t\t\t\t\t\t\t\topen={chatEditSettingModal}\n\t\t\t\t\t\t\t\t\t\t\tmaxWidth={310}\n\t\t\t\t\t\t\t\t\t\t\tminWidth={310}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<MemberChatSettings\n\t\t\t\t\t\t\t\t\t\t\t\tcompanyId={companyId}\n\t\t\t\t\t\t\t\t\t\t\t\tchatId={entityId}\n\t\t\t\t\t\t\t\t\t\t\t\tisAdminManager={isAdminManager}\n\t\t\t\t\t\t\t\t\t\t\t\tisOwner={isOwner}\n\t\t\t\t\t\t\t\t\t\t\t\tmember={chatEditSettingModal}\n\t\t\t\t\t\t\t\t\t\t\t\tstaffMembersLength={staffMembersLength}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</WhiteModal>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Scrollbars>\n\t\t\t\t\t\t</>\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t</EntityContainer.All>\n\t\t</div>\n\t);\n};\n\nexport default function MembersListWithErrorBoundary(props: any) {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<MembersList {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import React from 'react';\nimport Radio from '@material-ui/core/Radio';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormLabel from '@material-ui/core/FormLabel';\n\ntype Props = {\n\tvalue: any;\n\thandleChange: any;\n};\n\nconst MembersFilter = ({ value, handleChange }: Props) => {\n\treturn (\n\t\t<div className=\"members-list__filter\">\n\t\t\t<FormControl component=\"fieldset\">\n\t\t\t\t<FormLabel component=\"legend\">Filter:</FormLabel>\n\t\t\t\t<RadioGroup aria-label=\"gender\" name=\"filter\" value={value} onChange={handleChange}>\n\t\t\t\t\t<div className=\"members-list__filter_inner\">\n\t\t\t\t\t\t<div className=\"members-list__filter_item\">\n\t\t\t\t\t\t\t<FormControlLabel value=\"all\" control={<Radio color=\"primary\" />} label=\"All\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"members-list__filter_item\">\n\t\t\t\t\t\t\t<FormControlLabel value=\"staff\" control={<Radio color=\"primary\" />} label=\"Staff\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"members-list__filter_item\">\n\t\t\t\t\t\t\t<FormControlLabel\n\t\t\t\t\t\t\t\tvalue=\"individual\"\n\t\t\t\t\t\t\t\tcontrol={<Radio color=\"primary\" />}\n\t\t\t\t\t\t\t\tlabel=\"Individual Clients\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"members-list__filter_item\">\n\t\t\t\t\t\t\t<FormControlLabel\n\t\t\t\t\t\t\t\tvalue=\"clients\"\n\t\t\t\t\t\t\t\tcontrol={<Radio color=\"primary\" />}\n\t\t\t\t\t\t\t\tlabel=\"Business Client Users\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</RadioGroup>\n\t\t\t</FormControl>\n\t\t</div>\n\t);\n};\n\nexport default MembersFilter;\n","import React, { useState, useEffect } from 'react';\nimport EntityContainer from 'modules/entity/containers';\nimport { Scrollbars } from 'react-custom-scrollbars-2';\nimport { LoadMoreVisible } from 'shared/components';\nimport { ErrorBoundary, Loader } from 'shared/components';\nimport ChatMember from './ChatMember';\nimport List from '@material-ui/core/List';\nimport Fab from '@material-ui/core/Fab';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport TextField from '@material-ui/core/TextField';\nimport { useDebounce } from 'use-debounce';\nimport MembersFilter from './MembersFilter';\nimport IconButton from '@material-ui/core/IconButton';\nimport TuneIcon from '@material-ui/icons/Tune';\nimport { useEntityForm } from '../../../../modules/entity/hooks/useEntityForm';\nimport { useAppState } from '../../../../shared/state';\nimport { useChatContext } from '../../../../shared/contexts';\nimport { WhiteModal } from '../../../../shared/components/Elements';\nimport { useNotistack } from '../../../../shared/hooks';\nimport { loadOneRequest } from '../../../../modules/entity/actions';\nimport { useDispatch } from 'react-redux';\n\nconst AddChatMembers = (props: any) => {\n\tconst [page, setPage] = useState(1);\n\tconst { onSuccess, activeChat, staffMembersLength } = props;\n\n\tconst { companyId } = useAppState();\n\tconst { entityId } = useChatContext();\n\n\tconst [selectedMembers, setSelectedMembers] = useState<any[]>([]);\n\tconst [selectedMembersFull, setSelectedMembersFull] = useState<any[]>([]);\n\tconst [loading, setLoading] = useState(false);\n\tconst [value, setValue] = useState('all');\n\tconst [options, setOptions] = useState({\n\t\tis_individual: 'true',\n\t\tis_business: 'true',\n\t\tis_member: 'true'\n\t});\n\n\tconst dispatch = useDispatch();\n\n\tconst [selected, setSelected] = useState('All');\n\tconst { showNotification } = useNotistack();\n\n\tconst { handleRequest: handleAddMember } = useEntityForm({\n\t\tentity: 'chatmembers',\n\t\tname: `Allchatmembers-${entityId}-${staffMembersLength}`,\n\t\tmethod: 'post',\n\t\turl: `/${companyId}/ims/groups/${entityId}/members/`,\n\t\tvalues: selectedMembersFull.reduce(\n\t\t\t(acc, curr) => [\n\t\t\t\t...acc,\n\t\t\t\t{ user: { id: curr.id }, role: 'MEMBER', company: { id: curr.companyId } }\n\t\t\t],\n\t\t\t[]\n\t\t),\n\t\tcb: {\n\t\t\tsuccess: (data) => {\n\t\t\t\t//We must refetch ims object because of members count which is changed.\n\t\t\t\tdispatch(\n\t\t\t\t\tloadOneRequest({\n\t\t\t\t\t\tid: entityId,\n\t\t\t\t\t\tentity: 'ims-chats',\n\t\t\t\t\t\tname: `GroupChat-${entityId}`,\n\t\t\t\t\t\turl: `/${companyId}/ims/groups/${entityId}/`,\n\t\t\t\t\t\tparams: {},\n\t\t\t\t\t\tprimaryKey: 'id',\n\t\t\t\t\t\trelations: ''\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tshowNotification({ message: 'Members successfully added', variant: 'success' });\n\t\t\t},\n\t\t\terror: (error) => {\n\t\t\t\tshowNotification({ message: 'Something went wrong', variant: 'error' });\n\t\t\t},\n\t\t\tfinally: () => {\n\t\t\t\tsetLoading(false);\n\t\t\t\tonSuccess();\n\t\t\t}\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\t(() => {\n\t\t\tswitch (value) {\n\t\t\t\tcase 'all':\n\t\t\t\t\tsetSelected('All');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'individual':\n\t\t\t\t\tsetSelected('Individual Clients');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'clients':\n\t\t\t\t\tsetSelected('Business Client Users');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'staff':\n\t\t\t\t\tsetSelected('Staff');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t})();\n\t}, [value]);\n\n\tconst handleChange = (event: any) => {\n\t\tconst value = event.target.value;\n\t\tsetValue(value);\n\t\tsetLoading(true);\n\t\tsetPage(1);\n\t\tsetOpen(false);\n\t\tswitch (value) {\n\t\t\tcase 'all':\n\t\t\t\tsetOptions({\n\t\t\t\t\tis_individual: 'true',\n\t\t\t\t\tis_business: 'true',\n\t\t\t\t\tis_member: 'true'\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'individual':\n\t\t\t\tsetOptions({\n\t\t\t\t\tis_individual: 'true',\n\t\t\t\t\tis_business: 'false',\n\t\t\t\t\tis_member: 'false'\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'clients':\n\t\t\t\tsetOptions({\n\t\t\t\t\tis_individual: 'false',\n\t\t\t\t\tis_business: 'true',\n\t\t\t\t\tis_member: 'false'\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'staff':\n\t\t\t\tsetOptions({\n\t\t\t\t\tis_individual: 'false',\n\t\t\t\t\tis_business: 'false',\n\t\t\t\t\tis_member: 'true'\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t};\n\n\tconst { is_individual, is_business, is_member } = options;\n\tconst [query, setQuery] = useState('');\n\tconst [open, setOpen] = useState(false);\n\tconst [searchQuery] = useDebounce(query, 300);\n\n\tuseEffect(() => {\n\t\tsetPage(1);\n\t}, [searchQuery]);\n\n\tconst onClickHandler = (id: any, member: any) => {\n\t\tif (selectedMembers.includes(id)) {\n\t\t\tconst filteredIds = selectedMembers.filter((selId) => selId !== id);\n\t\t\tconst filteredMembers = selectedMembersFull.filter((m) => m.id !== id);\n\t\t\tsetSelectedMembers(filteredIds);\n\t\t\tsetSelectedMembersFull(filteredMembers);\n\t\t} else {\n\t\t\tsetSelectedMembers((prev) => [...prev, id]);\n\t\t\tsetSelectedMembersFull((prev) => [\n\t\t\t\t...prev,\n\t\t\t\t{ id: member.id, companyId: member?.company?.id }\n\t\t\t]);\n\t\t}\n\t};\n\n\tconst addMembersToChat = () => {\n\t\tsetLoading(true);\n\t\thandleAddMember();\n\t};\n\n\treturn (\n\t\t<div className=\"members-list relative\">\n\t\t\t<EntityContainer.All\n\t\t\t\tentity=\"clientMembers\"\n\t\t\t\tname={`AllClientMembers-${entityId}-${staffMembersLength}`}\n\t\t\t\turl={`/${companyId}/my/company/client_users/`}\n\t\t\t\tprimaryKey={(value) => `${value.id}-${value.company.id}`}\n\t\t\t\tappendData\n\t\t\t\tisUniq={false}\n\t\t\t\tparams={{\n\t\t\t\t\tpage,\n\t\t\t\t\tlimit: 20,\n\t\t\t\t\textra: {\n\t\t\t\t\t\tsearch: searchQuery,\n\t\t\t\t\t\tis_individual,\n\t\t\t\t\t\tis_business,\n\t\t\t\t\t\tis_member,\n\t\t\t\t\t\texclude_ids: (activeChat.members as any)\n\t\t\t\t\t\t\t.filter((member: any) => member.role.toUpperCase() !== 'KICKED')\n\t\t\t\t\t\t\t.reduce((acc: any[], curr: any) => [...acc, curr?.user.id], [])\n\t\t\t\t\t\t\t.join(',')\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\t\tonInit={(data) => {\n\t\t\t\t\t// console.log(\"data\", data);\n\t\t\t\t\tsetLoading(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{({ items, isFetched, meta }) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div className=\"members-list__settings\">\n\t\t\t\t\t\t\t\t<div className=\"members-list__search\">\n\t\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\t\tlabel=\"Search members\"\n\t\t\t\t\t\t\t\t\t\tvalue={query}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\t\tsetPage(1);\n\t\t\t\t\t\t\t\t\t\t\tsetQuery(e.target.value);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"members-list__filter-btn pl-2.5\">\n\t\t\t\t\t\t\t\t\t<IconButton aria-label=\"filter\" color=\"default\" onClick={() => setOpen(true)}>\n\t\t\t\t\t\t\t\t\t\t<TuneIcon />\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"ml-2.5 flex items-center\">\n\t\t\t\t\t\t\t\t<div className=\"mr-2.5\">\n\t\t\t\t\t\t\t\t\t<strong>Filtering type:</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"mr-2.5\">{selected}</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Scrollbars className=\"rct-scroll\" autoHide style={{ height: '300px' }}>\n\t\t\t\t\t\t\t\t<div className=\"members-list__list\">\n\t\t\t\t\t\t\t\t\t{loading && <Loader tiled />}\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<List className=\"add-chat-member__list\" dense>\n\t\t\t\t\t\t\t\t\t\t\t{(items as any).map((member: any, index: number) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<ChatMember\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\t\t\tmember={member}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClickHandler={onClickHandler}\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedMembers={selectedMembersFull}\n\t\t\t\t\t\t\t\t\t\t\t\t\tisAddingMember\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t\t\t{isFetched &&\n\t\t\t\t\t\t\t\t\t\t\tmeta?.current_page &&\n\t\t\t\t\t\t\t\t\t\t\tmeta?.last_page &&\n\t\t\t\t\t\t\t\t\t\t\tmeta?.current_page < meta?.last_page && (\n\t\t\t\t\t\t\t\t\t\t\t\t<LoadMoreVisible setPage={() => setPage((prev) => prev + 1)} />\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t{!isFetched ? (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"case-chat-loader flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Scrollbars>\n\t\t\t\t\t\t</>\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t</EntityContainer.All>\n\t\t\t{/*<Dialog*/}\n\t\t\t{/*\tclasses={{*/}\n\t\t\t{/*\t\tpaper: 'case-form-modal-paper visible-modal-paper',*/}\n\t\t\t{/*\t\tcontainer: 'case-form-paper-container visible-modal-paper-container'*/}\n\t\t\t{/*\t}}*/}\n\t\t\t{/*\topen={open}*/}\n\t\t\t{/*\tonClose={() => setOpen(false)}*/}\n\t\t\t{/*\taria-labelledby=\"alert-dialog-title\"*/}\n\t\t\t{/*\taria-describedby=\"alert-dialog-description\"*/}\n\t\t\t{/*\tmaxWidth=\"xl\"></Dialog>*/}\n\t\t\t{/*Group Chat Members and Add Members popup*/}\n\t\t\t<WhiteModal handleModalOpen={() => setOpen(false)} open={open}>\n\t\t\t\t<MembersFilter value={value} handleChange={handleChange} />\n\t\t\t</WhiteModal>\n\n\t\t\t<div className=\"absolute bottom-2.5 right-2.5\">\n\t\t\t\t<Fab\n\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\taria-label=\"add\"\n\t\t\t\t\tonClick={addMembersToChat}\n\t\t\t\t\tdisabled={selectedMembers.length === 0}\n\t\t\t\t>\n\t\t\t\t\t<CheckCircleIcon />\n\t\t\t\t</Fab>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default function AddChatMembersWithErrorBoundary(props: any) {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<AddChatMembers {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport AppBar from '@material-ui/core/AppBar';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport PeopleIcon from '@material-ui/icons/People';\nimport PersonAddIcon from '@material-ui/icons/PersonAdd';\nimport Typography from '@material-ui/core/Typography';\nimport Box from '@material-ui/core/Box';\nimport ChatMembersList from './ChatMembersList';\nimport AddChatMembers from './AddChatMembers';\nimport { useAppState } from '../../../../shared/state';\nimport { useChatContext } from '../../../../shared/contexts';\nimport { useGetEntityOne } from '../../../../shared/hooks';\nimport get from 'lodash/get';\nimport { ChatMember } from '../../types';\nimport { useAuth } from '../../../../modules/auth/hooks/useAuth';\n\nfunction TabPanel(props: any) {\n\tconst { children, value, index, ...other } = props;\n\n\treturn (\n\t\t<div\n\t\t\trole=\"tabpanel\"\n\t\t\thidden={value !== index}\n\t\t\tid={`scrollable-force-tabpanel-${index}`}\n\t\t\taria-labelledby={`scrollable-force-tab-${index}`}\n\t\t\t{...other}\n\t\t>\n\t\t\t{value === index && (\n\t\t\t\t<Box p={0}>\n\t\t\t\t\t<Typography component=\"div\">{children}</Typography>\n\t\t\t\t</Box>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\nTabPanel.propTypes = {\n\tchildren: PropTypes.node,\n\tindex: PropTypes.any.isRequired,\n\tvalue: PropTypes.any.isRequired\n};\n\nfunction a11yProps(index: number) {\n\treturn {\n\t\tid: `scrollable-force-tab-${index}`,\n\t\t'aria-controls': `scrollable-force-tabpanel-${index}`\n\t};\n}\n\ntype Props = {\n\tonSuccess: () => void;\n};\n\nconst Members = ({ onSuccess }: Props) => {\n\tconst { isPermitted, companyId } = useAppState();\n\tconst { entityId } = useChatContext();\n\tconst { userData } = useAuth();\n\tconst [value, setValue] = React.useState(0);\n\n\tconst chatEntity = useGetEntityOne({\n\t\tentity: 'ims-chats',\n\t\tentityId,\n\t\tentityName: `GroupChat-${entityId}One`\n\t});\n\n\tconst activeChat = chatEntity.item || {};\n\n\tconst owner = (get(chatEntity, 'item.members', []) as ChatMember[]).find(\n\t\t(member) => member.role === 'OWNER'\n\t);\n\tconst currentMember = (get(chatEntity, 'item.members', []) as ChatMember[]).find(\n\t\t(member) => member.user.id === userData.id\n\t);\n\tconst isOwner = owner?.user.id === userData.id;\n\n\tconst isAllowed = currentMember?.is_allowed_add_user || isPermitted;\n\n\tconst handleChange = (event: React.ChangeEvent<Record<string, unknown>>, newValue: any) => {\n\t\tsetValue(newValue);\n\t};\n\n\treturn (\n\t\t<div className=\"case-form case-form_group-chat -mt-5 rounded-xl\">\n\t\t\t<AppBar position=\"static\" color=\"default\">\n\t\t\t\t<Tabs\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\tvariant=\"fullWidth\"\n\t\t\t\t\tindicatorColor=\"primary\"\n\t\t\t\t\ttextColor=\"primary\"\n\t\t\t\t\taria-label=\"scrollable2 force tabs example\"\n\t\t\t\t>\n\t\t\t\t\t<Tab label=\"Members\" icon={<PeopleIcon />} {...a11yProps(0)} />\n\t\t\t\t\t<Tab\n\t\t\t\t\t\tlabel=\"Add Members\"\n\t\t\t\t\t\ticon={<PersonAddIcon />}\n\t\t\t\t\t\t{...a11yProps(1)}\n\t\t\t\t\t\tdisabled={!isAllowed}\n\t\t\t\t\t/>\n\t\t\t\t</Tabs>\n\t\t\t</AppBar>\n\t\t\t<TabPanel value={value} index={0}>\n\t\t\t\t<ChatMembersList\n\t\t\t\t\tisAdminManager={isPermitted}\n\t\t\t\t\tisOwner={isOwner}\n\t\t\t\t\tcurrentMember={currentMember}\n\t\t\t\t\tstaffMembersLength={123}\n\t\t\t\t/>\n\t\t\t</TabPanel>\n\t\t\t<TabPanel value={value} index={1}>\n\t\t\t\t<AddChatMembers\n\t\t\t\t\t{...{ chatId: entityId, companyId, onSuccess, activeChat, staffMembersLength: 123 }}\n\t\t\t\t/>\n\t\t\t</TabPanel>\n\t\t</div>\n\t);\n};\n\nexport default Members;\n","import React, { useEffect } from 'react';\nimport { GroupMember, IGroupChat } from 'shared/interfaces';\nimport isEmpty from 'lodash/isEmpty';\nimport { ChatHeaderLayout } from 'shared/components/Chat/components/ChatHeaderLayout';\nimport { useChatMenu } from '../hooks/useChatMenu';\nimport { Menu } from 'shared/components/Elements';\nimport { useChatContext } from 'shared/contexts/ChatContext';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport { Permissions } from '../components/Permissions';\nimport { useAuth } from 'modules/auth/hooks/useAuth';\nimport { useDraftMessage, useQueryParams, useUpdateEntities, useWhiteModal } from 'shared/hooks';\nimport { useChatSocket } from 'shared/contexts';\nimport { GroupChatMembers } from './GroupChatMembers';\nimport { useAppState } from 'shared/state';\nimport { ErrorBoundary } from 'shared/components';\nimport { IconPin } from '../../../shared/icons';\nimport { AiOutlineMore, AiOutlineSearch, AiOutlineUsergroupAdd } from 'react-icons/ai';\nimport { FiUsers } from 'react-icons/fi';\nimport { IoClose } from 'react-icons/io5';\nimport { useGroupMessageSearch } from '../hooks';\nimport ChatMembers from './Members/ChatMembers';\nimport { ChatMember } from '../types';\n\ntype Props = {\n\timsData: IGroupChat;\n\tisFetched: boolean;\n};\n\nconst useStyles = makeStyles(\n\tcreateStyles({\n\t\tpaper: {\n\t\t\tborderRadius: '16px',\n\t\t\tpadding: '10px'\n\t\t}\n\t})\n);\n\nexport function GroupChatHeaderInner({ imsData, isFetched }: Props) {\n\tconst { setScrollToMessageHandler, lastReadMessageId } = useChatContext();\n\tconst { userData } = useAuth();\n\tconst classes = useStyles();\n\tconst { removeQueryParams } = useQueryParams();\n\tconst { closeSocket } = useChatSocket();\n\tconst { setActiveDraft, activeDraft, setGroupSearchOpen, groupSearchOpen, isAdmin } =\n\t\tuseAppState();\n\tconst { saveDraft } = useDraftMessage();\n\tconst { toggleSearchSidebar } = useGroupMessageSearch();\n\tconst pinTime = imsData.pin_time;\n\tconst {\n\t\topen: membersModalOpen,\n\t\tmodalHandler: membersModalOpenHandler,\n\t\tWhiteModal\n\t} = useWhiteModal();\n\n\tconst { updateEntities } = useUpdateEntities();\n\n\tconst {\n\t\topen: membersAddModalOpen,\n\t\tmodalHandler: membersAddModalOpenHandler,\n\t\tWhiteModal: MembersAddWhiteModal\n\t} = useWhiteModal();\n\n\tconst { open, handleClick, anchorEl, handleCloseMenu } = useChatMenu(\n\t\timsData.pin_time,\n\t\timsData.id,\n\t\ttrue\n\t);\n\n\tconst mainText = imsData.title;\n\tlet headerAvatar = null;\n\n\tif (isFetched && !isEmpty(imsData)) {\n\t\theaderAvatar = {\n\t\t\tavatarSrc: imsData?.image?.thumbnail_150,\n\t\t\tavatarLetter: imsData?.title?.[0],\n\t\t\tavatarAlt: imsData?.title\n\t\t};\n\t}\n\n\tconst currentUserMemberData = imsData?.members?.find(\n\t\t(member: GroupMember) => member?.user?.id === userData.id\n\t);\n\tconst owner = (imsData?.members as ChatMember[])?.find((member) => member.role === 'OWNER');\n\tconst isOwner = owner?.user?.id === userData.id;\n\n\t// // const isAllowedExitGroup = currentMember?.is_allowed_exit_group;\n\t// const isAllowedPinMsg = currentUserMemberData?.is_allowed_pin_msg;\n\t// const isAllowedSendMsg = currentUserMemberData?.is_allowed_send_msg;\n\n\tconst closeCaseChat = () => {\n\t\t//Close message search sidebar if it is open\n\t\tif (groupSearchOpen) {\n\t\t\tsetGroupSearchOpen(false);\n\t\t}\n\t\tremoveQueryParams();\n\t\tcloseSocket?.();\n\t\tif (activeDraft) saveDraft();\n\n\t\ttry {\n\t\t\tupdateEntities({\n\t\t\t\tentity: 'ims-chats',\n\t\t\t\tentityId: imsData?.id,\n\t\t\t\tupdatingData: {\n\t\t\t\t\tlast_read_message: lastReadMessageId\n\t\t\t\t}\n\t\t\t});\n\t\t} catch (e) {}\n\t};\n\n\tuseEffect(() => {\n\t\tif ('draft_message' in imsData && imsData?.draft_message && !activeDraft) {\n\t\t\tsetActiveDraft(imsData.draft_message);\n\t\t}\n\t}, [imsData]);\n\n\treturn (\n\t\t<ChatHeaderLayout\n\t\t\tisFetched\n\t\t\tHeaderActions={\n\t\t\t\t<>\n\t\t\t\t\t{pinTime ? (\n\t\t\t\t\t\t<div className={'mr-4'}>\n\t\t\t\t\t\t\t<IconPin className={'text-kgrey-menuText'} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : null}\n\n\t\t\t\t\t{/*Members Popup open button*/}\n\t\t\t\t\t{isAdmin || isOwner || currentUserMemberData?.is_allowed_add_user ? (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t'flex-centered mr-2 h-8 w-8 rounded-full bg-primary text-white transition hover:bg-primary-dark active:translate-y-0.5 active:shadow-inner'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonClick={membersAddModalOpenHandler}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<AiOutlineUsergroupAdd />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t'flex-centered h-8 w-8 rounded-full bg-primary text-white transition hover:bg-primary-dark active:translate-y-0.5 active:shadow-inner'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonClick={membersModalOpenHandler}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<FiUsers />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/*Group Chat Members and Add Members popup*/}\n\t\t\t\t\t<MembersAddWhiteModal\n\t\t\t\t\t\thandleModalOpen={membersAddModalOpenHandler}\n\t\t\t\t\t\topen={membersAddModalOpen}\n\t\t\t\t\t\tnoPadding\n\t\t\t\t\t\tcropRounded\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChatMembers onSuccess={membersAddModalOpenHandler} />\n\t\t\t\t\t</MembersAddWhiteModal>\n\n\t\t\t\t\t{/*Group Chat Members and Add Members popup*/}\n\t\t\t\t\t<WhiteModal handleModalOpen={membersModalOpenHandler} open={membersModalOpen}>\n\t\t\t\t\t\t<GroupChatMembers />\n\t\t\t\t\t</WhiteModal>\n\n\t\t\t\t\t{/* Group Chat Search Sidebar open button */}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t'flex-centered ml-2 h-8 w-8 rounded-full bg-primary text-white transition hover:bg-primary-dark active:translate-y-0.5 active:shadow-inner'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonClick={toggleSearchSidebar}\n\t\t\t\t\t>\n\t\t\t\t\t\t<AiOutlineSearch />\n\t\t\t\t\t</button>\n\n\t\t\t\t\t{/*Three dot button*/}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"more-btn w-4 cursor-pointer text-right text-kdark-dark333\n\t\t\t\t\t\t transition hover:text-primary dark:text-white dark:hover:text-primary\"\n\t\t\t\t\t\tonClick={handleClick}\n\t\t\t\t\t>\n\t\t\t\t\t\t<AiOutlineMore className={'inline text-3xl'} />\n\t\t\t\t\t</div>\n\t\t\t\t\t{/*Permissions popover*/}\n\t\t\t\t\t<Menu\n\t\t\t\t\t\tid=\"long-menu\"\n\t\t\t\t\t\tanchorEl={anchorEl}\n\t\t\t\t\t\tkeepMounted\n\t\t\t\t\t\topen={open}\n\t\t\t\t\t\tclasses={{ paper: classes.paper }}\n\t\t\t\t\t\tonClose={handleCloseMenu}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isFetched ? (\n\t\t\t\t\t\t\t<Permissions\n\t\t\t\t\t\t\t\timage={imsData?.image}\n\t\t\t\t\t\t\t\ttitle={imsData?.title}\n\t\t\t\t\t\t\t\tmembersCount={imsData?.members?.length}\n\t\t\t\t\t\t\t\tisMuted={currentUserMemberData?.is_mute}\n\t\t\t\t\t\t\t\tchatId={imsData.id}\n\t\t\t\t\t\t\t\tmemberId={currentUserMemberData?.id}\n\t\t\t\t\t\t\t\tisOwner={isOwner}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</Menu>\n\n\t\t\t\t\t{/*Group chat close button*/}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"flex-center-y border-border-solid border-l px-4 py-2 text-kred-pink transition hover:opacity-80 lg:ml-4\"\n\t\t\t\t\t\ttype={'button'}\n\t\t\t\t\t\tonClick={closeCaseChat}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"icon \">\n\t\t\t\t\t\t\t<IoClose />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\t\t\t\t</>\n\t\t\t}\n\t\t\tmainText={mainText}\n\t\t\tdata={headerAvatar}\n\t\t\tpinnedMessage={{\n\t\t\t\ttitle: imsData?.pinned_message?.text,\n\t\t\t\tid: imsData?.pinned_message?.id\n\t\t\t}}\n\t\t\tscrollToHandler={setScrollToMessageHandler}\n\t\t/>\n\t);\n}\n\nexport function GroupChatHeader(props: Props) {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<GroupChatHeaderInner {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import React from 'react';\nimport EntityContainer from 'modules/entity/containers';\nimport { useGetEntity, useQueryParams } from 'shared//hooks';\nimport { useAppState } from 'shared/state';\nimport { GroupMember, IGroupChat } from 'shared/interfaces';\nimport { ChatLayout } from 'shared/components/Chat/ChatLayout';\nimport { GroupMessagesList } from './GroupMessagesList';\nimport { GroupChatInputControls } from './GroupChatInputControls';\nimport { ChatContextProvider, ChatInputContextProvider, ChatSocketProvider } from 'shared/contexts';\nimport { GroupChatHeader } from './GroupChatHeader';\nimport { useAuth } from 'modules/auth/hooks/useAuth';\nimport { ErrorBoundary } from 'shared/components';\n\ntype Props = {\n\tisUnreadFilterActive: boolean;\n};\n\nfunction GroupChatInner({ isUnreadFilterActive }: Props) {\n\tconst { query } = useQueryParams<{ chat: number }>();\n\tconst { companyId, groupSearchQuery } = useAppState();\n\tconst chatId = Number('chat' in query ? query.chat : undefined);\n\tconst { userData } = useAuth();\n\tconst { all: groupList } = useGetEntity({\n\t\tentity: 'ims-chats',\n\t\tentityName: `AllImsChats-${companyId}-${groupSearchQuery}`\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t{chatId && companyId ? (\n\t\t\t\t<EntityContainer.One\n\t\t\t\t\tid={String(chatId)}\n\t\t\t\t\trelations={''}\n\t\t\t\t\tentity={'ims-chats'}\n\t\t\t\t\tname={`GroupChat-${chatId}`}\n\t\t\t\t\turl={`/${companyId}/ims/groups/${chatId}/`}\n\t\t\t\t\tparams={{}}\n\t\t\t\t>\n\t\t\t\t\t{({ item, isFetched }) => {\n\t\t\t\t\t\tconst imsData = { ...item } as IGroupChat;\n\n\t\t\t\t\t\tconst currentUserMemberData = imsData?.members?.find(\n\t\t\t\t\t\t\t(member: GroupMember) => member?.user?.id === userData.id\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<ChatContextProvider entityId={chatId} entityType={'ims'}>\n\t\t\t\t\t\t\t\t<ChatInputContextProvider>\n\t\t\t\t\t\t\t\t\t<ChatSocketProvider entityId={chatId} entityType={'ims'}>\n\t\t\t\t\t\t\t\t\t\t<ChatLayout\n\t\t\t\t\t\t\t\t\t\t\tChatHeader={<GroupChatHeader isFetched={isFetched} imsData={imsData} />}\n\t\t\t\t\t\t\t\t\t\t\tChatBody={<GroupMessagesList chatId={chatId} />}\n\t\t\t\t\t\t\t\t\t\t\tChatInput={\n\t\t\t\t\t\t\t\t\t\t\t\t<GroupChatInputControls\n\t\t\t\t\t\t\t\t\t\t\t\t\tisAllowedSendMsg={currentUserMemberData?.is_allowed_send_msg}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</ChatSocketProvider>\n\t\t\t\t\t\t\t\t</ChatInputContextProvider>\n\t\t\t\t\t\t\t</ChatContextProvider>\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t</EntityContainer.One>\n\t\t\t) : (\n\t\t\t\t<div className={'flex-centered h-full w-full text-xl font-semibold dark:text-white'}>\n\t\t\t\t\t{groupList?.items?.length\n\t\t\t\t\t\t? 'Please select group chat'\n\t\t\t\t\t\t: `You have ${isUnreadFilterActive ? 'no unread' : 'no'} group chats`}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</>\n\t);\n}\n\nexport function GroupChat(props: Props) {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<GroupChatInner {...props} />\n\t\t</ErrorBoundary>\n\t);\n}\n","import React from 'react';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Avatar from '@material-ui/core/Avatar';\nimport Divider from '@material-ui/core/Divider';\nimport Highlighter from 'react-highlight-words';\nimport { normalizeSearchResult } from '../../../shared/components/LastMessageView';\nimport { IMessage } from '../../../shared/interfaces';\n\ntype Props = {\n\tmessage: IMessage;\n\tlistItemClickHandler: (messageId: number) => void;\n\tsearchQuery: string;\n};\n\nfunction SearchMessageItem({ message, listItemClickHandler, searchQuery }: Props) {\n\tconst name = `${message.from_user?.first_name} ${message.from_user?.last_name}`;\n\tconst avatarSrc = message?.from_user?.avatar?.thumbnail_150;\n\treturn (\n\t\t<>\n\t\t\t<ListItem\n\t\t\t\tonClick={() => listItemClickHandler(message.message_id!)}\n\t\t\t\tclassName=\"hover:bg-kprimary-200 cursor-pointer transition\"\n\t\t\t>\n\t\t\t\t<ListItemAvatar>\n\t\t\t\t\t<Avatar alt={name} src={avatarSrc} />\n\t\t\t\t</ListItemAvatar>\n\t\t\t\t<ListItemText\n\t\t\t\t\tclassName=\"dark:text-white\"\n\t\t\t\t\tprimary={name}\n\t\t\t\t\tsecondary={<MessageText messageText={message?.text || ''} searchQuery={searchQuery} />}\n\t\t\t\t/>\n\t\t\t</ListItem>\n\t\t\t<Divider variant=\"inset\" component=\"li\" />\n\t\t</>\n\t);\n}\n\ntype MessageTextType = {\n\tsearchQuery: string;\n\tmessageText: string;\n};\n\nfunction MessageText({ searchQuery, messageText }: MessageTextType) {\n\t// const splittedWords =\n\t// \tsearchQuery && !isEmpty(searchQuery) && searchQuery.toLowerCase().split(/\\s/);\n\t// const searchWords = [isArray(splittedWords) && splittedWords.join(' ')] || [];\n\tif (searchQuery) {\n\t\tconst searchWords = searchQuery.split(/\\s/).filter((word: string) => word);\n\t\tconst normalizedText = '' + normalizeSearchResult(messageText, searchQuery, 25);\n\n\t\treturn (\n\t\t\t<span>\n\t\t\t\t<Highlighter\n\t\t\t\t\thighlightClassName=\"highlighted\"\n\t\t\t\t\tsearchWords={searchWords}\n\t\t\t\t\ttextToHighlight={normalizedText}\n\t\t\t\t/>\n\t\t\t</span>\n\t\t);\n\t}\n\n\treturn <span>{messageText}</span>;\n}\n\nexport default SearchMessageItem;\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useQueryParams, useSearchQuery } from '../../../shared/hooks';\nimport { useAppState } from '../../../shared/state';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport { useGroupMessageSearch } from '../hooks';\nimport { Scrollbars } from 'react-custom-scrollbars-2';\nimport List from '@material-ui/core/List';\nimport EntityContainer from 'modules/entity/containers';\nimport { Loader, LoadMoreVisible } from '../../../shared/components';\nimport SearchMessageItem from '../chat-components/SearchMessageItem';\nimport { IMessage } from '../../../shared/interfaces';\nimport { AiOutlineSearch } from 'react-icons/ai';\n\nexport function GroupMessageSearch() {\n\tconst [page, setPage] = useState(1);\n\tconst { groupSearchOpen, companyId, setGroupMessageSearchQuery, setIsLastPageLoadedTriggered } =\n\t\tuseAppState();\n\tconst { query, setQuery, searchQuery } = useSearchQuery();\n\tconst { toggleSearchSidebar } = useGroupMessageSearch();\n\tconst { query: searchQueryParams } = useQueryParams();\n\tconst { changeUrlParams } = useQueryParams<{ chat: number; searchedMessageId?: number }>();\n\tconst inputRef = useRef(null);\n\n\tconst listItemClickHandler = useCallback(\n\t\t(messageId) => {\n\t\t\tif (searchQuery.length > 0) {\n\t\t\t\tchangeUrlParams({ chat: Number(searchQueryParams.chat), searchedMessageId: messageId });\n\n\t\t\t\tsetIsLastPageLoadedTriggered(true);\n\t\t\t}\n\t\t},\n\t\t[searchQuery, searchQueryParams]\n\t);\n\n\tuseEffect(() => {\n\t\tif (groupSearchOpen && inputRef.current) {\n\t\t\tsetTimeout(() => {\n\t\t\t\t(inputRef?.current as unknown as HTMLInputElement).focus();\n\t\t\t}, 300);\n\t\t}\n\t}, [groupSearchOpen]);\n\n\tuseEffect(() => {\n\t\tsetGroupMessageSearchQuery(searchQuery);\n\t}, [searchQuery]);\n\n\tconst handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n\t\tsetPage(1);\n\t\tsetQuery(e.target.value);\n\t};\n\n\tconst closeSearchSidebar = () => {\n\t\tchangeUrlParams({ chat: Number(searchQueryParams.chat) }, true);\n\t\ttoggleSearchSidebar();\n\t};\n\n\tconst chatId = searchQueryParams?.chat;\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col border-l p-1 pr-2 dark:bg-kdark-dark333\">\n\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t<IconButton aria-label=\"close\" onClick={closeSearchSidebar} className=\"!mr-1\">\n\t\t\t\t\t<CloseIcon />\n\t\t\t\t</IconButton>\n\t\t\t\t<div className=\"search-input relative flex-grow\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tclassName=\"group-search-input w-full rounded border p-2 pr-4 transition focus:outline-none focus:ring focus:ring-primary dark:bg-kdark-lighter dark:text-white\"\n\t\t\t\t\t\tvalue={query}\n\t\t\t\t\t\tonChange={handleInputChange}\n\t\t\t\t\t\tref={inputRef}\n\t\t\t\t\t\tplaceholder=\"Type message keywords\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div className=\"hover:text-kprimary absolute right-3 top-3 cursor-pointer\">\n\t\t\t\t\t\t{!query.length ? <AiOutlineSearch /> : null}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"content flex-grow\">\n\t\t\t\t<>\n\t\t\t\t\t<Scrollbars\n\t\t\t\t\t\tclassName=\"rct-scroll\"\n\t\t\t\t\t\tautoHide\n\t\t\t\t\t\tstyle={{ height: 'calc(100vh - 104px)' }}\n\t\t\t\t\t\tonScroll={() => {}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<List className=\"mb-0 p-0\">\n\t\t\t\t\t\t\t{searchQuery.length && companyId ? (\n\t\t\t\t\t\t\t\t<EntityContainer.All\n\t\t\t\t\t\t\t\t\tentity=\"search-messages\"\n\t\t\t\t\t\t\t\t\tname={`${companyId}-AllSearchMessages-${chatId}`}\n\t\t\t\t\t\t\t\t\turl={`/${companyId}/ims/message_search/`}\n\t\t\t\t\t\t\t\t\tappendData\n\t\t\t\t\t\t\t\t\tparams={{\n\t\t\t\t\t\t\t\t\t\tpage,\n\t\t\t\t\t\t\t\t\t\tlimit: 20,\n\t\t\t\t\t\t\t\t\t\textra: { search: searchQuery, group_chat_id: chatId }\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tprimaryKey=\"message_id\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{({ isFetched, items, meta }) => {\n\t\t\t\t\t\t\t\t\t\tif (!items.length && searchQuery && isFetched) {\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"p-4 !text-xl font-bold dark:text-white\">No messages found</p>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t{(items as IMessage[]).map((message) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SearchMessageItem\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={message.message_id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery={searchQuery}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlistItemClickHandler={listItemClickHandler}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage={message}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t\t{!isFetched && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ textAlign: 'center' }}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t{isFetched &&\n\t\t\t\t\t\t\t\t\t\t\t\tmeta?.current_page &&\n\t\t\t\t\t\t\t\t\t\t\t\tmeta?.last_page &&\n\t\t\t\t\t\t\t\t\t\t\t\tmeta?.current_page < meta?.last_page ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<LoadMoreVisible setPage={() => setPage((prev) => prev + 1)} />\n\t\t\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</EntityContainer.All>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<p className=\"!p-4 dark:text-white\">Please search for messages</p>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</List>\n\t\t\t\t\t</Scrollbars>\n\t\t\t\t</>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { GroupSidebarSearch } from './components/GroupSidebarSearch';\nimport { GroupList } from './components/GroupList';\nimport { GroupChat } from './chat-components/GroupChat';\nimport { useGroupInitialSettings } from './hooks/useGroupInitialSettings';\nimport { useQueryParams, useUnreadCaseTab, useWindowSize } from '../../shared/hooks';\nimport clsx from 'clsx';\nimport { isMobile } from 'react-device-detect';\nimport { Helmet } from 'react-helmet';\nimport { ErrorBoundary } from '../../shared/components';\nimport { useAppState } from '../../shared/state';\nimport { GroupMessageSearch } from './components';\nimport { Scrollbars } from 'react-custom-scrollbars-2';\n// import { GroupSidebarTop } from './components/GroupSidebarTop';\n// import { GroupContextProvider } from './contexts/GroupContext';\n\nconst PAGE_ELEM_WIDTHS = {\n\tAPP_SIDEBAR: 285,\n\tAPP_CONTAINER: 1155,\n\tAPP_CONTAINER_CONTENT_PADDING_LEFT: 28,\n\tCHAT_SIDEBAR: 362,\n\tCHAT_SIDEBAR_DIFFERENCE_ON_SEARCH_OPEN: 77,\n\tCHAT_SIDEBAR_MARGIN_RIGHT: 8,\n\tGROUP_SEARCH_SIDEBAR: 285\n};\n\nconst {\n\tAPP_SIDEBAR,\n\tAPP_CONTAINER_CONTENT_PADDING_LEFT,\n\tCHAT_SIDEBAR,\n\tCHAT_SIDEBAR_MARGIN_RIGHT,\n\tGROUP_SEARCH_SIDEBAR,\n\tCHAT_SIDEBAR_DIFFERENCE_ON_SEARCH_OPEN\n} = PAGE_ELEM_WIDTHS;\n\nfunction GroupsInner() {\n\tuseGroupInitialSettings();\n\tconst { unreadCasesQuantity, isHidden } = useUnreadCaseTab('Group chats');\n\tconst { query } = useQueryParams();\n\tconst { groupSearchOpen, groupsUnreadCountData, isDarkMode } = useAppState();\n\tconst { width: windowWidth } = useWindowSize();\n\tconst [isUnreadFilter, setIsUnreadFilter] = useState(false);\n\n\tconst toggleIsUnreadFilter = useCallback(() => {\n\t\tsetIsUnreadFilter((prev) => !prev);\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (\n\t\t\tisUnreadFilter &&\n\t\t\t!Object.values(groupsUnreadCountData)?.filter((count) => count > 0).length\n\t\t) {\n\t\t\tsetIsUnreadFilter(false);\n\t\t}\n\t}, [groupsUnreadCountData]);\n\n\tconst COMPUTED_CHAT_WIDTH =\n\t\twindowWidth! -\n\t\tAPP_SIDEBAR -\n\t\tAPP_CONTAINER_CONTENT_PADDING_LEFT -\n\t\tCHAT_SIDEBAR -\n\t\tCHAT_SIDEBAR_MARGIN_RIGHT -\n\t\tGROUP_SEARCH_SIDEBAR;\n\n\tconst COMPUTED_CHAT_WIDTH_NORMAL =\n\t\twindowWidth! -\n\t\tAPP_SIDEBAR -\n\t\tAPP_CONTAINER_CONTENT_PADDING_LEFT -\n\t\tCHAT_SIDEBAR -\n\t\tCHAT_SIDEBAR_MARGIN_RIGHT;\n\n\treturn (\n\t\t<div /*ref={casePageRef}*/ className={'flex h-full w-full flex-col  pl-2 pb-1 lg:pl-7 lg:pt-7'}>\n\t\t\t<div className=\"relative flex h-full\">\n\t\t\t\t{(!isHidden || unreadCasesQuantity === 0) && (\n\t\t\t\t\t<Helmet>\n\t\t\t\t\t\t<title>KENNEKT | Group chats</title>\n\t\t\t\t\t</Helmet>\n\t\t\t\t)}\n\t\t\t\t<div\n\t\t\t\t\tclassName={clsx('w-full flex-shrink-0 transition-all lg:mr-2', {\n\t\t\t\t\t\thidden: query.chat && isMobile,\n\t\t\t\t\t\t'lg:w-[362px]': !groupSearchOpen,\n\t\t\t\t\t\t'lg:w-[285px]': groupSearchOpen\n\t\t\t\t\t})}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"group-sidebar flex h-full flex-col pt-4 font-poppins lg:pt-0\">\n\t\t\t\t\t\t{/*<GroupSidebarTop />*/}\n\t\t\t\t\t\t<GroupSidebarSearch\n\t\t\t\t\t\t\tisUnreadFilter={isUnreadFilter}\n\t\t\t\t\t\t\ttoggleIsUnreadFilter={toggleIsUnreadFilter}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<GroupList isUnreadFilter={isUnreadFilter} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={clsx(!groupSearchOpen && 'flex-grow', 'transition-all')}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: groupSearchOpen\n\t\t\t\t\t\t\t? `${COMPUTED_CHAT_WIDTH + CHAT_SIDEBAR_DIFFERENCE_ON_SEARCH_OPEN}px`\n\t\t\t\t\t\t\t: COMPUTED_CHAT_WIDTH_NORMAL\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<GroupChat isUnreadFilterActive={isUnreadFilter} />\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t`message-search bottom-o absolute top-0 right-0 w-[285px] bg-white transition`,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'translate-x-[285px]': !groupSearchOpen,\n\t\t\t\t\t\t\t'translate-x-0': groupSearchOpen\n\t\t\t\t\t\t}\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<GroupMessageSearch />\n\t\t\t\t\t<span className=\" hidden focus:ring-2 focus:ring-primary\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default function Groups() {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<GroupsInner />\n\t\t</ErrorBoundary>\n\t);\n}\n","import { useEffect } from 'react';\nimport { parseUnreadMessages, useAxios } from 'shared/hooks';\nimport { useAppState } from 'shared/state';\nimport { useGroupUnreadLoad } from './useGroupUnreadLoad';\nimport { useChatContext } from '../../../shared/contexts';\n\nexport function useGroupInitialSettings() {\n\tconst { setPageType, companyId } = useAppState();\n\n\tconst { fetchGroupsUnreadMessagesCount } = useGroupUnreadLoad();\n\n\tuseEffect(() => {\n\t\tif (companyId) fetchGroupsUnreadMessagesCount();\n\t}, [companyId]);\n\n\tuseEffect(() => {\n\t\tsetPageType(true);\n\t\treturn () => {\n\t\t\tsetPageType(false);\n\t\t};\n\t}, [setPageType]);\n}\n","import React from 'react';\nimport InputBase from '@material-ui/core/InputBase';\nimport { InputProps, makeStyles } from '@material-ui/core';\nimport { createStyles, Theme } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme: Theme) =>\n\tcreateStyles({\n\t\troot: {\n\t\t\tborder: '1px solid #B8BCCF',\n\t\t\tfontSize: '15px',\n\t\t\tlineHeight: 1,\n\t\t\tborderRadius: '12px',\n\t\t\tpadding: '10px 30px',\n\t\t\tfontWeight: 300,\n\t\t\twidth: '100%'\n\t\t},\n\t\tinput: {\n\t\t\tpadding: 0\n\t\t}\n\t})\n);\n\nexport function InputText(props: InputProps) {\n\tconst classes = useStyles();\n\n\treturn <InputBase classes={{ root: classes.root, input: classes.input }} {...props} />;\n}\n\nexport default InputText;\n","import React from 'react';\nimport InputBase from '@material-ui/core/InputBase';\nimport { InputProps, makeStyles } from '@material-ui/core';\nimport { createStyles, Theme } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport SearchIcon from '@material-ui/icons/Search';\n\nconst useStyles = makeStyles((theme: Theme) =>\n\tcreateStyles({\n\t\troot: {\n\t\t\tborder: '1px solid #B8BCCF',\n\t\t\tfontSize: '15px',\n\t\t\tlineHeight: 1,\n\t\t\tborderRadius: '12px',\n\t\t\tpadding: '10px 40px 10px 20px',\n\t\t\tfontWeight: 300,\n\t\t\twidth: '100%'\n\t\t},\n\t\tinput: {\n\t\t\tpadding: 0\n\t\t},\n\t\tgridContainer: {\n\t\t\tposition: 'relative'\n\t\t},\n\t\ticonRoot: {\n\t\t\tposition: 'absolute',\n\t\t\ttop: '50%',\n\t\t\ttransform: 'translateY(-50%)',\n\t\t\tfontSize: '22px',\n\t\t\twidth: '22px',\n\t\t\theight: '22px',\n\t\t\tright: '15px'\n\t\t},\n\t\tsvgRoot: {\n\t\t\tposition: 'absolute'\n\t\t}\n\t})\n);\n\nexport function InputTextIcon(props: InputProps) {\n\tconst classes = useStyles();\n\n\treturn (\n\t\t<Grid container classes={{ container: classes.gridContainer }}>\n\t\t\t<InputBase classes={{ root: classes.root, input: classes.input }} {...props} />\n\t\t\t<div className={classes.iconRoot}>\n\t\t\t\t<SearchIcon fontSize={'inherit'} classes={{ root: classes.svgRoot }} />\n\t\t\t</div>\n\t\t</Grid>\n\t);\n}\n","import { InputText } from './InputText';\nimport { InputTextIcon } from './InputTextIcon';\nimport { SwitchComp } from './SwitchComp';\n\nexport { SwitchComp } from './SwitchComp';\nconst fields = {\n\tInputText,\n\tInputTextIcon,\n\tSwitchComp\n};\n\nexport default fields;\n"],"names":["imgPath","config","GroupFormElements","onSuccess","setFieldValue","isSubmitting","values","isEditing","useState","uploadMeta","setUploadMeta","cancelSending","setCancelSending","image","file","setFile","useEffect","className","label","labelClasses","name","component","KntInputField","placeholder","required","autoComplete","maxLength","type","src","get","alt","variant","value","onClick","tiled","withOverlay","onClickHandler","color","isDisabled","CreateGroupForm","useAppState","companyId","groupSearchQuery","changeUrlParams","useQueryParams","entity","url","method","primaryKey","sendAsFormData","normalizeData","data","prependData","fields","onSubmitKey","response","resetForm","chat","id","onError","error","console","log","GroupSidebarSearch","toggleIsUnreadFilter","isUnreadFilter","query","setQuery","useDebounce","searchQuery","setGroupSearchQuery","groupsUnreadCountData","useWhiteModal","open","modalHandler","WhiteModal","totalGroupUnreadCount","Object","filter","count","length","onChange","e","target","Fab","size","handleModalOpen","UpdateEntities","Actions","useChatMenu","pin_time","chatId","isFromChat","anchorEl","setAnchorEl","managerRequested","setManagerRequested","toggleChatPanel","Boolean","dispatch","useDispatch","handleClick","event","currentTarget","useAxios","cb","success","args","isPinning","entityId","String","Date","now","pinCase","fetchData","handleNotificationClose","reason","handleMenuItemClick","menuType","handleCloseMenu","ChatItemMarkup","title","last_message_author","last_message_type","last_message_text","last_message_time","draftMessage","isMuted","lastReadMessage","setActiveDraft","setChatUuid","isActive","Number","chatAvatar","hasUnread","clsx","css","unread","hasUnreadMessage","nanoid","LastMessageView","time","IconVertical","keepMounted","onClose","MenuItem","ChatItemInner","props","ChatItem","isCompact","GroupListInner","page","setPage","searchPage","setSearchPage","userData","useAuth","isActiveChat","params","extra","buildGroupParams","limit","CHATS_MESSAGES_LIMIT","appendData","isCancellable","cancelField","items","isFetched","meta","mappedAndFilteredChatItems","item","toString","sortedChatItems","sortChatList","map","thumbnail_150","members","find","member","user","is_mute","draft_message","last_read_message","Array","_","key","ChatListLoader","current_page","last_page","GroupList","speed","width","height","viewBox","backgroundColor","foregroundColor","cx","cy","r","x","y","rx","ry","GroupMessagesListInner","useDimensions","chatBodyRef","chatBodyHeight","useChatInputContext","setIsDelayedMessage","isDelayedMessage","afterMessagesFetchService","useOnInit","entityPage","lastReadMsgIdFromQuery","hasUnreadCached","useMemo","firstUnread","useRef","useChatContext","isSetSearchReply","allowToLoad","setAllowToLoad","direction","messagesLimit","replyLoading","scrollToMsgId","setScrollPosition","state","isMsgHasBeenIndicated","virtuosoRef","chatEntity","useGetEntityOne","entityName","useChatMessagesList","cursorTop","cursorBot","handlePageLoading","localEntityId","scrollIntoElement","isLoadedRepliedMessage","messageVisibleHandler","setUpdateEntityPage","searchedMessageId","paginationDepsRef","cursor","isLastPageFetched","setIsLastPageFetched","isFirstPageFetched","setIsFirstPageFetched","totalMessagesCount","removeUnreadCountFromCaseList","shouldStartFromFirstUnread","isUniq","cursorBased","replaceIds","entity_id","onInit","messagesList","anywayAllowToLoadIfNotInScrollAndIndicateMode","ref","pinned_message","isSafari","context","isConfirmationRequired","firstItemIndex","overscan","reverse","main","initialTopMostItemIndex","index","align","behavior","atTopStateChange","atTop","atBottomStateChange","atBottom","itemContent","tempMessage","text","from_user","idx","findIndex","message","current","isFirstUnread","mapKey","custom_uuid","checkMsgAuthor","currentMsgAuthorId","prevMsgAuthorId","nextMsgAuthorId","prevMsgType","nextMsgType","isSameFromUserWithPrev","isSameFromUserWithNext","content","offset","bottom","scrollDelay","isVisible","components","Scroller","VirtuosoScrollWrapper","Item","VirtuosoCustomItem","Footer","undefined","VirtuosoFooter","GroupMessagesList","resetKeys","resetHandler","useCallback","window","location","reload","onResetHandler","getOne","Selectors","GroupChatInputControlsInner","isAllowedSendMsg","setMessage","reply","setReply","editingMessage","entityType","sendJsonMessage","useChatSocket","sendChatMessage","useChatMessage","updateEntities","useUpdateEntities","activeDraft","useDraftMessage","removeLS","updateEntityDraft","getLS","tempMessageEvent","setTempMessageEvent","draftObject","caseChatEntity","useSelector","onSubmit","preventDefault","updatingData","replied_to_id","replied_to","msgSendingChatId","uuid","edited","is_draft","onFormSubmit","isGroup","GroupChatInputControls","PermissionItem","Component","iconProp","field_name","handleChange","property","disabled","checked","ChatPermissionMenuItem","handler","Icon","EditGroupForm","description","PermissionsInner","membersCount","memberId","isOwner","isAdmin","removeQueryParams","exitLoading","setExitLoading","setExitOpen","deleteVisible","setDeleteVisible","deleteLoading","setDeleteLoading","toggleDeleteVisible","prev","toggleDeleteLoading","propertyRef","owner","role","currentMember","canLeaveChat","is_allowed_exit_group","canDeleteChat","is_allowed_delete_group","updatePermission","dynamicValues","setPropertyHandler","fieldName","handleMute","changingData","chatProperty","handlePropertyChange","handleChatMute","handleLocalDelete","useEntityForm","deleteData","errors","finally","handleExitRequest","handleRequest","leaveGroupChat","localDelete","permissions","BiMessageSquareDetail","show","CgAdd","MdOutlineRemoveCircleOutline","AiOutlinePushpin","AiOutlineEdit","IoExitOutline","currentUserProperty","handlerSwitchMute","isMuting","deleteGroupChat","imsData","useGroupRequest","openEditModal","toUpperCase","is_allowed_edit_info","permission","GoMute","GoUnmute","MdOutlineDelete","featureHandler","isOpen","toggleHandler","hasLoader","isLoading","Permissions","GroupChatMembersInner","autoHide","style","search","smallSize","letter","first_name","last_name","avatar","thumbnail","MembersSkeleton","GroupChatMembers","useGroupMessageSearch","setGroupSearchOpen","groupSearchOpen","handleSearchBtnClick","toggleSearchSidebar","useStyles","makeStyles","theme","root","display","margin","spacing","purple","palette","getContrastText","deepPurple","areAddedMembers","selectedMembers","isAddingMember","isAdminManager","showChatEditSettingModal","setOpen","classes","firstName","lastName","companyName","isIndividualClient","username","avatarSrc","FN","LN","userId","isBusinessAdmin","is_admin","isStaff","is_staff","isCurrentChatOwner","isMemberSelected","selectedMember","company","ListItem","button","classnames","includes","ListItemAvatar","Avatar","ListItemText","primary","secondary","ListItemSecondaryAction","IconButton","edge","CheckCircleOutline","is_allowed_remove_user","Edit","Delete","hasSwitch","isMuteSetting","isMute","Switch","inputProps","FormRequest","staffMembersLength","is_allowed_send_msg","is_allowed_add_user","is_allowed_pin_msg","setProperty","reloadEntityAll","useLoadAll","prevProperty","payload","updateData","IconMessage","IconAdd","IconRemove","IconPin","IconEdit","IconExit","setting","formRequest","MembersList","chatEditSettingModal","loading","setLoading","showNotification","useNotistack","closeRemoveMemberHandler","TextField","fullWidth","List","dense","loadOneRequest","relations","err","maxWidth","minWidth","MembersListWithErrorBoundary","FormControl","FormLabel","RadioGroup","FormControlLabel","control","Radio","AddChatMembers","activeChat","setSelectedMembers","selectedMembersFull","setSelectedMembersFull","setValue","is_individual","is_business","is_member","options","setOptions","selected","setSelected","handleAddMember","reduce","acc","curr","filteredIds","selId","filteredMembers","m","exclude_ids","join","Tune","CheckCircle","AddChatMembersWithErrorBoundary","TabPanel","children","other","hidden","Box","p","Typography","a11yProps","isPermitted","React","isAllowed","AppBar","position","Tabs","newValue","indicatorColor","textColor","Tab","icon","People","PersonAdd","createStyles","paper","borderRadius","padding","GroupChatHeaderInner","setScrollToMessageHandler","lastReadMessageId","closeSocket","saveDraft","pinTime","membersModalOpen","membersModalOpenHandler","membersAddModalOpen","membersAddModalOpenHandler","MembersAddWhiteModal","mainText","headerAvatar","isEmpty","avatarLetter","avatarAlt","currentUserMemberData","ChatHeaderLayout","HeaderActions","noPadding","cropRounded","ChatMembers","pinnedMessage","scrollToHandler","GroupChatHeader","GroupChatInner","isUnreadFilterActive","groupList","useGetEntity","all","ChatLayout","ChatHeader","ChatBody","ChatInput","GroupChat","MessageText","messageText","searchWords","split","word","normalizedText","normalizeSearchResult","highlightClassName","textToHighlight","listItemClickHandler","message_id","Divider","GroupMessageSearch","setGroupMessageSearchQuery","setIsLastPageLoadedTriggered","useSearchQuery","searchQueryParams","inputRef","messageId","setTimeout","focus","Close","onScroll","group_chat_id","textAlign","APP_SIDEBAR","APP_CONTAINER_CONTENT_PADDING_LEFT","CHAT_SIDEBAR","CHAT_SIDEBAR_MARGIN_RIGHT","GROUP_SEARCH_SIDEBAR","CHAT_SIDEBAR_DIFFERENCE_ON_SEARCH_OPEN","GroupsInner","setPageType","fetchGroupsUnreadMessagesCount","useGroupUnreadLoad","useGroupInitialSettings","useUnreadCaseTab","unreadCasesQuantity","isHidden","windowWidth","isDarkMode","useWindowSize","setIsUnreadFilter","COMPUTED_CHAT_WIDTH","COMPUTED_CHAT_WIDTH_NORMAL","Helmet","isMobile","Groups","border","fontSize","lineHeight","fontWeight","input","InputText","InputBase","gridContainer","iconRoot","top","transform","right","svgRoot","SwitchComp"],"sourceRoot":""}