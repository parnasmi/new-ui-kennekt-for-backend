{"version":3,"file":"static/js/6908.4d79487c.chunk.js","mappings":"qvBAcaA,GAAiBC,EAAAA,EAAAA,eAA2B,MAcnDC,EAAU,SAACC,EAAkBC,GAClC,OAAQA,EAAOC,MACd,IAAK,mBACJ,OAAO,kBACHF,GADJ,IAECG,YAAaF,EAAOG,UAGtB,IAAK,wBACJ,OAAO,kBACHJ,GADJ,IAECK,iBAAkBJ,EAAOG,UAG3B,QACC,OAAOJ,IAIH,SAASM,EAAT,GAE+C,IADrDC,EACoD,EADpDA,SAEA,GAA0BC,EAAAA,EAAAA,YAAWT,EAAS,CAC7CI,YAAa,KACbE,iBAAkB,SAFnB,eAAOL,EAAP,KAAcS,EAAd,KAKQN,EAAkCH,EAAlCG,YAAaE,EAAqBL,EAArBK,iBAEfK,GAAiBC,EAAAA,EAAAA,cAAY,SAACC,GACnCH,EAAS,CAAEP,KAAM,mBAAoBE,QAASQ,MAC5C,IACGC,GAAsBF,EAAAA,EAAAA,cAAY,SAACN,GACxCI,EAAS,CAAEP,KAAM,wBAAyBE,QAASC,MACjD,IAGGS,EAAgB,CACrBX,YAAAA,EACAO,eAAAA,EACAL,iBAAAA,EACAQ,oBAAAA,GAGD,OAAO,SAAChB,EAAekB,SAAhB,CAAyBC,MAAOF,EAAhC,SAAgDP,IAGjD,IAAMU,EAAoB,WAChC,IAAMC,GAAqBC,EAAAA,EAAAA,YAAWtB,GAEtC,IAAKqB,EACJ,MAAM,IAAIE,MAAM,8DACjB,OAAOF,I,kHC7ED,SAASG,IACf,MAAgCC,EAAAA,SAAe,GAA/C,eAAOC,EAAP,KAAiBC,EAAjB,KACA,EAAgCF,EAAAA,SAAe,WAA/C,eAAOG,EAAP,KAAiBC,EAAjB,KAEA,GAA4BC,EAAAA,EAAAA,MAApBC,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,MACVC,EAAcD,EAAdC,IAAKC,EAASF,EAATE,KACb,GAA0CC,EAAAA,EAAAA,IAAiB,WAAnDC,EAAR,EAAQA,oBAAqBC,EAA7B,EAA6BA,SAgC7B,OAtBAC,EAAAA,EAAAA,YAAU,WACT,IAAMC,EAAwBR,EAASS,SAASC,MAAM,KAAKC,OAAOC,SAASD,OAAOE,QAC5EC,EAAiBN,EAAsBA,EAAsBO,OAAS,IAAM,IAElF,WACC,OAAQD,GACP,IAAK,UACJlB,EAAY,GACZE,EAAY,WACZ,MAED,IAAK,UACJF,EAAY,GACZE,EAAY,WACZ,MAED,WAZF,KAgBE,CAACE,IAEG,CACNL,SAAAA,EACAE,SAAAA,EACAK,IAAAA,EACAC,KAAAA,EACAE,oBAAAA,EACAT,YAAAA,EACAU,SAAAA,EACAU,kBAtCyB,SACzBC,EACAC,GAEAtB,EAAYsB,K,yDCTP,SAASC,IACf,IAAQC,GAAcC,EAAAA,EAAAA,KAAdD,UACAE,GAAcC,EAAAA,EAAAA,KAAdD,UACAE,GAAYzB,EAAAA,EAAAA,MAAZyB,QACR,GAA0CC,EAAAA,EAAAA,WAAS,GAAnD,eAAOC,EAAP,KAAsBC,EAAtB,KACA,GAAoDF,EAAAA,EAAAA,WAAS,GAA7D,eAAOG,EAAP,KAA2BC,EAA3B,KACQC,GAAqBC,EAAAA,EAAAA,MAArBD,iBACR,GAA+DL,EAAAA,EAAAA,WAAS,GAAxE,eAAOO,EAAP,KAAkCC,EAAlC,KAEA,GAAwCR,EAAAA,EAAAA,UAAsC,MAA9E,eAAOS,EAAP,KAAqBC,EAArB,KAEmBC,GAA8BC,EAAAA,EAAAA,IAAS,CACzDnC,IAAI,IAAD,OAAMkB,EAAN,oBAA2BA,EAA3B,yBACHkB,OAAQ,MACRC,GAAI,CAEHC,QAAS,WACRV,EAAiB,CAAEW,QAAS,uCAAwCC,QAAS,YAC7Ef,GAAiB,GACjBE,GAAsB,IAEvBc,MAAO,SAACA,EAAOC,GAAoB,IAAD,IACjCd,EAAiB,CAChBW,SAAc,OAALE,QAAK,IAALA,GAAA,UAAAA,EAAOE,gBAAP,mBAAiBC,YAAjB,eAAuBL,UAAW,uBAC3CC,QAAS,UAEVf,GAAiB,OAfZoB,UAoBWC,GAAoBX,EAAAA,EAAAA,IAAS,CAC/CnC,IAAI,YAAD,OAAckB,EAAd,2BACHmB,GAAI,CAEHC,QAAS,SAACM,GAAU,IAAD,EAClB,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAMG,eAAV,OAAI,EAAelC,QAClBkB,GAA0B,IAG5BU,MAAO,SAACA,EAAOC,QATTG,WAcRxC,EAAAA,EAAAA,YAAU,WAET,GADAyC,IACI5B,GAAaE,EAAUP,OAAQ,CAClC,IAAMmC,EAAiB5B,EAAU6B,MAAK,SAACC,GAAD,OAASA,EAAIC,QAAQC,KAAOlC,KAC5DmC,EAAmB,OAAGL,QAAH,IAAGA,OAAH,EAAGA,EAAgBG,QAAQG,kBAEhDD,GACHpB,EAAgBoB,MAGhB,CAACjC,EAAWF,IAEf,IAAMqC,GAAsB1E,EAAAA,EAAAA,cAAW,iBAAC,qFACvC4C,GAAiB,GADsB,SAEjCS,IAFiC,2CAGrC,IAIH,MAAO,CACNsB,oBAH0B3E,EAAAA,EAAAA,cAAY,kBAAMyC,EAAQmC,KAAK,eAAc,IAIvEzB,aAAAA,EACAuB,oBAAAA,EACA5B,sBAAAA,EACAD,mBAAAA,EACAF,cAAAA,EACAM,0BAAAA,K,+LCpEF,SAAS4B,EAAUC,GAClB,MAAO,CACNP,GAAG,qBAAD,OAAuBO,GACzB,gBAAgB,gBAAhB,OAAiCA,IAInC,IAAMC,GAAcC,EAAAA,EAAAA,OAAK,kBAAM,4DACzBC,GAAeD,EAAAA,EAAAA,OAAK,kBAAM,mCAEhC,SAASE,IACR,OASIxE,EAAAA,EAAAA,KARHE,EADD,EACCA,SACAC,EAFD,EAECA,YACAC,EAHD,EAGCA,SACAK,EAJD,EAICA,IACAC,EALD,EAKCA,KACAE,EAND,EAMCA,oBACAC,EAPD,EAOCA,SACAU,EARD,EAQCA,kBAGKkD,EAAgBlE,SAASS,SAAS0D,SAAS,YAI3CC,EAFe,CAAC,WAEiBjB,MAAK,SAAChD,GAAD,OAAUH,SAASS,SAAS0D,SAAShE,MAQjF,OANAI,EAAAA,EAAAA,YAAU,WACL2D,GACHtE,EAAY,KAEX,CAACI,SAAUkE,KAGb,SAAC,IAAD,WACC,6BACI5D,GAAoC,IAAxBD,KACd,SAACgE,EAAA,EAAD,WACC,+CAAqBxE,QAGvB,iBAAKyE,UAAU,OAAf,WACC,eAAIA,UAAU,uCAAd,iCACA,cAAGA,UAAU,qBAAb,iEAED,gBACCA,WAAWC,EAAAA,EAAAA,GAAK,aAAc,CAC7B,8BAA+BH,IAFjC,UAKC,UAAC,UAAD,CACCI,YAAaJ,EACbhF,MAAOO,EAEP8E,SAAUzD,EACV,aAAW,cALZ,WAOC,SAAC,UAAD,QACC0D,MAAM,UACNC,UAAWC,EAAAA,GACXC,GAAE,UAAK3E,EAAL,aACE0D,EAAU,MAEf,SAAC,UAAD,QACCc,MAAM,WACNC,UAAWC,EAAAA,GACXC,GAAE,UAAK3E,EAAL,cACE0D,EAAU,WAIjB,gBAAKU,UAAU,8CAAf,UACC,gBAAKA,UAAU,qBAAf,UACC,SAAC,EAAAQ,SAAD,CAAUC,UAAU,SAAC,KAAD,CAAQC,OAAK,IAAjC,UACC,UAAC,KAAD,YACC,SAAC,KAAD,CAAOC,OAAK,EAAC9E,KAAI,UAAKA,EAAL,YAAqBwE,UAAWb,KACjD,SAAC,KAAD,CAAOmB,OAAK,EAAC9E,KAAI,UAAKA,EAAL,aAAsBwE,UAAWX,kBCpF1D,MD8FO,WACN,OACC,SAAC,KAAD,WACC,SAAC/F,EAAA,GAAD,WACC,SAACgG,EAAD","sources":["pages/Payments/context/PaymentContext.tsx","pages/Payments/hooks/usePayments.ts","pages/Payments/hooks/useSubscription.ts","pages/Payments/Payments.tsx","pages/Payments/index.ts"],"sourcesContent":["import React, { createContext, useReducer, useContext, useCallback } from 'react';\n\nexport type PaymentFrequencyType = 'month' | 'year';\n\ntype StateType = {\n\tsearchQuery: string | null;\n\tpaymentFrequency: PaymentFrequencyType;\n};\n\ntype ContextType = {\n\tsetPaymentFrequency: (frequency: PaymentFrequencyType) => void;\n} & StateType;\n\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nexport const PaymentContext = createContext<ContextType>(null!);\n\ntype setSearchQuery = {\n\ttype: 'SET_SEARCH_QUERY';\n\tpayload: string | null;\n};\n\ntype setPaymentFrequency = {\n\ttype: 'SET_PAYMENT_FREQUENCY';\n\tpayload: PaymentFrequencyType;\n};\n\ntype Actions = setSearchQuery | setPaymentFrequency;\n\nconst reducer = (state: StateType, action: Actions): StateType => {\n\tswitch (action.type) {\n\t\tcase 'SET_SEARCH_QUERY': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tsearchQuery: action.payload\n\t\t\t};\n\t\t}\n\t\tcase 'SET_PAYMENT_FREQUENCY': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tpaymentFrequency: action.payload\n\t\t\t};\n\t\t}\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n\nexport function PaymentContextProvider({\n\tchildren\n}: React.PropsWithChildren<Record<string, unknown>>) {\n\tconst [state, dispatch] = useReducer(reducer, {\n\t\tsearchQuery: null,\n\t\tpaymentFrequency: 'year'\n\t});\n\n\tconst { searchQuery, paymentFrequency } = state;\n\n\tconst setSearchQuery = useCallback((query: string | null) => {\n\t\tdispatch({ type: 'SET_SEARCH_QUERY', payload: query });\n\t}, []);\n\tconst setPaymentFrequency = useCallback((paymentFrequency: PaymentFrequencyType) => {\n\t\tdispatch({ type: 'SET_PAYMENT_FREQUENCY', payload: paymentFrequency });\n\t}, []);\n\n\t// eslint-disable-next-line react/jsx-no-constructed-context-values\n\tconst contextValues = {\n\t\tsearchQuery,\n\t\tsetSearchQuery,\n\t\tpaymentFrequency,\n\t\tsetPaymentFrequency\n\t} as ContextType;\n\n\treturn <PaymentContext.Provider value={contextValues}>{children}</PaymentContext.Provider>;\n}\n\nexport const usePaymentContext = () => {\n\tconst newsPaymentContext = useContext(PaymentContext);\n\n\tif (!newsPaymentContext)\n\t\tthrow new Error('useNewsContext must be used within the NewsContextProvider');\n\treturn newsPaymentContext;\n};\n","import React, { useEffect } from 'react';\nimport { useRouter, useUnreadCaseTab } from 'shared/hooks';\n\nexport function usePayments() {\n\tconst [primeTab, setPrimeTab] = React.useState(0);\n\tconst [pageName, setPageName] = React.useState('Billing');\n\n\tconst { location, match } = useRouter();\n\tconst { url, path } = match;\n\tconst { unreadCasesQuantity, isHidden } = useUnreadCaseTab('Billing');\n\n\tconst handleChangePrime = (\n\t\tevent: React.ChangeEvent<Record<string, unknown>>,\n\t\tnewValue: number\n\t) => {\n\t\tsetPrimeTab(newValue);\n\t};\n\n\t//Just to setup tab active tab indication\n\tuseEffect(() => {\n\t\tconst locationSplitterArray = location.pathname.split('/').filter(Boolean).filter(String);\n\t\tconst nestedPageType = locationSplitterArray[locationSplitterArray.length - 1] || '';\n\n\t\t(() => {\n\t\t\tswitch (nestedPageType) {\n\t\t\t\tcase 'billing': {\n\t\t\t\t\tsetPrimeTab(0);\n\t\t\t\t\tsetPageName('Billing');\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'invoice': {\n\t\t\t\t\tsetPrimeTab(1);\n\t\t\t\t\tsetPageName('Invoice');\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t})();\n\t}, [location]);\n\n\treturn {\n\t\tprimeTab,\n\t\tpageName,\n\t\turl,\n\t\tpath,\n\t\tunreadCasesQuantity,\n\t\tsetPrimeTab,\n\t\tisHidden,\n\t\thandleChangePrime\n\t};\n}\n","import { useAppState } from '../../../shared/state';\nimport { useAuth } from '../../../modules/auth/hooks/useAuth';\nimport { useAxios, useNotistack, useRouter } from '../../../shared/hooks';\nimport { useCallback, useEffect, useState } from 'react';\nimport { CompSubscriptionType } from '../../../modules/user/reducers';\n\nexport function useSubscription() {\n\tconst { companyId } = useAppState();\n\tconst { companies } = useAuth();\n\tconst { history } = useRouter();\n\tconst [cancelLoading, setCancelLoading] = useState(false);\n\tconst [cancelSubscription, setCancelSubscription] = useState(false);\n\tconst { showNotification } = useNotistack();\n\tconst [hasUserAlreadyPaidInvoice, setUserAlreadyPaidInvoice] = useState(false);\n\n\tconst [subscription, setSubscription] = useState<CompSubscriptionType | null>(null);\n\n\tconst { fetchData: cancelSubscriptionRequest } = useAxios({\n\t\turl: `/${companyId}/payment/${companyId}/cancel-subscription/`,\n\t\tmethod: 'put',\n\t\tcb: {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\t\tsuccess: () => {\n\t\t\t\tshowNotification({ message: 'Your subscription has been cancelled', variant: 'success' });\n\t\t\t\tsetCancelLoading(false);\n\t\t\t\tsetCancelSubscription(false);\n\t\t\t},\n\t\t\terror: (error, additionalArgs) => {\n\t\t\t\tshowNotification({\n\t\t\t\t\tmessage: error?.response?.data?.message || 'Something went wrong',\n\t\t\t\t\tvariant: 'error'\n\t\t\t\t});\n\t\t\t\tsetCancelLoading(false);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst { fetchData: firstPayRequest } = useAxios({\n\t\turl: `/payment/${companyId}/invoices/?page_size=10`,\n\t\tcb: {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\t\tsuccess: (data) => {\n\t\t\t\tif (data?.results?.length) {\n\t\t\t\t\tsetUserAlreadyPaidInvoice(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: (error, additionalArgs) => {}\n\t\t}\n\t});\n\n\t//set subscription object\n\tuseEffect(() => {\n\t\tfirstPayRequest();\n\t\tif (companyId && companies.length) {\n\t\t\tconst currentCompany = companies.find((com) => com.company.id === companyId);\n\t\t\tconst currentSubscription = currentCompany?.company.comp_subscription as CompSubscriptionType;\n\n\t\t\tif (currentSubscription) {\n\t\t\t\tsetSubscription(currentSubscription);\n\t\t\t}\n\t\t}\n\t}, [companies, companyId]);\n\n\tconst handleCancelRequest = useCallback(async () => {\n\t\tsetCancelLoading(true);\n\t\tawait cancelSubscriptionRequest();\n\t}, []);\n\n\tconst navigateToCheckout = useCallback(() => history.push('/checkout'), []);\n\n\treturn {\n\t\tnavigateToCheckout,\n\t\tsubscription,\n\t\thandleCancelRequest,\n\t\tsetCancelSubscription,\n\t\tcancelSubscription,\n\t\tcancelLoading,\n\t\thasUserAlreadyPaidInvoice\n\t};\n}\n","import React, { lazy, Suspense, useEffect } from 'react';\nimport { StandardPageLayout } from 'shared/layouts';\nimport { usePayments } from './hooks';\nimport { Helmet } from 'react-helmet';\nimport clsx from 'clsx';\nimport { CustomMuiTabs, ErrorBoundary, Loader } from 'shared/components';\nimport { Link, Route, Switch } from 'react-router-dom';\nimport { PaymentContextProvider } from './context/PaymentContext';\n\nfunction a11yProps(index: number) {\n\treturn {\n\t\tid: `payments-tabpanel-${index}`,\n\t\t'aria-controls': `payments-tab-${index}`\n\t};\n}\n\nconst BillingPage = lazy(() => import('./NestedPages/billing'));\nconst InvoicesPage = lazy(() => import('./NestedPages/invoices'));\n\nfunction PaymentsInner() {\n\tconst {\n\t\tprimeTab,\n\t\tsetPrimeTab,\n\t\tpageName,\n\t\turl,\n\t\tpath,\n\t\tunreadCasesQuantity,\n\t\tisHidden,\n\t\thandleChangePrime\n\t} = usePayments();\n\n\tconst isRequestPage = location.pathname.includes('invoices');\n\n\tconst pathnameList = ['billing'];\n\n\tconst notBottomExtended = pathnameList.find((path) => location.pathname.includes(path));\n\n\tuseEffect(() => {\n\t\tif (isRequestPage) {\n\t\t\tsetPrimeTab(1);\n\t\t}\n\t}, [location, isRequestPage]);\n\n\treturn (\n\t\t<StandardPageLayout>\n\t\t\t<div>\n\t\t\t\t{(!isHidden || unreadCasesQuantity === 0) && (\n\t\t\t\t\t<Helmet>\n\t\t\t\t\t\t<title>{`KENNEKT | ${pageName}`}</title>\n\t\t\t\t\t</Helmet>\n\t\t\t\t)}\n\t\t\t\t<div className=\"mb-4\">\n\t\t\t\t\t<h1 className=\"text-2xl font-medium dark:text-white\">Billing & Invoices</h1>\n\t\t\t\t\t<p className=\"text-sm text-kgrey\">Choose plan that’s right for your business</p>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={clsx('prime-tabs', {\n\t\t\t\t\t\t'prime-tabs_no-bottom-extend': notBottomExtended\n\t\t\t\t\t})}\n\t\t\t\t>\n\t\t\t\t\t<CustomMuiTabs.Tabs\n\t\t\t\t\t\troundedTop={!notBottomExtended}\n\t\t\t\t\t\tvalue={primeTab}\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tonChange={handleChangePrime}\n\t\t\t\t\t\taria-label=\"simple tabs\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<CustomMuiTabs.Tab\n\t\t\t\t\t\t\tlabel=\"Billing\"\n\t\t\t\t\t\t\tcomponent={Link}\n\t\t\t\t\t\t\tto={`${url}/billing`}\n\t\t\t\t\t\t\t{...a11yProps(0)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<CustomMuiTabs.Tab\n\t\t\t\t\t\t\tlabel=\"Invoices\"\n\t\t\t\t\t\t\tcomponent={Link}\n\t\t\t\t\t\t\tto={`${url}/invoices`}\n\t\t\t\t\t\t\t{...a11yProps(1)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</CustomMuiTabs.Tabs>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"relative flex max-w-full flex-grow flex-col\">\n\t\t\t\t\t<div className=\"relative flex-grow\">\n\t\t\t\t\t\t<Suspense fallback={<Loader tiled />}>\n\t\t\t\t\t\t\t<Switch>\n\t\t\t\t\t\t\t\t<Route exact path={`${path}/billing`} component={BillingPage} />\n\t\t\t\t\t\t\t\t<Route exact path={`${path}/invoices`} component={InvoicesPage} />\n\t\t\t\t\t\t\t</Switch>\n\t\t\t\t\t\t</Suspense>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</StandardPageLayout>\n\t);\n}\n\nexport function Payments() {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<PaymentContextProvider>\n\t\t\t\t<PaymentsInner />\n\t\t\t</PaymentContextProvider>\n\t\t</ErrorBoundary>\n\t);\n}\n","import { Payments } from './Payments';\n\nexport default Payments;\n"],"names":["PaymentContext","createContext","reducer","state","action","type","searchQuery","payload","paymentFrequency","PaymentContextProvider","children","useReducer","dispatch","setSearchQuery","useCallback","query","setPaymentFrequency","contextValues","Provider","value","usePaymentContext","newsPaymentContext","useContext","Error","usePayments","React","primeTab","setPrimeTab","pageName","setPageName","useRouter","location","match","url","path","useUnreadCaseTab","unreadCasesQuantity","isHidden","useEffect","locationSplitterArray","pathname","split","filter","Boolean","String","nestedPageType","length","handleChangePrime","event","newValue","useSubscription","companyId","useAppState","companies","useAuth","history","useState","cancelLoading","setCancelLoading","cancelSubscription","setCancelSubscription","showNotification","useNotistack","hasUserAlreadyPaidInvoice","setUserAlreadyPaidInvoice","subscription","setSubscription","cancelSubscriptionRequest","useAxios","method","cb","success","message","variant","error","additionalArgs","response","data","fetchData","firstPayRequest","results","currentCompany","find","com","company","id","currentSubscription","comp_subscription","handleCancelRequest","navigateToCheckout","push","a11yProps","index","BillingPage","lazy","InvoicesPage","PaymentsInner","isRequestPage","includes","notBottomExtended","Helmet","className","clsx","roundedTop","onChange","label","component","Link","to","Suspense","fallback","tiled","exact"],"sourceRoot":""}