"use strict";(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[1937],{11937:function(e,t,a){a.r(t),a.d(t,{default:function(){return V}});var n=a(47313),s=a(63876),r=a(70885),i=a(84365),l=a(77344),o=a(69706),u=a.n(o),d=a(92468),m=a(17480),c=a(94715),f=a(46417);function p(e){var t=e.titleRef;return(0,f.jsx)("div",{children:(0,f.jsx)(c.gN,{name:"title",component:m.Mg,placeholder:"Write your question here",type:"textarea",label:"Write your question here",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",rows:6,inputElementClassNames:"border-kgrey-inputBd bg-transparent !text-sm dark:text-white",onChangeHandler:function(e){t.current=e.target.value}})})}var b=a(61818),_=a(22934),v=a(46225),y=a(77210),h=a(51105);function x(e){var t=e.values,a=e.setFieldValue,n=e.titleRef,s=e.setState,r=e.data_fields_errors,i=e.data_fields_names,o=e.departmentRef,m=e.state,p=e.setFormState,x=e.subDepIdsRef,S=e.data_fields,g=(0,l.m)().companyId,j=m.default_business_company;return console.log("state",m),(0,f.jsxs)("div",{className:"mb-4 react-select-dropdown",children:[(0,f.jsxs)("div",{className:"mb-4",children:[(0,f.jsxs)("label",{className:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",children:[(0,f.jsx)("span",{children:"Department"}),(0,f.jsx)("sup",{children:"*"})]}),(0,f.jsx)(c.gN,{component:b.Z,customStylesProps:_.gb,name:"department",placeholder:"Department Name Here",optionLabel:"name",optionValue:"id",isSearchable:!v.tq,isClearable:!0,isCached:!0,openMenuOnFocus:!0,loadOptionsKey:"results",loadOptionsUrl:"/".concat(g,"/business_companies/").concat(null===j||void 0===j?void 0:j.id,"/departments/"),loadOptionsParams:function(e){return{extra:{search:e}}},onChange:function(e){(0,d.RF)({option:e,setFieldValue:a,titleRef:n,setState:s,data_fields_errors:r,data_fields_names:i}),(0,d.W1)({departmentRef:o,option:e,setFieldValue:a,state:m})}})]}),(0,f.jsx)("div",{children:u()(t,"department")&&u()(t,"department.sub_departments_count")>0&&(0,f.jsx)(f.Fragment,{children:Object.keys(t.sub_department).map((function(e){return(0,f.jsx)(h.P,{subdep:e,companyId:g,values:t,setFieldValue:a,setFormState:p,titleRef:n,subDepIdsRef:x},e)}))})}),S.length>0&&(0,f.jsx)(y.g,{allProps:{data_fields:S,setState:s,handleCaseInputChange:d.I$,setFieldValue:a,data_fields_names:i,titleRef:n}})]})}var S=a(56626);function g(e){var t=e.isSubmitting,a=e.values,s=e.setFieldValue,i=e.state,l=e.data_fields,o=e.data_fields_names,u=e.data_fields_errors,d=e.setState,m=e.titleRef,c=e.departmentRef,b=(0,n.useState)({isSubDepChanged:!1,membersShow:!1}),_=(0,r.Z)(b,2),v=(_[0],_[1]),y=n.useRef([]);return(0,f.jsxs)("div",{className:"w-[600px]",children:[(0,f.jsx)(p,{titleRef:m}),(0,f.jsx)(x,{data_fields:l,subDepIdsRef:y,setFormState:v,values:a,setFieldValue:s,titleRef:m,setState:d,data_fields_errors:u,data_fields_names:o,departmentRef:c,state:i}),(0,f.jsx)(S.hf,{}),(0,f.jsx)("div",{className:"flex items-center justify-end",children:(0,f.jsx)("button",{className:"bg-primary-dark rounded-lg text-white px-5 py-2 border border-transparent hover:border-primary-dark transition-colors hover:bg-white hover:text-primary-dark disabled:opacity-50 disabled:pointer-events-none focus:ring focus:ring-primary dark:hover:bg-primary-300 dark:focus:ring-primary-300 dark:text-white",type:"submit",disabled:t,children:"Send"})})]})}var j=a(57718),k=a(11760),R=a(1413);function F(){var e=(0,l.m)().companyId,t=(0,k.a)().userData,a=(0,n.useState)({department:{},data_fields:[],data_fields_names:{},data_fields_errors:{},data_fields_names_persisted:{},sub_dep:{},default_business_company:{}}),s=(0,r.Z)(a,2),o=s[0],m=s[1],c=o.data_fields,p=o.data_fields_names,b=o.data_fields_errors,_=o.default_business_company,v=(0,n.useRef)(null),y=(0,n.useRef)(null),h=function(e){var t=e.setState,a=e.companyId;return{LoadDefaultBusinessCompany:(0,j.bK)({url:"/".concat(a,"/business_companies/?for_support_case=true&"),values:{},method:"get",cb:{success:function(e,a){t((function(t){return(0,R.Z)((0,R.Z)({},t),{},{default_business_company:e.results.find((function(e){return e.default_company_for_all}))})}))},error:function(e,t){console.log("error")}}}).fetchData}}({setState:m,companyId:e}),x=h.LoadDefaultBusinessCompany,S=(0,j.eC)().showNotification;return(0,n.useEffect)((function(){x()}),[]),(0,f.jsx)("div",{children:e?(0,f.jsx)(i.Z.Main,{entity:"support",name:"support-".concat(e),url:"".concat(e,"/cases/as_client/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},prependData:!0,fields:[{name:"title",required:!0,value:"",onSubmitKey:""},{name:"description",onSubmitValue:function(e,t){return u()(t,"title")},onSubmitKey:""},{name:"department",required:!0,onSubmitValue:function(e,t){return(0,d.fI)(t)},onSubmitKey:"",type:"object"},{name:"sub_department",onSubmitValue:function(e,t){return(0,d.B2)({values:t,departmentRef:y})},required:!1,value:{},onSubmitKey:"",type:"object"},{name:"data_field",onSubmitValue:function(e,t){return(0,d.Z1)({data_fields:c,data_fields_names:p})},required:Object.values(b).includes(!0),onSubmitKey:"",value:null},{name:"client_company",value:e,required:!0,onSubmitKey:""},{name:"client_user",value:null===t||void 0===t?void 0:t.id,required:!0,onSubmitKey:""},{name:"business_company",value:null===_||void 0===_?void 0:_.id,onSubmitKey:""},{name:"priority",value:{name:"Normal",code:"NORMAL"},onSubmitValue:function(e){return u()(e,"code")},type:"object",onSubmitKey:""},{name:"temp_sub",value:null,onSubmitKey:""},{name:"is_feedback",value:!0,onSubmitKey:""}],onSuccess:function(e,t){t(),S({message:"Your appeal has been sent successfully!",variant:"success"})},onError:function(e,t){var a,n;t(),S({message:null===e||void 0===e||null===(a=e.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message,variant:"error"})},children:function(e){var t=e.isSubmitting,a=e.values,n=e.setFieldValue,s=(e.errors,e.setFieldError,e.resetForm);return(0,f.jsx)(g,{values:a,setFieldValue:n,resetForm:s,isSubmitting:t,state:o,data_fields:c,data_fields_names:p,data_fields_errors:b,setState:m,titleRef:v,departmentRef:y})}}):null})}function w(){return(0,f.jsxs)("div",{className:"p-4 max-w-full flex flex-col min-h-full flex-grow relative",children:[(0,f.jsx)("h2",{className:"text-xl md:text-3xl font-bold dark:text-white py-4 mr-5 mb-4",children:"Send us your question or feedback"}),(0,f.jsx)(F,{})]})}var V=function(){return(0,f.jsx)(s.SV,{children:(0,f.jsx)(w,{})})}}}]);