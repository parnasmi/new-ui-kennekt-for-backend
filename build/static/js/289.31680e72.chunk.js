!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b4472ba6-647c-42db-b273-53e6fc6f6de9",e._sentryDebugIdIdentifier="sentry-dbid-b4472ba6-647c-42db-b273-53e6fc6f6de9")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"1d419c3c8a5f66a775a003b801a7dad6c0430a71"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[289],{90289:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var n=a(72791),s=a(66128),r=a(29439),i=a(27945),d=a(40084),l=a(26181),u=a.n(l),o=a(84200),c=a(77917),f=a(76188),m=a(17173),p=a(80184);function b(e){var t=e.titleRef,a=e.isDisabled,n=(0,m.$G)().t;return(0,p.jsx)("div",{children:(0,p.jsx)(f.gN,{name:"title",component:c.Mg,disabled:a,placeholder:n("support_form_title_placeholder"),type:"textarea",labelClasses:"ml-6 text-xs font-light text-kgrey-welcome mb-2 block",rows:6,inputElementClassNames:"border-kgrey-inputBd bg-transparent !text-sm dark:text-white",onChangeHandler:function(e){t.current=e.target.value}})})}var _=a(37099),y=a(80266),v=a(70629),h=a(78192),x=a(52033);function g(e){var t=e.values,a=e.setFieldValue,n=e.titleRef,s=e.setState,r=e.data_fields_errors,i=e.data_fields_names,l=e.departmentRef,c=e.state,b=e.setFormState,g=e.subDepIdsRef,S=e.data_fields,j=e.isDisabled,R=(0,d.m)().companyId,w=c.default_business_company,k=(0,m.$G)().t;return(0,p.jsxs)("div",{className:"react-select-dropdown mb-4",children:[(0,p.jsx)("div",{className:"mb-4",children:(0,p.jsx)(f.gN,{component:_.Z,customStylesProps:y.gb,name:"department",placeholder:k("select_department"),optionLabel:"name",optionValue:"id",isSearchable:!v.tq,isClearable:!0,isCached:!0,openMenuOnFocus:!0,loadOptionsKey:"results",loadOptionsUrl:"/".concat(R,"/business_companies/").concat(null==w?void 0:w.id,"/departments/"),loadOptionsParams:function(e){return{extra:{search:e}}},onChange:function(e){(0,o.RF)({option:e,setFieldValue:a,titleRef:n,setState:s,data_fields_errors:r,data_fields_names:i}),(0,o.W1)({departmentRef:l,option:e,setFieldValue:a})},isDisabled:j})}),(0,p.jsx)("div",{children:u()(t,"department")&&u()(t,"department.sub_departments_count")>0&&(0,p.jsx)(p.Fragment,{children:Object.keys(t.sub_department).map((function(e){return(0,p.jsx)(x.P,{subdep:e,companyId:R,values:t,setFieldValue:a,setFormState:b,titleRef:n,subDepIdsRef:g},e)}))})}),S.length>0&&(0,p.jsx)(h.g,{allProps:{data_fields:S,setState:s,handleCaseInputChange:o.I$,setFieldValue:a,data_fields_names:i,titleRef:n}})]})}var S=a(12082),j=a(16178);function R(e){var t=e.isSubmitting,a=e.values,s=e.setFieldValue,i=e.state,d=e.data_fields,l=e.data_fields_names,u=e.data_fields_errors,o=e.setState,c=e.titleRef,f=e.departmentRef,_=(0,n.useState)({isSubDepChanged:!1,membersShow:!1}),y=(0,r.Z)(_,2),v=(y[0],y[1]),h=(0,m.$G)().t,x=!!(0,j.Kx)().query.isSupportCase,R=n.useRef([]);return(0,p.jsxs)("div",{className:"w-[600px]",children:[(0,p.jsx)(b,{titleRef:c,isDisabled:x}),(0,p.jsx)(g,{data_fields:d,subDepIdsRef:R,setFormState:v,values:a,setFieldValue:s,titleRef:c,setState:o,data_fields_errors:u,data_fields_names:l,departmentRef:f,state:i,isDisabled:x}),(0,p.jsx)(S.hf,{isDisabled:x}),(0,p.jsx)("div",{className:"flex items-center justify-end",children:(0,p.jsx)("button",{className:"rounded-lg bg-primary-dark px-5 py-2 text-white border border-transparent hover:border-primary-dark transition-colors hover:bg-white hover:text-primary-dark focus:ring focus:ring-primary disabled:pointer-events-none disabled:opacity-50 dark:text-white dark:hover:bg-primary-300 dark:focus:ring-primary-300",type:"submit",disabled:t||x,children:h("send")})})]})}var w=a(97689),k=a(1413);function D(){var e=(0,m.$G)().t,t=(0,d.m)().companyId,a=(0,w.a)().userData,s=(0,n.useState)({department:{},data_fields:[],data_fields_names:{},data_fields_errors:{},data_fields_names_persisted:{},sub_dep:{},default_business_company:{}}),l=(0,r.Z)(s,2),c=l[0],f=l[1],b=c.data_fields,_=c.data_fields_names,y=c.data_fields_errors,v=c.default_business_company,h=(0,n.useRef)(null),x=(0,n.useRef)(null),g=function(e){var t=e.setState,a=e.companyId;return{LoadDefaultBusinessCompany:(0,j.bK)({url:"/".concat(a,"/business_companies/?for_support_case=true&"),values:{},method:"get",cb:{success:function(e,a){t((function(t){return(0,k.Z)((0,k.Z)({},t),{},{default_business_company:e.results.find((function(e){return e.default_company_for_all}))})}))},error:function(e,t){console.log("error")}}}).fetchData}}({setState:f,companyId:t}),S=g.LoadDefaultBusinessCompany,D=(0,j.Kx)().changeUrlParams,F=(0,j.eC)().showNotification;return(0,n.useEffect)((function(){t&&S()}),[t]),(0,p.jsx)("div",{children:t?(0,p.jsx)(i.Z.Main,{entity:"support",name:"support-".concat(t),url:"".concat(t,"/cases/as_client/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},prependData:!0,fields:[{name:"title",required:!0,value:"",onSubmitKey:""},{name:"description",onSubmitValue:function(e,t){return u()(t,"title")},onSubmitKey:""},{name:"department",required:!0,onSubmitValue:function(e,t){return(0,o.fI)(t)},onSubmitKey:"",type:"object"},{name:"sub_department",onSubmitValue:function(e,t){return(0,o.B2)({values:t,departmentRef:x})},required:!1,value:{},onSubmitKey:"",type:"object"},{name:"data_field",onSubmitValue:function(e,t){return(0,o.Z1)({data_fields:b,data_fields_names:_})},required:Object.values(y).includes(!0),onSubmitKey:"",value:null},{name:"client_company",value:t,required:!0,onSubmitKey:""},{name:"client_user",value:null==a?void 0:a.id,required:!0,onSubmitKey:""},{name:"business_company",value:null==v?void 0:v.id,onSubmitKey:""},{name:"priority",value:{name:"Normal",code:"NORMAL"},onSubmitValue:function(e){return u()(e,"code")},type:"object",onSubmitKey:""},{name:"temp_sub",value:null,onSubmitKey:""},{name:"is_feedback",value:!0,onSubmitKey:""}],onSuccess:function(t,a){var n;a(),F({message:e("appeal_send_success"),variant:"success"}),F({message:e("you_can_use_opened_chat"),variant:"success",duration:5e3}),D({status:null==t||null===(n=t.status)||void 0===n?void 0:n.id,case:null==t?void 0:t.id,isSupportCase:!0},!0)},onError:function(e,t){var a,n;t(),F({message:null==e||null===(a=e.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message,variant:"error"})},children:function(e){var t=e.isSubmitting,a=e.values,n=e.setFieldValue,s=(e.errors,e.setFieldError,e.resetForm);return(0,p.jsx)(R,{values:a,setFieldValue:n,resetForm:s,isSubmitting:t,state:c,data_fields:b,data_fields_names:_,data_fields_errors:y,setState:f,titleRef:h,departmentRef:x})}}):null})}function F(){var e=(0,m.$G)().t;return(0,p.jsxs)("div",{className:"relative flex min-h-full max-w-full flex-grow flex-col p-4",children:[(0,p.jsx)("h2",{className:"mr-5 mb-4 py-4 text-xl font-bold dark:text-white md:text-3xl",children:e("support_page_title")}),(0,p.jsx)(D,{})]})}var C=function(){return(0,p.jsx)(s.SV,{children:(0,p.jsx)(F,{})})}}}]);
//# sourceMappingURL=289.31680e72.chunk.js.map