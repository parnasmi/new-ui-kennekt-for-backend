!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="13a5a7f5-8b75-470e-a3be-8908cab571a9",e._sentryDebugIdIdentifier="sentry-dbid-13a5a7f5-8b75-470e-a3be-8908cab571a9")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"a086bfaddc61e7dbbcac0a9c42145052439dbbf3"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[4601],{52006:function(e,t,n){n.d(t,{Z:function(){return d}});var a=n(42982),r=(n(72791),n(27945)),l=n(40084),i=n(31102),s=n(40133),o=n(80184);function c(e){switch(e){case"member":return{label:"Member",value:"member"};case"admin":return{label:"Admin",value:"admin"};case"manager":return{label:"Manager",value:"manager"};default:return null}}function d(e){var t=e.entity,n=e.onSuccess,d=(0,l.m)().companyId,u=(0,i.r1)().updateEntities,m=(0,i.eC)().showNotification;return t?(0,o.jsx)("div",{children:d?(0,o.jsx)(r.Z.Main,{entity:"staffEmployee",name:"staffEmployee-".concat(d),url:"".concat(d,"/employee/").concat(t.id,"/"),method:"patch",id:t.id,primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},updateData:!0,fields:[{name:"avatar",required:!1,value:null===t||void 0===t?void 0:t.avatar,onSubmitKey:"",type:"object",onSubmitValue:function(e){return e||null}},{name:"first_name",required:!0,value:null===t||void 0===t?void 0:t.first_name,onSubmitKey:""},{name:"username",required:!0,value:null===t||void 0===t?void 0:t.username,onSubmitKey:""},{name:"last_name",required:!0,value:null===t||void 0===t?void 0:t.last_name,onSubmitKey:""},{name:"mobile",required:!0,value:null===t||void 0===t?void 0:t.mobile,onSubmitKey:""},{name:"roles",required:!0,value:c(null===t||void 0===t?void 0:t.roles[0]),type:"object",onSubmitKey:"",onSubmitValue:function(e){return[e.value]}},{name:"departments",onSubmitValue:function(e){return e.reduce((function(e,t){return[].concat((0,a.Z)(e),[{id:t.value}])}),[])},required:!0,type:"array",onSubmitKey:""},{name:"can_send_news",required:!1,value:!0,onSubmitKey:""}],onSuccess:function(e,a){m({message:"Success! "}),u({entity:"staffEmployee",entityId:null===t||void 0===t?void 0:t.id,updatingData:{departments:null===e||void 0===e?void 0:e.departments}}),a(),n()},onError:function(e,t){var n,a,r;m({message:null!==(n=null===e||void 0===e||null===(a=e.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)&&void 0!==n?n:"Something went wrong",variant:"error"}),t()},children:function(e){var a=e.isSubmitting,r=e.values,l=e.setFieldValue,i=e.errors,c=e.setFieldError,d=e.resetForm;return(0,o.jsx)(s.Z,{values:r,setFieldValue:l,setFieldError:c,isSubmitting:a,errors:i,closeModal:n,resetForm:d,departments:null===t||void 0===t?void 0:t.departments,isCreate:!1,isBeingEditedUserOwner:t.is_business_owner})}}):null}):null}d.defaultProps={onSuccess:function(){}}},40133:function(e,t,n){n.d(t,{Z:function(){return k}});var a=n(1413),r=n(42982),l=n(70885),i=n(72791),s=n(26864),o=n(42339),c=n(55248),d=n(72248),u=n(70629),m=n(40084),f=n(12714),p=n(26181),v=n.n(p),h=n(78820),b=n(9478),g=n(35741),y=n(98741),x=n(31102),j=n(97689),w=n(28182),_=n(80184),S="".concat(b.Z.PUBLIC_ASSETS,"img"),N=[{label:"Admin",value:"admin"},{label:"Manager",value:"manager"},{label:"Member",value:"member"}];function k(e){var t,n,p=e.values,b=e.setFieldValue,k=(e.setFieldError,e.isSubmitting),E=e.errors,C=e.closeModal,Z=e.resetForm,D=e.isCreate,F=e.departments,P=e.formValuesSetter,T=void 0===P?function(){}:P,V=e.isBeingEditedUserOwner,A=void 0!==V&&V,M=(0,m.m)(),I=M.companyId,K=M.isDarkMode,L=(0,j.a)(),q=L.company,O=L.userData,R=(0,x.h9)({canSend:!D&&p.can_send_news}),U=R.checked,z=(R.handleChange,(0,i.useState)(null)),B=(0,l.Z)(z,2),X=B[0],Y=B[1],H=(0,i.useState)(!1),G=(0,l.Z)(H,2),J=G[0],Q=G[1],W=(0,i.useState)(D?null===p||void 0===p?void 0:p.avatar:null),$=(0,l.Z)(W,2),ee=$[0],te=$[1],ne=O.id===(null===q||void 0===q||null===(t=q.company)||void 0===t||null===(n=t.owner)||void 0===n?void 0:n.id),ae=(0,i.useState)({clientDeps:F?F.reduce((function(e,t){return t.is_staff?(0,r.Z)(e):[].concat((0,r.Z)(e),[{value:t.id,label:t.name}])}),[]):[],staffDeps:F?F.reduce((function(e,t){return t.is_staff?[].concat((0,r.Z)(e),[{value:t.id,label:t.name}]):(0,r.Z)(e)}),[]):[]}),re=(0,l.Z)(ae,2),le=re[0],ie=re[1],se=[],oe=[];(0,i.useEffect)((function(){ee&&b("avatar",ee)}),[ee]);var ce=le.clientDeps,de=le.staffDeps;return(0,i.useEffect)((function(){b("departments",[].concat((0,r.Z)(ce),(0,r.Z)(de)))}),[le]),(0,i.useEffect)((function(){if(D){var e=["first_name","username","last_name","mobile","departments"],t=Object.keys(p).filter((function(t){if((Array.isArray(p[t])?p[t].length:p[t])&&e.includes(t))return p[t]}));T(t)}}),[p]),(0,i.useEffect)((function(){b("can_send_news",U.canSend)}),[U.canSend]),(0,_.jsxs)("div",{id:"department-form",children:[(0,_.jsxs)("div",{className:"branch-form__header flex-center-between -mt-5 border-b border-kgrey-dark-1/30 px-6 py-4",children:[(0,_.jsx)("div",{className:"branch-form__heading font-base font-medium",children:"".concat(D?"Create new":"Edit"," staff")}),D?(0,_.jsx)("div",{className:"branch-form__reset cursor-pointer text-sm text-kgrey transition hover:text-kdark",onClick:Z,children:"Clear"}):null]}),(0,_.jsxs)("div",{className:" w-100 p-6",children:[(0,_.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:"Profile photo"}),(0,_.jsxs)("div",{className:"mb-5 flex items-center",children:[(0,_.jsxs)("div",{className:"user-avatar-box__display flex-centered relative  h-20 w-20 overflow-hidden rounded-full dark:bg-kdark-lighter",children:[(0,_.jsx)("img",{src:D?v()(ee,"thumbnail_150")||"".concat(S,"/chat-placeholder.png"):v()(null===p||void 0===p?void 0:p.avatar,"thumbnail_150")||"".concat(S,"/chat-placeholder.png"),alt:"",className:"object-fit"}),null!==X&&(0,_.jsxs)("div",{className:"absolute top-1/2 left-1/2 z-10 h-10 w-10 -translate-y-1/2 -translate-x-1/2",children:[(0,_.jsx)("div",{className:"upload-media-spinner",children:(0,_.jsx)(c.aN,{variant:"determinate",value:X})}),(0,_.jsx)("div",{onClick:function(){Q(!0),Y(null)},className:"absolute top-1/2 left-1/2 z-20 h-8 w-8 -translate-y-1/2 -translate-x-1/2 cursor-pointer text-3xl text-primary-dark transition hover:text-primary",children:(0,_.jsx)(h.SV5,{})})]})]}),(0,_.jsx)("div",{className:"ml-5",children:(0,_.jsx)(c.bA,{uploadMeta:X,setUploadMeta:Y,cancelSending:J,setCancelSending:Q,setFile:te})})]}),(0,_.jsx)(s.gN,{label:"First name:",name:"first_name",component:o.Mg,placeholder:"Enter First name"}),(0,_.jsx)(s.gN,{label:"Last name",name:"last_name",component:o.Mg,placeholder:"Enter Last name"}),(0,_.jsx)(s.gN,{type:"email",label:"Email",name:"username",component:o.Mg,placeholder:"Enter Email"}),(0,_.jsx)(s.gN,{label:"Phone number",name:"mobile",component:o.UO,placeholder:"Enter company mobile phone number",enableSearch:!0,onChangeHandler:b}),(0,_.jsxs)("div",{className:"row align-user-start remove-inner-label mb-3.5",children:[(0,_.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:"Staff Departments"}),(0,_.jsx)(g.Z.All,{entity:"tree",name:"AllTreeDepartments-Staff-".concat(I),url:"/".concat(I,"/departments/tree/"),params:{limit:100,extra:{is_staff:"True"}},children:function(e){var t=e.items,n=e.isFetched;return se=n&&(0,y.w)(t),(0,_.jsx)(_.Fragment,{children:n?(0,_.jsx)("div",{children:(0,_.jsx)(f.ZP,(0,a.Z)({getPopupContainer:function(e){return e.parentNode},className:(0,w.Z)("w-full",{"tree-select-dark-mode":K}),transitionName:"rc-tree-select-dropdown-slide-up",choiceTransitionName:"rc-tree-select-selection__choice-zoom",dropdownStyle:{overflow:"auto"},dropdownPopupAlign:{overflow:{adjustY:0,adjustX:0},offset:[0,2]},placeholder:(0,_.jsx)("i",{children:"Select Staff Departments"}),searchPlaceholder:"please search",treeLine:!0,maxTagTextLength:10,multiple:!0,allowClear:!0,autoClearSearchValue:!0,treeData:se,treeNodeFilterProp:"title",treeCheckable:!0,treeCheckStrictly:!0,treeDefaultExpandAll:!D,showCheckedStrategy:f.hT,onChange:function(e){ie((function(t){return(0,a.Z)((0,a.Z)({},t),{},{staffDeps:e})}))}},D?null:{value:(0,r.Z)(de)}))}):(0,_.jsx)("div",{className:"flex justify-center",children:(0,_.jsx)(c.aN,{})})})}})]}),(0,_.jsxs)("div",{className:"mb-3.5",children:[(0,_.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:"Client Departments"}),(0,_.jsx)(g.Z.All,{entity:"tree",name:"AllTreeDepartments-Client-".concat(I),url:"/".concat(I,"/departments/tree/"),params:{limit:100,extra:{is_staff:"False"}},children:function(e){var t=e.items,n=e.isFetched;return oe=n&&(0,y.w)(t),(0,_.jsx)(_.Fragment,{children:n?(0,_.jsx)("div",{children:(0,_.jsx)(f.ZP,(0,a.Z)({getPopupContainer:function(e){return e.parentNode},className:(0,w.Z)("w-full",{"tree-select-dark-mode":K}),transitionName:"rc-tree-select-dropdown-slide-up",choiceTransitionName:"rc-tree-select-selection__choice-zoom",dropdownStyle:{overflow:"auto"},dropdownPopupAlign:{overflow:{adjustY:0,adjustX:0},offset:[0,2]},placeholder:(0,_.jsx)("i",{children:"Select \u0421lient Departments"}),searchPlaceholder:"please search",treeLine:!0,maxTagTextLength:10,multiple:!0,allowClear:!0,autoClearSearchValue:!0,treeData:oe,treeNodeFilterProp:"title",treeCheckable:!0,treeCheckStrictly:!0,treeDefaultExpandAll:!D,showCheckedStrategy:f.hT,onChange:function(e){ie((function(t){return(0,a.Z)((0,a.Z)({},t),{},{clientDeps:e})}))}},D?null:{value:(0,r.Z)(ce)}))}):(0,_.jsx)("div",{className:"flex justify-center",children:(0,_.jsx)(c.aN,{})})})}})]}),(0,_.jsxs)("div",{className:"mb-3.5",children:[(0,_.jsx)("div",{className:"mb-2 ml-2 text-sm font-light text-kgrey-menuText",children:"Roles"}),(0,_.jsx)(s.gN,{component:o.mg,styles:d.gb,name:"roles",defaultValue:N[2],options:[].concat(N,(0,r.Z)(ne?[{label:"Owner",value:"owner"}]:[])),isSearchable:!u.tq,isDisabled:A})]})]}),(0,_.jsxs)("div",{className:"branch-form__footer flex justify-end px-6 pt-4 pb-9",children:[(0,_.jsx)(c.Ik,{className:"mr-5 border border-kgrey text-kgrey",color:"default",onClick:C,children:"Cancel"}),(0,_.jsx)(c.Ik,{className:"dark:text-white dark:hover:bg-primary-300 dark:focus:ring-primary-300",type:"submit",isSubmitting:k,color:"primary",isDisabled:Boolean(null===E||void 0===E?void 0:E.departments),children:D?"Create":"Update"})]}),k?(0,_.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-70",children:(0,_.jsx)(c.aN,{})}):null]})}k.defaultProps={isCreate:!0,department:null,resetForm:function(){}}},58237:function(e,t,n){n.d(t,{O:function(){return f}});var a=n(15861),r=n(70885),l=n(64687),i=n.n(l),s=n(31102),o=n(40084),c=n(49935),d=n(87818),u=n(72791),m=n(97689);function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=(0,o.m)(),n=t.companyId,l=(0,m.a)(),f=l.companies,p=(0,d.I0)(),v=(0,s.eC)(),h=v.showNotification,b=(0,s.r1)(),g=b.updateEntities,y=(0,s.e)({pageKey:"page",entity:"staffEmployee",entityName:"staffEmployee-".concat(n)}),x=y.forwardToPreviousPage,j=(0,u.useState)(0),w=(0,r.Z)(j,2),_=w[0],S=w[1],N=(0,s.iR)(),k=N.visible,E=N.showVisible,C=N.loading,Z=N.toggleLoading,D=N.closePopup,F=(0,s.iR)(),P=F.visible,T=F.showVisible,V=F.closePopup,A=(0,u.useMemo)((function(){return"/".concat(n,"/companies/staffs_count/")}),[n]),M=(0,s.bK)({url:A}),I=M.fetchData,K=M.response,L=M.loading;(0,u.useEffect)((function(){n&&(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:case"end":return e.stop()}}),e)})))()}),[n]),(0,u.useEffect)((function(){if(n&&f.length){var e=f.find((function(e){return e.company.id===n})),t=null===e||void 0===e?void 0:e.company.comp_subscription;t&&S(t.paid_staffs_count)}}),[f,n]);var q=function(){g({entity:"staffEmployee",entityId:null===k||void 0===k?void 0:k.id,updatingData:{roles:[]}})},O=function(t){Z(),p((0,c.Bi)({entity:"staffEmployee",name:"staffEmployee-".concat(n),method:"delete",url:"/".concat(n,"/employee/").concat(t.id,"/"),deleteData:!0,id:t.id,cb:{success:function(){h({message:"Successfully deleted",variant:"success"}),p((0,c.KX)("staffEmployee","staffEmployee-".concat(n))),q(),e(),x()},error:function(e){var t,n;h({message:null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message,variant:"error"})},finally:function(){Z(),D()}},params:{},primaryKey:"id",values:{}}))};return{deleteLoading:C,handleClientDelete:O,showDeleteVisible:E,closeDeletePopup:D,deleteVisible:k,editVisible:P,showEditVisible:T,closeEditPopup:V,staffCountLoading:L,staffCountResponse:K,paidMemberCount:_,fetchStaffCount:I}}},98741:function(e,t,n){n.d(t,{w:function(){return r}});var a=n(42982),r=function e(t){return t.reduce((function(t,n){if(!(n.sub_departments.length>0))return[].concat((0,a.Z)(t),[{title:n.name,key:n.id,value:n.id}]);for(;n.sub_departments.length>0;)return[].concat((0,a.Z)(t),[{title:n.name,key:n.id,value:n.id,children:e(n.sub_departments)}])}),[])}}}]);
//# sourceMappingURL=4601.deed0cf9.chunk.js.map