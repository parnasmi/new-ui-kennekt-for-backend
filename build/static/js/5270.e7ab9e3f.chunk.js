!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5c1e51d5-3f1b-4f9d-8a51-3177c7135a7f",e._sentryDebugIdIdentifier="sentry-dbid-5c1e51d5-3f1b-4f9d-8a51-3177c7135a7f")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"a086bfaddc61e7dbbcac0a9c42145052439dbbf3"},(self.webpackChunkkennekt_front_end_client=self.webpackChunkkennekt_front_end_client||[]).push([[5270],{43682:function(e,n,t){t.d(n,{I:function(){return r},m:function(){return f}});var a=t(70885),s=t(72791),i=t(31102);function r(){var e=s.useState(0),n=(0,a.Z)(e,2),t=n[0],r=n[1],l=s.useState("Billing"),o=(0,a.Z)(l,2),c=o[0],u=o[1],d=(0,i.tv)(),f=d.location,m=d.match,h=m.url,p=m.path,x=(0,i.gQ)("Billing"),v=x.unreadCasesQuantity,b=x.isHidden;return(0,s.useEffect)((function(){var e=f.pathname.split("/").filter(Boolean).filter(String),n=e[e.length-1]||"";!function(){switch(n){case"billing":r(0),u("Billing");break;case"invoice":r(1),u("Invoice");break;default:;}}()}),[f]),{primeTab:t,pageName:c,url:h,path:p,unreadCasesQuantity:v,setPrimeTab:r,isHidden:b,handleChangePrime:function(e,n){r(n)}}}var l=t(15861),o=t(64687),c=t.n(o),u=t(40084),d=t(97689);function f(){var e=(0,u.m)().companyId,n=(0,d.a)().companies,t=(0,i.tv)().history,r=(0,s.useState)(!1),o=(0,a.Z)(r,2),f=o[0],m=o[1],h=(0,s.useState)(!1),p=(0,a.Z)(h,2),x=p[0],v=p[1],b=(0,i.eC)().showNotification,y=(0,s.useState)(!1),g=(0,a.Z)(y,2),j=g[0],w=g[1],k=(0,s.useState)(null),S=(0,a.Z)(k,2),C=S[0],N=S[1],_=(0,i.bK)({url:"/".concat(e,"/payment/").concat(e,"/cancel-subscription/"),method:"put",cb:{success:function(){b({message:"Your subscription has been cancelled",variant:"success"}),m(!1),v(!1)},error:function(e,n){var t,a;b({message:(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Something went wrong",variant:"error"}),m(!1)}}}).fetchData,E=(0,i.bK)({url:"/payment/".concat(e,"/invoices/?page_size=10"),cb:{success:function(e){var n;null!==e&&void 0!==e&&null!==(n=e.results)&&void 0!==n&&n.length&&w(!0)},error:function(e,n){}}}).fetchData;(0,s.useEffect)((function(){if(E(),e&&n.length){var t=n.find((function(n){return n.company.id===e})),a=null===t||void 0===t?void 0:t.company.comp_subscription;a&&N(a)}}),[n,e]);var Z=(0,s.useCallback)((0,l.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,_();case 3:case"end":return e.stop()}}),e)}))),[]);return{navigateToCheckout:(0,s.useCallback)((function(){return t.push("/checkout")}),[]),subscription:C,handleCancelRequest:Z,setCancelSubscription:v,cancelSubscription:x,cancelLoading:f,hasUserAlreadyPaidInvoice:j}}},55270:function(e,n,t){t.r(n),t.d(n,{default:function(){return O}});var a=t(70885),s=t(72791),i=t(55248),r=t(1413),l=t(80184),o=(0,s.createContext)(null),c=function(e,n){return"SET_SEARCH_QUERY"===n.type?(0,r.Z)((0,r.Z)({},e),{},{searchQuery:n.payload}):e};function u(e){var n=e.children,t=(0,s.useReducer)(c,{searchQuery:""}),i=(0,a.Z)(t,2),r=i[0],u=i[1],d=(0,s.useCallback)((function(e){u({type:"SET_SEARCH_QUERY",payload:e})}),[]),f={searchQuery:r.searchQuery,setSearchQuery:d};return(0,l.jsx)(o.Provider,{value:f,children:n})}var d=function(){var e=(0,s.useContext)(o);if(!e)throw new Error("useBusinessContext must be used within the BusinessContextProvider");return e},f=t(54270),m=t(31102),h=t(85880);function p(){var e=d(),n=e.searchQuery,t=e.setSearchQuery;return(0,l.jsxs)("div",{className:"group-sidebar__search relative",children:[(0,l.jsx)("input",{type:"search",value:n,className:"group-sidebar__search-input w-full border-b outline-none md:w-36 border-kgrey-border-solid dark:border-white dark:text-white pl-7 transition focus:border-primary dark:focus:border-primary placeholder-[rgba(45, 45, 45, 0.3)] pt-2 pb-2 dark:bg-kdark",placeholder:"Search for staff",onChange:function(e){return t(e.target.value)}}),(0,l.jsx)("div",{className:"absolute top-1/2 left-0 -translate-y-1/2",children:(0,l.jsx)("div",{className:"text-kgrey",children:(0,l.jsx)(h.lnn,{})})})]})}var x=t(40084),v=t(35741),b=t(84230),y=t(39126),g=t(51625),j=t(22553),w=t(52006),k=t(58237),S=t(19670),C=t(91523),N=t(28182),_=t(49935),E=t(87818),Z=t(97689),P=t(1667),A="No mobile number";function D(e){var n,t,s=e.fetchStaffCount,r=void 0===s?function(){}:s,o=(0,x.m)(),c=o.companyId,u=o.isAdmin,f=d().searchQuery,h=(0,Z.a)(),p=h.company,D=h.userData,H=(0,m.h0)(),R=H.page,V=H.handlePage,B=(0,m.tv)(),I=B.match,Q=B.history,K=(0,m.eC)().showNotification,O=(0,E.I0)(),Y=(0,m.Zp)().reloadEntityAll,L=(null===D||void 0===D?void 0:D.id)===(null===p||void 0===p||null===(n=p.company)||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.id),M=(0,k.O)(r),U=M.deleteLoading,F=M.handleClientDelete,T=M.showDeleteVisible,q=M.closeDeletePopup,G=M.deleteVisible,W=M.editVisible,z=M.showEditVisible,J=M.closeEditPopup,X=M.staffCountLoading,$=(0,j.Z)(f,500),ee=(0,a.Z)($,1)[0],ne=(0,m.iR)(),te=ne.visible,ae=ne.showVisible,se=ne.loading,ie=ne.toggleLoading,re=ne.closePopup,le=function(){return function(){return e=te,ie(),void O((0,_.Bi)({entity:"staffEmployee",name:"staffEmployee-".concat(c),method:"post",url:"/".concat(c,"/employee/").concat(e,"/resend_invitation/"),values:{},cb:{success:function(){Y({entity:"staffEmployee",name:"staffEmployee-".concat(c),url:"/".concat(c,"/employee/"),params:{page:1,limit:10}}),re(),K({message:"Successfully resended",variant:"success"})},error:function(e){K({message:"Something went wrong",variant:"error"})},finally:function(){ie()}},params:{},primaryKey:"id"}));var e}};return(0,l.jsx)("div",{children:c?(0,l.jsx)(v.Z.All,{entity:"staffEmployee",name:"staffEmployee-".concat(c),url:"/".concat(c,"/employee/"),replaceIds:!0,params:{limit:10,extra:{search:ee},page:R},children:function(e){var n=e.items,t=e.isFetched,a=e.meta,s=n.map((function(e){return e}));return(0,l.jsxs)("div",{children:[(0,l.jsxs)(b.xJ,{classes:{root:"relative "},children:[(0,l.jsxs)(i.k6,{"aria-label":"simple table",classes:{root:"table-fixed dark-mode-styled-table"},children:[(0,l.jsx)(b.ss,{children:(0,l.jsxs)(i.AF,{children:[(0,l.jsx)(i.EU,{style:{width:"22%"},children:"Full name"}),(0,l.jsx)(i.EU,{style:{width:"24%"},children:"Email"}),(0,l.jsx)(i.EU,{style:{width:"18%"},children:"Phone number"}),(0,l.jsx)(i.EU,{style:{width:"12%"},children:"Role"}),(0,l.jsx)(i.EU,{style:{width:"10%"},children:"Status"}),(0,l.jsx)(i.EU,{style:{width:"14%",textAlign:"center"},children:"Actions"})]})}),(0,l.jsx)(b.RM,{children:s.map((function(e){var n=e.id,t=e.first_name,a=e.last_name,s=e.username,r=e.mobile,o=e.roles,c=e.state,d=e.avatar,f=e.is_business_owner,m=r?"+"===r[0]?r:"+".concat(r):A;return(0,l.jsxs)(i.AF,{children:[(0,l.jsx)(i.Yk,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"h-9 w-9 flex-shrink-0",children:(0,S.w)((null===d||void 0===d?void 0:d.thumbnail)||(null===d||void 0===d?void 0:d.thumbnail_150),t)}),"Pending"===c?(0,l.jsx)("div",{className:"truncate",children:(0,l.jsxs)("span",{className:"ml-2 text-sm font-medium",children:[t," ",a]})}):(0,l.jsx)(C.rU,{className:"truncate",to:"".concat(I.path,"/view/").concat(e.id),children:(0,l.jsxs)("span",{className:"ml-2 text-sm font-medium text-primary transition hover:text-primary-dark",children:[t," ",a]})})]})}),(0,l.jsx)(i.Yk,{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(0,l.jsx)("span",{className:"test-kdark-text text-sm",children:s})}),(0,l.jsx)(i.Yk,{children:m?(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(y.lfG,{color:"#979797",size:"15px"}),(0,l.jsx)("a",{href:"tel:".concat(m),className:(0,N.Z)("test-kdark-text ml-2 align-middle text-sm ",{"text-primary hover:text-primary-dark":m!==A,"pointer-events-none":m===A}),children:m})]}):null}),(0,l.jsxs)(i.Yk,{children:[o.map((function(e,n){return(0,l.jsxs)("span",{className:"text-sx text-kgrey",children:[" "+e+" ",o.length>1?(0,l.jsx)("span",{className:"text-kgrey",children:"|"}):null,f?(0,l.jsx)("span",{children:"| owner"}):null]},"".concat(n,"_").concat(e))})),"Pending"===c?(0,l.jsx)(i.Ik,{color:"primary",onClick:function(){return ae(n)},children:"Resend"}):null]}),(0,l.jsx)(i.Yk,{children:(0,l.jsx)(P.N,{status:c,children:c})}),(0,l.jsx)(i.Yk,{children:(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[!f&&(0,l.jsx)(i.cP.DeleteButton,{isDisabled:!L&&(f||!u),clickHandler:function(){return T(e)}}),(0,l.jsx)(i.cP.ViewButton,{isDisabled:!u||"Pending"===c,clickHandler:function(){return Q.push("".concat(I.path,"/view/").concat(n))}}),(0,l.jsx)(i.cP.EditButton,{isDisabled:L?"Pending"===c:f||!u||"Pending"===c,clickHandler:function(){return z(e)}})]})})]},n)}))})]}),t&&X&&(0,l.jsx)(i.aN,{tiled:!0,withOverlay:!0})]}),(0,l.jsx)(i.sm,{featureHandler:function(){return F(G)},isOpen:Boolean(G),toggleHandler:q,title:'Are you sure you want to delete the following staff member: "'.concat(null===G||void 0===G?void 0:G.first_name," ").concat(null===G||void 0===G?void 0:G.last_name,'"'),hasLoader:!0,isLoading:U}),(0,l.jsx)(i.sm,{featureHandler:le(),isOpen:Boolean(te),toggleHandler:re,title:"Are you sure to resend the Request",hasLoader:!0,isLoading:se}),(0,l.jsx)(b.Cx,{handleModalOpen:J,open:Boolean(W),maxWidth:490,minWidth:490,scrollable:!0,noPadding:!0,children:(0,l.jsx)(w.Z,{entity:W,onSuccess:J})}),(0,l.jsxs)("div",{className:"news__pagination my-4 flex items-center justify-between",children:[n.length?(0,l.jsx)(g.Z,{count:null===a||void 0===a?void 0:a.last_page,page:R?+R:1,defaultPage:6,siblingCount:1,color:"primary",onChange:V}):null,(0,l.jsx)("div",{className:"ml-4",children:(0,l.jsxs)("div",{className:"text-base font-medium dark:text-white",children:["Staff Count:"," ",(0,l.jsx)("span",{className:"ml-2 text-base font-semibold text-primary ",children:null===a||void 0===a?void 0:a.count})]})})]})]})}}):(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(i.aN,{})})})}function H(e){return(0,l.jsx)(i.SV,{children:(0,l.jsx)(D,(0,r.Z)({},e))})}var R=t(42982),V=t(27945),B=t(40133);function I(e){var n=e.modalHandler,t=e.hasToShowGuard,a=e.formValuesSetter,i=e.fetchStaffCount,r=(0,x.m)().companyId,o=(0,s.useCallback)((function(){return n(null)}),[]),c=(0,m.eC)().showNotification;return(0,l.jsx)("div",{children:r?(0,l.jsx)(V.Z.Main,{entity:"staffEmployee",name:"staffEmployee-".concat(r),url:"".concat(r,"/employee/"),method:"post",primaryKey:"id",sendAsFormData:!1,normalizeData:function(e){return e},prependData:!0,fields:[{name:"avatar",required:!1,value:null,onSubmitKey:"",type:"object",onSubmitValue:function(e){return e||null}},{name:"first_name",required:!0,value:"",onSubmitKey:""},{name:"username",required:!0,value:"",onSubmitKey:""},{name:"last_name",required:!0,value:"",onSubmitKey:""},{name:"mobile",value:"",onSubmitKey:""},{name:"roles",required:!0,value:{label:"Member",value:"member"},type:"object",onSubmitKey:"",onSubmitValue:function(e){return[e.value]}},{name:"departments",onSubmitValue:function(e){return e.reduce((function(e,n){return[].concat((0,R.Z)(e),[{id:n.value}])}),[])},value:[],required:!1,type:"array",onSubmitKey:""},{name:"can_send_news",required:!1,value:!0,onSubmitKey:""}],onSuccess:function(e,n){c({message:"Success! "}),i(),n(),o()},onError:function(e,n){var t,a,s;c({message:null!==(t=null===e||void 0===e||null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)&&void 0!==t?t:"Something went wrong",variant:"error"}),n()},children:function(e){var n=e.isSubmitting,s=e.values,i=e.setFieldValue,r=e.errors,o=e.setFieldError,c=e.resetForm;return(0,l.jsx)(B.Z,{values:s,setFieldValue:i,setFieldError:o,isSubmitting:n,errors:r,formValuesSetter:a,closeModal:t,resetForm:c})}}):null})}I.defaultProps={onSuccess:function(){}};var Q=t(43682);function K(){var e,n,t,r=(0,x.m)(),o=r.isAdmin,c=r.isPermitted,u=(0,m.gQ)("Staff Management"),d=u.unreadCasesQuantity,h=u.isHidden,v=(0,s.useState)(!1),y=(0,a.Z)(v,2),g=y[0],j=y[1],w=(0,m.Tn)(),S=w.formValues,C=w.guardOpen,_=w.setGuardOpen,E=w.formValuesSetter,P=(0,s.useState)(!1),A=(0,a.Z)(P,2),D=A[0],R=A[1],V=(0,k.O)(),B=V.staffCountLoading,K=V.staffCountResponse,O=V.paidMemberCount,Y=V.fetchStaffCount,L=(0,m.tv)().history,M=(0,Q.m)().subscription,U=(0,Z.a)(),F=U.company,T=U.userData,q=(null===F||void 0===F||null===(e=F.company)||void 0===e||null===(n=e.owner)||void 0===n?void 0:n.id)===T.id,G=(0,s.useRef)({});G.current.subscription=M,G.current.staffCountResponse=K,G.current.paidMemberCount=O;var W=(0,s.useCallback)((function(){var e=G.current||{},n=e.staffCountResponse,t=e.subscription,a=e.paidMemberCount;(null===n||void 0===n?void 0:n.staffs_count)<a||"TRIAL"===(null===t||void 0===t?void 0:t.subscription_type)&&null!==t&&void 0!==t&&t.is_available?j((function(e){return!e})):R(!0)}),[K,M,O]),z=(0,s.useCallback)((function(){_((function(e){return!e}))}),[]),J=(0,s.useCallback)((function(){_(!1),E([]),W()}),[g]),X=(0,s.useCallback)((function(){S.length?_(!0):W()}),[S]);return(0,l.jsxs)("div",{className:"relative flex min-h-full max-w-full flex-grow flex-col p-4",children:[(!h||!q||0===d)&&(0,l.jsx)(f.q,{children:(0,l.jsx)("title",{children:"KENNEKT | Staff Management"})}),(0,l.jsxs)("div",{className:"mb-5",children:[(0,l.jsx)("div",{className:" absolute top-0 left-0 w-full bg-kred-pink-200",children:o?null:(0,l.jsx)("p",{className:"my-1 text-center text-xs text-kred-pink",children:"You do not have permission to perform some actions, please check with admin"})}),(0,l.jsxs)("div",{className:"mt-6 flex w-full flex-wrap items-center justify-between",children:[(0,l.jsxs)("div",{className:"mb-4 flex flex-1 items-center font-bold",children:[(0,l.jsx)("h2",{className:"text-xl dark:text-white md:text-3xl ",children:"Staff Management"}),M&&M.order&&M.paid_staffs_count?(0,l.jsxs)("span",{className:"ml-4",children:[(0,l.jsx)("span",{className:"mr-1 text-sm font-light text-kgrey-dark-3 dark:text-white",children:"Users count:"}),(0,l.jsxs)("span",{className:"text-base font-semibold text-primary",children:[null!==(t=null===K||void 0===K?void 0:K.staffs_count)&&void 0!==t?t:0,"/",M.paid_staffs_count]})]}):null]}),(0,l.jsxs)("div",{className:"ml-auto mb-4  flex max-w-full items-center",children:[(0,l.jsx)(p,{}),(0,l.jsx)(b.aW,{disabled:!c,type:"button",onClick:W,className:(0,N.Z)({"pointer-events-none opacity-20":B}),children:"Add staff"})]})]})]}),(0,l.jsx)(H,{fetchStaffCount:Y}),(0,l.jsx)(i.sm,{featureHandler:function(){return L.push("/checkout")},isOpen:D,toggleHandler:function(){R(!1)},title:"You have reached limit to add staffs. Open checkout page?"}),(0,l.jsx)(b.Cx,{handleModalOpen:function(){S.length?_(!0):W()},open:g,maxWidth:446,noPadding:!0,scrollable:!0,children:(0,l.jsx)(I,{modalHandler:W,hasToShowGuard:X,formValuesSetter:E,fetchStaffCount:Y})}),(0,l.jsx)(i.sm,{featureHandler:J,isOpen:C,toggleHandler:z,title:"You have unsaved changes, Are you sure to cancel?"})]})}var O=function(){return(0,l.jsx)(i.SV,{children:(0,l.jsx)(u,{children:(0,l.jsx)(K,{})})})}},1667:function(e,n,t){t.d(n,{N:function(){return i}});var a=t(28182),s=(t(72791),t(80184));function i(e){var n=e.status,t=e.children;return(0,s.jsx)("span",{className:(0,a.Z)("inline-block rounded-4xl bg-primary py-0.5 px-5 text-10px uppercase leading-4 text-white",{"bg-kgrey-inputBg text-kdark":"Pending"===n,"bg-primary-dark":"Logged"===n}),children:null!==t&&void 0!==t?t:"Accepted"})}},19670:function(e,n,t){t.d(n,{w:function(){return i}});var a=t(70272),s=t(80184),i=function(e,n){return e?(0,s.jsx)(a.Z,{className:"inline-block",alt:n||"Business icon",src:e,style:{width:"100%",height:"100%"}}):(0,s.jsx)(a.Z,{className:"inline-block",style:{color:"#fff",width:"100%",height:"100%"},children:n?n[0].toUpperCase():null})}}}]);
//# sourceMappingURL=5270.e7ab9e3f.chunk.js.map