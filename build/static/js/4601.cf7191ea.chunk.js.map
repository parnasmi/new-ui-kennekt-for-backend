{"version":3,"file":"static/js/4601.cf7191ea.chunk.js","mappings":"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","sources":["pages/StaffManagement/components/EditStaffForm.tsx","pages/StaffManagement/components/StaffFormElement.tsx","pages/StaffManagement/hooks/useStaffManagement.ts","pages/StaffManagement/utils/convertsTreeSelectData.ts"],"sourcesContent":["import React from 'react';\nimport EntityForm from 'modules/entity/forms';\nimport { useAppState } from 'shared/state';\nimport { useNotistack, useUpdateEntities } from 'shared/hooks';\nimport StaffFormElement from './StaffFormElement';\ntype Props = {\n\tonSuccess: () => void;\n\tentity: any;\n};\nfunction getRole(role: string) {\n\tswitch (role) {\n\t\tcase 'member': {\n\t\t\treturn { label: 'Member', value: 'member' };\n\t\t}\n\t\tcase 'admin': {\n\t\t\treturn { label: 'Admin', value: 'admin' };\n\t\t}\n\t\tcase 'manager': {\n\t\t\treturn { label: 'Manager', value: 'manager' };\n\t\t}\n\t\tdefault:\n\t\t\treturn null;\n\t}\n}\n\nexport default function EditStaffForm({ entity, onSuccess }: Props) {\n\tconst { companyId } = useAppState();\n\tconst { updateEntities } = useUpdateEntities();\n\n\tconst { showNotification } = useNotistack();\n\tif (!entity) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t{companyId ? (\n\t\t\t\t<EntityForm.Main\n\t\t\t\t\tentity=\"staffEmployee\"\n\t\t\t\t\tname={`staffEmployee-${companyId}`}\n\t\t\t\t\turl={`${companyId}/employee/${entity.id}/`}\n\t\t\t\t\tmethod=\"patch\"\n\t\t\t\t\tid={entity.id}\n\t\t\t\t\tprimaryKey=\"id\"\n\t\t\t\t\tsendAsFormData={false}\n\t\t\t\t\tnormalizeData={(data: any) => data}\n\t\t\t\t\tupdateData\n\t\t\t\t\tfields={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'avatar',\n\t\t\t\t\t\t\trequired: false,\n\t\t\t\t\t\t\tvalue: entity?.avatar,\n\t\t\t\t\t\t\tonSubmitKey: '',\n\t\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\t\tonSubmitValue: (value) => (value ? value : null)\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'first_name',\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tvalue: entity?.first_name,\n\t\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'username',\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tvalue: entity?.username,\n\t\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'last_name',\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tvalue: entity?.last_name,\n\t\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'mobile',\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tvalue: entity?.mobile,\n\t\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'roles',\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\tvalue: getRole(entity?.roles[0]),\n\t\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\t\tonSubmitKey: '',\n\t\t\t\t\t\t\tonSubmitValue: (value) => [value.value]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'departments',\n\t\t\t\t\t\t\tonSubmitValue: (value) =>\n\t\t\t\t\t\t\t\tvalue.reduce((acc: any, curr: any) => [...acc, { id: curr.value }], []),\n\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\ttype: 'array',\n\t\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'can_send_news',\n\t\t\t\t\t\t\trequired: false,\n\t\t\t\t\t\t\tvalue: true,\n\t\t\t\t\t\t\tonSubmitKey: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t]}\n\t\t\t\t\tonSuccess={(response, resetForm): any => {\n\t\t\t\t\t\tshowNotification({ message: 'Success! ' });\n\t\t\t\t\t\tupdateEntities({\n\t\t\t\t\t\t\tentity: 'staffEmployee',\n\t\t\t\t\t\t\tentityId: entity?.id,\n\t\t\t\t\t\t\tupdatingData: {\n\t\t\t\t\t\t\t\tdepartments: response?.departments\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresetForm();\n\t\t\t\t\t\tonSuccess();\n\t\t\t\t\t}}\n\t\t\t\t\tonError={(error, resetForm): any => {\n\t\t\t\t\t\tshowNotification({\n\t\t\t\t\t\t\tmessage: error?.response?.data?.message ?? 'Something went wrong',\n\t\t\t\t\t\t\tvariant: 'error'\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tresetForm();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{({ isSubmitting, values, setFieldValue, errors, setFieldError, resetForm }) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<StaffFormElement\n\t\t\t\t\t\t\t\tvalues={values}\n\t\t\t\t\t\t\t\tsetFieldValue={setFieldValue}\n\t\t\t\t\t\t\t\tsetFieldError={setFieldError}\n\t\t\t\t\t\t\t\tisSubmitting={isSubmitting}\n\t\t\t\t\t\t\t\terrors={errors}\n\t\t\t\t\t\t\t\tcloseModal={onSuccess}\n\t\t\t\t\t\t\t\tresetForm={resetForm}\n\t\t\t\t\t\t\t\tdepartments={entity?.departments}\n\t\t\t\t\t\t\t\tisCreate={false}\n\t\t\t\t\t\t\t\tisBeingEditedUserOwner={entity.is_business_owner}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t</EntityForm.Main>\n\t\t\t) : null}\n\t\t</div>\n\t);\n}\n\nEditStaffForm.defaultProps = {\n\tonSuccess: () => {}\n};\n","import React, { useEffect, useState } from 'react';\nimport { Field } from 'formik';\nimport { KntInputField, KntPhoneInputField, SelectField } from 'shared/components/Fields';\nimport { FileUploader, KntButton, Loader } from 'shared/components';\nimport { EntytyFormInstanceProps } from 'shared/typings/formik.types';\nimport { KntTwilioStyle } from 'shared/services';\nimport { isMobile } from 'react-device-detect';\nimport { useAppState } from 'shared/state';\nimport TreeSelect, { SHOW_PARENT } from 'rc-tree-select';\nimport get from 'lodash/get';\nimport { AiOutlineCloseCircle } from 'react-icons/ai';\nimport config from 'config';\n\nimport EntityContainer from 'modules/entity/containers';\nimport { convertToTreeSelectData } from '../utils/convertsTreeSelectData';\nimport { useSwitch } from 'shared/hooks';\nimport { useAuth } from '../../../modules/auth/hooks/useAuth';\nimport clsx from 'clsx';\n\nconst imgPath = `${config.PUBLIC_ASSETS}img`;\n\ntype Props = {\n\tisCreate?: boolean;\n\tdepartments?: any | null;\n\tcloseModal: () => void;\n\tid?: number;\n\tvalues: any;\n\tformValuesSetter?: (fieldValues: string[]) => void;\n\tisBeingEditedUserOwner?: boolean;\n} & EntytyFormInstanceProps;\n\nconst rolesOptions = [\n\t{ label: 'Admin', value: 'admin' },\n\t{ label: 'Manager', value: 'manager' },\n\t{ label: 'Member', value: 'member' }\n];\n\nexport default function StaffFormElement({\n\tvalues,\n\tsetFieldValue,\n\tsetFieldError,\n\tisSubmitting,\n\terrors,\n\tcloseModal,\n\tresetForm,\n\tisCreate,\n\tdepartments,\n\tformValuesSetter = () => {},\n\tisBeingEditedUserOwner = false\n}: Props) {\n\tconst { companyId, isDarkMode } = useAppState();\n\tconst { company, userData } = useAuth();\n\tconst { checked, handleChange } = useSwitch({\n\t\tcanSend: isCreate ? false : values.can_send_news\n\t});\n\n\tconst [uploadMeta, setUploadMeta] = useState<any>(null);\n\tconst [cancelSending, setCancelSending] = useState<any>(false);\n\tconst [avatar, setAvatar] = useState(isCreate ? values?.avatar : null);\n\n\tconst isBusinessOwner = userData.id === company?.company?.owner?.id;\n\n\tconst [deps, setDeps] = useState({\n\t\tclientDeps: departments\n\t\t\t? departments.reduce((acc: any, curr: any) => {\n\t\t\t\t\tif (!curr.is_staff) {\n\t\t\t\t\t\treturn [...acc, { value: curr.id, label: curr.name }];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [...acc];\n\t\t\t\t\t}\n\t\t\t  }, [])\n\t\t\t: [],\n\t\tstaffDeps: departments\n\t\t\t? departments.reduce((acc: any, curr: any) => {\n\t\t\t\t\tif (curr.is_staff) {\n\t\t\t\t\t\treturn [...acc, { value: curr.id, label: curr.name }];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [...acc];\n\t\t\t\t\t}\n\t\t\t  }, [])\n\t\t\t: []\n\t});\n\n\tlet treeDataStaff = [];\n\tlet treeDataClient = [];\n\n\tuseEffect(() => {\n\t\tif (avatar) setFieldValue('avatar', avatar);\n\t}, [avatar]);\n\n\tconst { clientDeps, staffDeps } = deps;\n\n\tuseEffect(() => {\n\t\tsetFieldValue('departments', [...clientDeps, ...staffDeps]);\n\t}, [deps]);\n\n\tuseEffect(() => {\n\t\tif (isCreate) {\n\t\t\tconst checkableFields = ['first_name', 'username', 'last_name', 'mobile', 'departments'];\n\n\t\t\tconst fieldValues = Object.keys(values).filter((field) => {\n\t\t\t\tconst fieldHasValue = Array.isArray(values[field]) ? values[field].length : values[field];\n\t\t\t\tif (fieldHasValue && checkableFields.includes(field)) {\n\t\t\t\t\treturn values[field];\n\t\t\t\t}\n\t\t\t});\n\t\t\tformValuesSetter(fieldValues);\n\t\t}\n\t}, [values]);\n\n\tuseEffect(() => {\n\t\tsetFieldValue('can_send_news', checked.canSend);\n\t}, [checked.canSend]);\n\n\treturn (\n\t\t<div id={'department-form'}>\n\t\t\t<div className=\"branch-form__header flex-center-between -mt-5 border-b border-kgrey-dark-1/30 px-6 py-4\">\n\t\t\t\t<div className=\"branch-form__heading font-base font-medium\">{`${\n\t\t\t\t\tisCreate ? 'Create new' : 'Edit'\n\t\t\t\t} staff`}</div>\n\t\t\t\t{isCreate ? (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"branch-form__reset cursor-pointer text-sm text-kgrey transition hover:text-kdark\"\n\t\t\t\t\t\tonClick={resetForm}\n\t\t\t\t\t>\n\t\t\t\t\t\tClear\n\t\t\t\t\t</div>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t\t<div className=\" w-100 p-6\">\n\t\t\t\t<div className=\"mb-2 ml-2 text-sm font-light text-kgrey-menuText\">Profile photo</div>\n\t\t\t\t<div className=\"mb-5 flex items-center\">\n\t\t\t\t\t<div className=\"user-avatar-box__display flex-centered relative  h-20 w-20 overflow-hidden rounded-full dark:bg-kdark-lighter\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\tisCreate\n\t\t\t\t\t\t\t\t\t? get(avatar, 'thumbnail_150') || `${imgPath}/chat-placeholder.png`\n\t\t\t\t\t\t\t\t\t: get(values?.avatar, 'thumbnail_150') || `${imgPath}/chat-placeholder.png`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\tclassName={'object-fit'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{uploadMeta !== null && (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t'absolute top-1/2 left-1/2 z-10 h-10 w-10 -translate-y-1/2 -translate-x-1/2'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div className=\"upload-media-spinner\">\n\t\t\t\t\t\t\t\t\t<Loader variant=\"determinate\" value={uploadMeta} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tsetCancelSending(true);\n\t\t\t\t\t\t\t\t\t\tsetUploadMeta(null);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t'absolute top-1/2 left-1/2 z-20 h-8 w-8 -translate-y-1/2 -translate-x-1/2 ' +\n\t\t\t\t\t\t\t\t\t\t'cursor-pointer text-3xl text-primary-dark transition hover:text-primary'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<AiOutlineCloseCircle />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"ml-5\">\n\t\t\t\t\t\t<FileUploader\n\t\t\t\t\t\t\tuploadMeta={uploadMeta}\n\t\t\t\t\t\t\tsetUploadMeta={setUploadMeta}\n\t\t\t\t\t\t\tcancelSending={cancelSending}\n\t\t\t\t\t\t\tsetCancelSending={setCancelSending}\n\t\t\t\t\t\t\tsetFile={setAvatar}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<Field\n\t\t\t\t\tlabel=\"First name:\"\n\t\t\t\t\tname=\"first_name\"\n\t\t\t\t\tcomponent={KntInputField}\n\t\t\t\t\tplaceholder=\"Enter First name\"\n\t\t\t\t/>\n\t\t\t\t<Field\n\t\t\t\t\tlabel=\"Last name\"\n\t\t\t\t\tname=\"last_name\"\n\t\t\t\t\tcomponent={KntInputField}\n\t\t\t\t\tplaceholder=\"Enter Last name\"\n\t\t\t\t/>\n\t\t\t\t<Field\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tlabel=\"Email\"\n\t\t\t\t\tname=\"username\"\n\t\t\t\t\tcomponent={KntInputField}\n\t\t\t\t\tplaceholder=\"Enter Email\"\n\t\t\t\t/>\n\n\t\t\t\t<Field\n\t\t\t\t\tlabel=\"Phone number\"\n\t\t\t\t\tname=\"mobile\"\n\t\t\t\t\tcomponent={KntPhoneInputField}\n\t\t\t\t\tplaceholder=\"Enter company mobile phone number\"\n\t\t\t\t\tenableSearch\n\t\t\t\t\tonChangeHandler={setFieldValue}\n\t\t\t\t/>\n\t\t\t\t<div className=\"row align-user-start remove-inner-label mb-3.5\">\n\t\t\t\t\t<div className=\"mb-2 ml-2 text-sm font-light text-kgrey-menuText\">Staff Departments</div>\n\t\t\t\t\t<EntityContainer.All\n\t\t\t\t\t\tentity=\"tree\"\n\t\t\t\t\t\tname={`AllTreeDepartments-Staff-${companyId}`}\n\t\t\t\t\t\turl={`/${companyId}/departments/tree/`}\n\t\t\t\t\t\tparams={{\n\t\t\t\t\t\t\tlimit: 100,\n\t\t\t\t\t\t\textra: {\n\t\t\t\t\t\t\t\tis_staff: 'True'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{({ items, isFetched }) => {\n\t\t\t\t\t\t\ttreeDataStaff = isFetched && convertToTreeSelectData(items);\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{isFetched ? (\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<TreeSelect\n\t\t\t\t\t\t\t\t\t\t\t\tgetPopupContainer={(triggerNode: any) => triggerNode.parentNode}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx('w-full', { 'tree-select-dark-mode': isDarkMode })}\n\t\t\t\t\t\t\t\t\t\t\t\ttransitionName=\"rc-tree-select-dropdown-slide-up\"\n\t\t\t\t\t\t\t\t\t\t\t\tchoiceTransitionName=\"rc-tree-select-selection__choice-zoom\"\n\t\t\t\t\t\t\t\t\t\t\t\tdropdownStyle={{ overflow: 'auto' }}\n\t\t\t\t\t\t\t\t\t\t\t\tdropdownPopupAlign={{\n\t\t\t\t\t\t\t\t\t\t\t\t\toverflow: { adjustY: 0, adjustX: 0 },\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset: [0, 2]\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={<i>Select Staff Departments</i>}\n\t\t\t\t\t\t\t\t\t\t\t\tsearchPlaceholder=\"please search\"\n\t\t\t\t\t\t\t\t\t\t\t\ttreeLine\n\t\t\t\t\t\t\t\t\t\t\t\tmaxTagTextLength={10}\n\t\t\t\t\t\t\t\t\t\t\t\tmultiple\n\t\t\t\t\t\t\t\t\t\t\t\tallowClear\n\t\t\t\t\t\t\t\t\t\t\t\tautoClearSearchValue\n\t\t\t\t\t\t\t\t\t\t\t\ttreeData={treeDataStaff}\n\t\t\t\t\t\t\t\t\t\t\t\ttreeNodeFilterProp=\"title\"\n\t\t\t\t\t\t\t\t\t\t\t\ttreeCheckable\n\t\t\t\t\t\t\t\t\t\t\t\ttreeCheckStrictly\n\t\t\t\t\t\t\t\t\t\t\t\ttreeDefaultExpandAll={!isCreate}\n\t\t\t\t\t\t\t\t\t\t\t\tshowCheckedStrategy={SHOW_PARENT}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(value: any) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetDeps((prev) => ({ ...prev, staffDeps: value }));\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t{...(isCreate ? null : { value: [...staffDeps] })}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t{/*{!staffDeps?.length ? (*/}\n\t\t\t\t\t\t\t\t\t\t\t{/*\t<ErrorMessage name=\"departments\">*/}\n\t\t\t\t\t\t\t\t\t\t\t{/*\t\t{(message) => (*/}\n\t\t\t\t\t\t\t\t\t\t\t{/*\t\t\t<div className=\"mt-0.5 text-xs text-red-500\">{message}</div>*/}\n\t\t\t\t\t\t\t\t\t\t\t{/*\t\t)}*/}\n\t\t\t\t\t\t\t\t\t\t\t{/*\t</ErrorMessage>*/}\n\t\t\t\t\t\t\t\t\t\t\t{/*) : null}*/}\n\t\t\t\t\t\t\t\t\t\t\t{/*{!staffDeps?.length && !errors?.departments ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-0.5 text-xs text-red-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tSelect at least one staff department\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t) : null}*/}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t\t</EntityContainer.All>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mb-3.5\">\n\t\t\t\t\t<div className=\"mb-2 ml-2 text-sm font-light text-kgrey-menuText\">Client Departments</div>\n\t\t\t\t\t<EntityContainer.All\n\t\t\t\t\t\tentity=\"tree\"\n\t\t\t\t\t\tname={`AllTreeDepartments-Client-${companyId}`}\n\t\t\t\t\t\turl={`/${companyId}/departments/tree/`}\n\t\t\t\t\t\tparams={{\n\t\t\t\t\t\t\tlimit: 100,\n\t\t\t\t\t\t\textra: {\n\t\t\t\t\t\t\t\tis_staff: 'False'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{({ items, isFetched }) => {\n\t\t\t\t\t\t\ttreeDataClient = isFetched && convertToTreeSelectData(items);\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{isFetched ? (\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<TreeSelect\n\t\t\t\t\t\t\t\t\t\t\t\tgetPopupContainer={(triggerNode: any) => triggerNode.parentNode}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx('w-full', { 'tree-select-dark-mode': isDarkMode })}\n\t\t\t\t\t\t\t\t\t\t\t\ttransitionName=\"rc-tree-select-dropdown-slide-up\"\n\t\t\t\t\t\t\t\t\t\t\t\tchoiceTransitionName=\"rc-tree-select-selection__choice-zoom\"\n\t\t\t\t\t\t\t\t\t\t\t\tdropdownStyle={{ overflow: 'auto' }}\n\t\t\t\t\t\t\t\t\t\t\t\tdropdownPopupAlign={{\n\t\t\t\t\t\t\t\t\t\t\t\t\toverflow: { adjustY: 0, adjustX: 0 },\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset: [0, 2]\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={<i>Select Сlient Departments</i>}\n\t\t\t\t\t\t\t\t\t\t\t\tsearchPlaceholder=\"please search\"\n\t\t\t\t\t\t\t\t\t\t\t\ttreeLine\n\t\t\t\t\t\t\t\t\t\t\t\tmaxTagTextLength={10}\n\t\t\t\t\t\t\t\t\t\t\t\tmultiple\n\t\t\t\t\t\t\t\t\t\t\t\tallowClear\n\t\t\t\t\t\t\t\t\t\t\t\tautoClearSearchValue\n\t\t\t\t\t\t\t\t\t\t\t\ttreeData={treeDataClient}\n\t\t\t\t\t\t\t\t\t\t\t\ttreeNodeFilterProp=\"title\"\n\t\t\t\t\t\t\t\t\t\t\t\ttreeCheckable\n\t\t\t\t\t\t\t\t\t\t\t\ttreeCheckStrictly\n\t\t\t\t\t\t\t\t\t\t\t\ttreeDefaultExpandAll={!isCreate}\n\t\t\t\t\t\t\t\t\t\t\t\tshowCheckedStrategy={SHOW_PARENT}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(value: any) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetDeps((prev) => ({ ...prev, clientDeps: value }));\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t{...(isCreate ? null : { value: [...clientDeps] })}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t\t\t{/*{!clientDeps?.length ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<ErrorMessage name=\"departments\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{(message) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"mt-0.5 text-xs text-red-500\">{message}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</ErrorMessage>\n\t\t\t\t\t\t\t\t\t\t\t) : null}*/}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t\t</EntityContainer.All>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mb-3.5\">\n\t\t\t\t\t<div className=\"mb-2 ml-2 text-sm font-light text-kgrey-menuText\">Roles</div>\n\n\t\t\t\t\t<Field\n\t\t\t\t\t\tcomponent={SelectField}\n\t\t\t\t\t\tstyles={KntTwilioStyle}\n\t\t\t\t\t\tname=\"roles\"\n\t\t\t\t\t\tdefaultValue={rolesOptions[2]}\n\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t...rolesOptions,\n\t\t\t\t\t\t\t...(isBusinessOwner ? [{ label: 'Owner', value: 'owner' }] : [])\n\t\t\t\t\t\t]}\n\t\t\t\t\t\tisSearchable={!isMobile}\n\t\t\t\t\t\tisDisabled={isBeingEditedUserOwner}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"branch-form__footer flex justify-end px-6 pt-4 pb-9\">\n\t\t\t\t<KntButton\n\t\t\t\t\tclassName={'mr-5 border border-kgrey text-kgrey'}\n\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\tonClick={closeModal}\n\t\t\t\t>\n\t\t\t\t\tCancel\n\t\t\t\t</KntButton>\n\t\t\t\t<KntButton\n\t\t\t\t\tclassName={'dark:text-white dark:hover:bg-primary-300 dark:focus:ring-primary-300'}\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tisSubmitting={isSubmitting}\n\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\tisDisabled={Boolean(errors?.departments)}\n\t\t\t\t>\n\t\t\t\t\t{isCreate ? 'Create' : 'Update'}\n\t\t\t\t</KntButton>\n\t\t\t</div>\n\t\t\t{isSubmitting ? (\n\t\t\t\t<div className=\"absolute inset-0 flex items-center justify-center bg-white bg-opacity-70\">\n\t\t\t\t\t<Loader />\n\t\t\t\t</div>\n\t\t\t) : null}\n\t\t</div>\n\t);\n}\n\nStaffFormElement.defaultProps = {\n\tisCreate: true,\n\tdepartment: null,\n\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\tresetForm: () => {}\n};\n","import {\n\tuseAxios,\n\tuseEntityActionPopup,\n\tuseNotistack,\n\tusePageChangeAfterEntityDelete,\n\tuseQueryParams,\n\tuseUpdateEntities\n} from '../../../shared/hooks';\nimport { useAppState } from '../../../shared/state';\nimport { formRequest } from '../../../modules/entity/actions';\nimport { useDispatch } from 'react-redux';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { CompSubscriptionType } from '../../../modules/user/reducers';\nimport { useAuth } from '../../../modules/auth/hooks/useAuth';\nimport { decrementEntityTotal } from 'modules/entity/actions';\nimport { StaffReAssignmentActionType } from '../components/StaffManagementTable';\n\nexport function useStaffManagementList(fetchStaffCountArg = () => {}) {\n\tconst { companyId } = useAppState();\n\tconst { companies } = useAuth();\n\tconst dispatch = useDispatch();\n\tconst { showNotification } = useNotistack();\n\tconst { updateEntities } = useUpdateEntities();\n\tconst { changeUrlParams, removeMultipleParams } = useQueryParams();\n\tconst [reAssignmentActionType, setReAssignmentActionType] =\n\t\tuseState<StaffReAssignmentActionType>('re_assign');\n\n\tconst { forwardToPreviousPage } = usePageChangeAfterEntityDelete({\n\t\tpageKey: 'page',\n\t\tentity: 'staffEmployee',\n\t\tentityName: `staffEmployee-${companyId}`\n\t});\n\n\tconst [paidMemberCount, setPaidMemberCount] = useState(0);\n\tconst {\n\t\tvisible: deleteVisible,\n\t\tshowVisible: showDeleteVisible,\n\t\tloading: deleteLoading,\n\t\ttoggleLoading: toggleDeleteLoading,\n\t\tclosePopup: closeDeletePopup\n\t} = useEntityActionPopup<any>();\n\n\tconst {\n\t\tvisible: editVisible,\n\t\tshowVisible: showEditVisible,\n\t\tclosePopup: closeEditPopup\n\t} = useEntityActionPopup<any>();\n\n\tconst {\n\t\tvisible: reAssignModalVisible,\n\t\tshowVisible: showReAssignModal,\n\t\tclosePopup: closeReAssignModal\n\t} = useEntityActionPopup<any>();\n\n\tconst {\n\t\tvisible: reAssignRequiredWarningVisible,\n\t\tshowVisible: showReAssignRequiredWarningVisible,\n\t\tclosePopup: closeReAssignRequiredWarningVisible\n\t} = useEntityActionPopup<any>();\n\n\tconst staffFetchUrl = useMemo(() => `/${companyId}/companies/staffs_count/`, [companyId]);\n\n\t//Request for fetching staff count in the business\n\tconst {\n\t\tfetchData: fetchStaffCount,\n\t\tresponse: staffCountResponse,\n\t\tloading: staffCountLoading\n\t} = useAxios({\n\t\turl: staffFetchUrl\n\t});\n\n\t//Fetch Staff Count\n\tuseEffect(() => {\n\t\tif (companyId) {\n\t\t\t(async () => {\n\t\t\t\tawait fetchStaffCount();\n\t\t\t})();\n\t\t}\n\t}, [companyId]);\n\n\t// useEffect(() => {\n\t// \tif (staffCountResponse) {\n\t// \t\tconsole.log('staffCountResponse', staffCountResponse);\n\t// \t}\n\t// }, [staffCountResponse]);\n\n\tuseEffect(() => {\n\t\tif (companyId && companies.length) {\n\t\t\tconst currentCompany = companies.find((com) => com.company.id === companyId);\n\t\t\tconst currentSubscription = currentCompany?.company.comp_subscription as CompSubscriptionType;\n\t\t\tif (currentSubscription) {\n\t\t\t\tsetPaidMemberCount(currentSubscription.paid_staffs_count!);\n\t\t\t}\n\t\t}\n\t}, [companies, companyId]);\n\n\tconst clickReAssignButtonHandler = useCallback((item) => {\n\t\tchangeUrlParams({\n\t\t\treAssign: 'true'\n\t\t});\n\n\t\tshowReAssignModal(item);\n\t}, []);\n\n\tconst closeReAssignModalHandler = useCallback(() => {\n\t\tremoveMultipleParams(['reAssign']);\n\t\tcloseReAssignModal();\n\t}, []);\n\n\tconst updateStaffEntity = () => {\n\t\tupdateEntities({\n\t\t\tentity: 'staffEmployee',\n\t\t\tentityId: deleteVisible?.id,\n\t\t\tupdatingData: {\n\t\t\t\troles: []\n\t\t\t}\n\t\t});\n\t};\n\n\tconst handleClientDelete = (staff: any) => {\n\t\t//show loader\n\t\ttoggleDeleteLoading();\n\t\tdispatch(\n\t\t\tformRequest({\n\t\t\t\tentity: 'staffEmployee',\n\t\t\t\tname: `staffEmployee-${companyId}`,\n\t\t\t\tmethod: 'delete',\n\t\t\t\turl: `/${companyId}/employee/${staff.id}/`,\n\t\t\t\tdeleteData: true,\n\t\t\t\tid: staff.id,\n\t\t\t\tcb: {\n\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\tshowNotification({ message: 'Successfully deleted', variant: 'success' });\n\t\t\t\t\t\tdispatch(decrementEntityTotal('staffEmployee', `staffEmployee-${companyId}`));\n\t\t\t\t\t\tupdateStaffEntity();\n\n\t\t\t\t\t\t//Decrement staff count deletion\n\t\t\t\t\t\tfetchStaffCountArg();\n\n\t\t\t\t\t\tforwardToPreviousPage();\n\t\t\t\t\t},\n\t\t\t\t\terror: (err) => {\n\t\t\t\t\t\tshowNotification({ message: err?.response?.data?.message, variant: 'error' });\n\t\t\t\t\t},\n\t\t\t\t\tfinally: () => {\n\t\t\t\t\t\ttoggleDeleteLoading();\n\t\t\t\t\t\tcloseDeletePopup();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tparams: {},\n\t\t\t\tprimaryKey: 'id',\n\t\t\t\tvalues: {}\n\t\t\t})\n\t\t);\n\t};\n\n\treturn {\n\t\tdeleteLoading,\n\t\thandleClientDelete,\n\t\tshowDeleteVisible,\n\t\tcloseDeletePopup,\n\t\tdeleteVisible,\n\t\teditVisible,\n\t\tshowEditVisible,\n\t\tcloseEditPopup,\n\t\tstaffCountLoading,\n\t\tstaffCountResponse,\n\t\tpaidMemberCount,\n\t\tfetchStaffCount,\n\t\treAssignModalVisible,\n\t\tclickReAssignButtonHandler,\n\t\tcloseReAssignModalHandler,\n\t\treAssignmentActionType,\n\t\tsetReAssignmentActionType,\n\t\treAssignRequiredWarningVisible,\n\t\tshowReAssignRequiredWarningVisible,\n\t\tcloseReAssignRequiredWarningVisible\n\t};\n}\n","export const convertToTreeSelectData = (items: any[]): any => {\n\treturn items.reduce((acc, curr) => {\n\t\tif (curr.sub_departments.length > 0) {\n\t\t\twhile (curr.sub_departments.length > 0) {\n\t\t\t\treturn [\n\t\t\t\t\t...acc,\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: curr['name'],\n\t\t\t\t\t\tkey: curr['id'],\n\t\t\t\t\t\tvalue: curr['id'],\n\t\t\t\t\t\tchildren: convertToTreeSelectData(curr.sub_departments)\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [\n\t\t\t\t...acc,\n\t\t\t\t{\n\t\t\t\t\ttitle: curr['name'],\n\t\t\t\t\tkey: curr['id'],\n\t\t\t\t\tvalue: curr['id']\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t}, []);\n};\n"],"names":["getRole","role","label","value","EditStaffForm","entity","onSuccess","companyId","useAppState","updateEntities","useUpdateEntities","showNotification","useNotistack","name","url","id","method","primaryKey","sendAsFormData","normalizeData","data","updateData","fields","required","avatar","onSubmitKey","type","onSubmitValue","first_name","username","last_name","mobile","roles","reduce","acc","curr","response","resetForm","message","entityId","updatingData","departments","onError","error","variant","isSubmitting","values","setFieldValue","errors","setFieldError","closeModal","isCreate","isBeingEditedUserOwner","is_business_owner","defaultProps","imgPath","config","rolesOptions","StaffFormElement","formValuesSetter","isDarkMode","useAuth","company","userData","useSwitch","canSend","can_send_news","checked","handleChange","useState","uploadMeta","setUploadMeta","cancelSending","setCancelSending","setAvatar","isBusinessOwner","owner","clientDeps","is_staff","staffDeps","deps","setDeps","treeDataStaff","treeDataClient","useEffect","checkableFields","fieldValues","Object","keys","filter","field","Array","isArray","length","includes","className","onClick","src","get","alt","setFile","component","KntInputField","placeholder","KntPhoneInputField","enableSearch","onChangeHandler","params","limit","extra","items","isFetched","convertToTreeSelectData","getPopupContainer","triggerNode","parentNode","clsx","transitionName","choiceTransitionName","dropdownStyle","overflow","dropdownPopupAlign","adjustY","adjustX","offset","searchPlaceholder","treeLine","maxTagTextLength","multiple","allowClear","autoClearSearchValue","treeData","treeNodeFilterProp","treeCheckable","treeCheckStrictly","treeDefaultExpandAll","showCheckedStrategy","SHOW_PARENT","onChange","prev","SelectField","styles","KntTwilioStyle","defaultValue","options","isSearchable","isMobile","isDisabled","color","Boolean","department","useStaffManagementList","fetchStaffCountArg","companies","dispatch","useDispatch","useQueryParams","changeUrlParams","removeMultipleParams","reAssignmentActionType","setReAssignmentActionType","usePageChangeAfterEntityDelete","pageKey","entityName","forwardToPreviousPage","paidMemberCount","setPaidMemberCount","useEntityActionPopup","deleteVisible","visible","showDeleteVisible","showVisible","deleteLoading","loading","toggleDeleteLoading","toggleLoading","closeDeletePopup","closePopup","editVisible","showEditVisible","closeEditPopup","reAssignModalVisible","showReAssignModal","closeReAssignModal","reAssignRequiredWarningVisible","showReAssignRequiredWarningVisible","closeReAssignRequiredWarningVisible","staffFetchUrl","useMemo","useAxios","fetchStaffCount","fetchData","staffCountResponse","staffCountLoading","currentCompany","find","com","currentSubscription","comp_subscription","paid_staffs_count","clickReAssignButtonHandler","useCallback","item","reAssign","closeReAssignModalHandler","updateStaffEntity","handleClientDelete","staff","formRequest","deleteData","cb","success","decrementEntityTotal","err","finally","sub_departments","title","key","children"],"sourceRoot":""}